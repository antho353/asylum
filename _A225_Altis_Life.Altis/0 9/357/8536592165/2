if(_shopType isEqualTo"heroin"&&_inTurf) then{private _nearestFlag=(nearestObjects[player,["Flag_Red_F","FlagPole_F"],500]select 0);(_nearestFlag getVariable["ga_turf_data",[]]) params["_flagGangID"];if(_flagGangID isEqualTo 0) exitWith{};life_turfTax=[false,0,_flagGangID];if(_flagGangID isEqualTo(life_gang_data param[0,-2])) then{life_turfTax set[0,true];};};[_shopType,false]call life_fnc_virt_update;((findDisplay 2400) displayCtrl 2406) ctrlSetEventHandler["ButtonClick",format["['%1', _this select 0] spawn life_fnc_virt_buy;",_shopType]];((findDisplay 2400) displayCtrl 2407) ctrlSetEventHandler["ButtonClick",format["['%1', _this select 0] spawn life_fnc_virt_sell;",_shopType]];private _nearMedSupply=nearestObjects[player,["C_IDAP_supplyCrate_F"],6];private _medCrate=_nearMedSupply param[_nearMedSupply findIf{_x getVariable["ga_medSupply",false]},objNull];if!(isNull _medCrate) then{[[_medCrate,900],"TON_fnc_setCleanTime",2]spawn life_fnc_MP;};waitUntil{!dialog};[false]call life_fnc_saveGear;if(life_lastSynced_gear!=str(life_gear)) then{[3]call life_fnc_ClupdatePartial;};if(_shopType=="wongs") then{if(!((life_wongsCartel select 2) isEqualTo-1)&&!((life_wongsCartel select 1) isEqualTo 0)) then{[[2,(life_wongsCartel select 2),player,(life_wongsCartel select 1)],"TON_fnc_gangBank",false,false]spawn life_fnc_MP;life_wongsCartel=[false,0,-1];};};if(_shopType=="rebel") then{if(!((life_drugCartel select 2) isEqualTo-1)&&!((life_drugCartel select 1) isEqualTo 0)) then{[[2,(life_drugCartel select 2),player,(life_drugCartel select 1)],"TON_fnc_gangBank",false,false]spawn life_fnc_MP;life_drugCartel=[false,0,-1];};};if(_shopType isEqualTo"heroin") then{if(!((life_turfTax select 2) isEqualTo-1)&&!((life_turfTax select 1) isEqualTo 0)) then{[[2,(life_turfTax select 2),player,(life_turfTax select 1)],"TON_fnc_gangBank",false,false]spawn life_fnc_MP;life_turfTax=[false,0,-1];};};