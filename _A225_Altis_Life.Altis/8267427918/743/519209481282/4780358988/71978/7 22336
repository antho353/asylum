params[["_caseType","",[""]],["_repairHouseData",[],[[]]]];switch(_caseType) do{case("requestRepair"):{_repairHouseData params[["_ruins",objNull,[objNull]],["_building",objNull,[objNull]],["_homeOwner",objNull,[objNull]]];if(isNull _ruins||isNull _building||isNull _homeOwner) exitWith{};private _nearestLocation=text(nearestLocations[_ruins,["NameCityCapital","NameCity","NameVillage"],5000]select 0);private _position=getPos _ruins;[format["<t align='center' size='1.5' color='#ff1717'>AFD Dispatch</t><br/><br/>A building near %1 needs repairing and has been marked on your map.",_nearestLocation],"event"]spawn life_fnc_handleMessage;private _marker=createMarkerLocal[format["building_repair%1",random 9999],_position];_marker setMarkerShapeLocal"ICON";_marker setMarkerTypeLocal"mil_pickup";_marker setMarkerTextLocal format["%1 - Needs Repair",getText(configFile>>"CfgVehicles">>typeOf _building>>"displayName")];_marker setMarkerColorLocal"ColorPink";[_marker,_homeOwner,_ruins]spawn{params["_marker","_homeOwner","_ruins"];waitUntil{uiSleep 20;(isNull _homeOwner)||(isNull _ruins)};deleteMarker _marker;};};case("repairPayment"):{_repairHouseData params[["_paymentFee",-1,[0]],["_homeOwnerName","",[""]],["_houseType","",[""]]];if(_paymentFee isEqualTo-1) exitWith{};life_atmCash=life_atmcash+_paymentFee;life_atmcashCache=((life_atmcash/4)+5);life_side_exp=life_side_exp+150;[format["Your were paid $%1 for the repair work done to %2's %3",[_paymentFee]call life_fnc_numberText,_homeOwnerName,_houseType],"basic"]spawn life_fnc_handleMessage;};case("actionRepair"):{private _ruins=if((((typeOf cursorObject) find"ruin")!=-1)||(((typeOf cursorObject) find"dam")!=-1)) then{cursorObject}else{objNull};if(isNull _ruins) exitWith{["You must be looking at the ruins of the building!"]spawn life_fnc_handleMessage};private _building=(nearestTerrainObjects[player,["House"],7,true,true]) param[0,objNull];private _building=if(_building getVariable["ga_terrainObject_repaired",false]) then{(nearestObjects[player,["House"],7,true]) param[0,objNull]}else{_building};if(isNull _building) exitWith{};if!(_building getVariable["ga_repairRequested",false]) exitWith{};if!(damage _building isEqualTo 1) exitWith{};private _ownerIsOnline=!(isNull(allPlayers param[allPlayers findIf{getPlayerUID _x isEqualTo(_building getVariable["ga_homeOwner",""])},objNull]));