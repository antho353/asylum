playSound _soundString;uiSleep _soundDelay;};};};disableSerialization;5 cutRsc["life_progress","PLAIN"];private _ui=uiNamespace getVariable"life_progress";private _progress=_ui displayCtrl 38201;private _pgText=_ui displayCtrl 38202;_pgText ctrlSetText format["%2 (1%1)...","%",_text];_progress progressSetPosition 0.01;private _cP=0.01;life_is_processing=true;life_action_in_use=true;private _success=false;private _sleep=_inputCount*0.03;private _vehicle=cursorObject;for"_i"from 0 to 1 step 0 do{uiSleep _sleep;_cP=_cP+0.01;_progress progressSetPosition _cP;_pgText ctrlSetText format["%3 (%1%2)...",round(_cP*100),"%",_text];if((_output in["crank","crankp","moonshinehash","moonshine"])&&((isNil"_vehicle")||(player distance _vehicle>8)||(isNull _vehicle)||!(alive _vehicle))) exitWith{};if(player distance _vendor>8) exitWith{};if!(life_action_in_use) exitWith{};if(_cp>=1) exitWith{_success=true;};};5 cutText["","PLAIN"];life_is_processing=false;life_action_in_use=false;if!(_success) exitWith{[["-PROCESSEDITEMFAILED-",player,(profileName),format["failed to process %1 into %2 %3 at POS: %4",_loggedInput,_inputCount,(["getName",_output]call life_fnc_virtItemCfg),getPos player]],"TON_fnc_logIt",2,false,false]spawn life_fnc_MP;};if((player getVariable["ga_restrained",false])||!(alive player)) exitWith{["You didn't complete the processing successfully.","basic"]spawn life_fnc_handleMessage;[["-PROCESSEDITEMFAILED-",player,(profileName),format["failed to process %1 into %2 %3 at POS: %4",_loggedInput,_inputCount,(["getName",_output]call life_fnc_virtItemCfg),getPos player]],"TON_fnc_logIt",2,false,false]spawn life_fnc_MP;};private _inputValsCheck=[];{_inputValsCheck pushBack(missionNamespace getVariable(format["life_inv_%1",_x]));}forEach _input;if!(_inputVals isEqualTo _inputValsCheck) exitWith{};private _loggedInput=[];{if([false,_x,_inputCount]call life_fnc_handleInv);_loggedInput pushBack(format["(%2 %1)",["getName",_x]call life_fnc_virtItemCfg,_inputCount]);}forEach _input;if((_input select 0) isEqualTo"plateMetal") exitWith{if((life_is_arrested select 0) isEqualTo 0) then{["You shouldn't be pressing license plates while not in jail...","basic"]spawn life_fnc_handleMessage;}else{if(A_stats_crimes select 57>=1) then{["You cannot press plates while admin jailed.","basic"]spawn life_fnc_handleMessage;}else{life_jailReleaseTime=life_jailReleaseTime-(_inputCount*25);life_is_arrested set[2,life_jailReleaseTime];[format["Your jail time was reduced by %1 seconds.",_inputCount*25],"basic"]spawn life_fnc_handleMessage;["plates",_inputCount]call life_fnc_statArrUpdate;};};};life_side_exp=life_side_exp+(ceil(_inputCount*(count _input)));private _reduce=false;if((_type in["marijuana","marijuanam","canna_dab","cannai_2","cannas_2"])&&(playerSide isEqualTo civilian&&!(23 in life_side_talents))) then{_reduce=true;};if((_type isEqualTo"heroin")&&(playerSide isEqualTo civilian&&!(24 in life_side_talents))) then{_reduce=true;};if((_type in["cocaine","oysterp","oysterfry"])&&(playerSide isEqualTo civilian&&!(25 in life_side_talents))) then{_reduce=true;};if((_type in["meth","crankp","fungi"])&&(playerSide isEqualTo civilian&&!(26 in life_side_talents))) then{_reduce=true;};if(_type in["timberl","timberh"]) then{_reduce=true;};if(_reduce) then{_inputCount=floor(_inputCount*0.85);};private _capture=if(_capIndex>0) then{true}else{false};private _reductionAmt=0;private _flag=switch(_capIndex) do{case 1:{[drug_flag,", you retain %1 after the owners of Drug Cartel took a cut of %2 %3",0.85,"Drug Cartel"]};case 2:{oil_flag,", you retain %1 after the owners of Oil Cartel took a cut of %2 %3",0.85,"Oil Cartel"};case 3:{[wongs_flag,", you retain %1 after the owners of Wongs Triad took a cut of %2 %3",0.85,"Wongs Triad"]};default{[objNull,"",0.85,""]};};_flag params["_flagObj","_extra","_tax","_cartelName"];private _gangId=if!(life_gang_data isEqualTo[]) then{life_gang_data select 0}else{-1};if(_type in["cannas_3","cannai_3","cokebrick","bluemeth"]) then{_tax=0.95;};if(_capture) then{if!(isNull _flagObj) then{(_flagObj getVariable["ga_capData",[0,"Neutral",0.5]]) params["_flagGangID","_flagGangName","_progress"];if!(_flagGangID isEqualTo _gangId) then{_reductionAmt=abs((floor(_inputCount*_tax))-_inputCount);_inputCount=floor(_inputCount*_tax);private _value=_reductionAmt*(["getLowestPrice",_output]call life_fnc_virtItemCfg);[[2,_flagGangID,player,_value],"TON_fnc_gangBank",2]spawn life_fnc_MP;}else{_extra="owner";};};};if([true,_output,_inputCount]call life_fnc_handleInv) then{if(_capture) then{if(_extra isEqualTo"owner") then{titleText[format["You have processed your goods into %1 %2. As the owner of %3, you retain the entire amount",_inputCount,(["getName",_output]call life_fnc_virtItemCfg),_cartelName],"PLAIN"];}else{titleText[format["You have processed your goods into %1%2",(["getName",_output]call life_fnc_virtItemCfg),format[_extra,_inputCount,_reductionAmt]],"PLAIN"];};}else{titleText[format["You have processed your goods into %1 %2",_inputCount,(["getName",_output]call life_fnc_virtItemCfg)],"PLAIN"];};[["-PROCESSEDITEMSUCCESS-",player,(profileName),format["processed %1 into %2 %3 at POS: %4",_loggedInput,_inputCount,(["getName",_output]call life_fnc_virtItemCfg),getPos player]],"TON_fnc_logIt",2,false,false]spawn life_fnc_MP;if(_type isEqualTo"oil") then{private _rubbers=ceil(random 7);if(70 in life_side_talents) then{_rubbers=_rubbers+1};[true,"rubber",_rubbers]call life_fnc_handleInv;systemChat format["You've received %1 units of rubber while processing oil.",_rubbers];};if(_output in["uraniump","cokebrick","bluemeth","moonshine","moonshinep","oyster","oysterfry"]) then{[format["%1%2",_output,"_proc"],_inputCount]call life_fnc_statArrUpdate;}else{[_output,_inputCount]call life_fnc_statArrUpdate;};};