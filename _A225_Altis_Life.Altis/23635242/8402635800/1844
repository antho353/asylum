params[["_unit",objNull,[objNull]],["_killer",objNull,[objNull]]];life_primaryWeaponOnDeath=[primaryWeapon _unit,primaryWeaponItems _unit];while{dialog}do{closeDialog 0};if((call life_adminLevel) isEqualTo 0) then{(findDisplay 49) closeDisplay 1;};2 cutRsc["ga_playerHUD","PLAIN"];disableSerialization;if(life_clothing_store isEqualTo""&&!life_inEvent) then{if(life_activeSWAT||life_eviSpawn) exitWith{life_deadcop_gear=[_unit]call life_fnc_fetchDeadGear;};life_dead_gear=[_unit]call life_fnc_fetchDeadGear;};life_respawned=false;life_isDead=true;life_inCombat=false;life_isDowned=false;if(player getVariable["ga_downed",false]) then{player setVariable["ga_downed",false,true]};private _unitName=profileName;private _unitPlayerID=getPlayerUID _unit;private _killerName=name _killer;private _isWarKill=((_killer getVariable["gang_data",[]]isNotEqualTo[])&&{(_killer getVariable["gang_data",[-1]]select 0) in life_gang_wars});private _killerRemoteStats=[];private _killerStatArr=[];private _killerVehicle=typeOf _killer;private _isHeadshotFnc={params[["_unit",objNull,[objNull]]];([_unit getHitPointDamage"hitface",_unit getHitPointDamage"hitneck",_unit getHitPointDamage"hithead"]findIf{_x>=0.95}) isNotEqualTo-1};private _holdingFlag=(life_dominatonCTF param[0,false]);private _ctfFlag=(life_dominatonCTF param[1,objNull]);if(_holdingFlag&&!isNull _ctfFlag&&(call life_fnc_isDominationActive)) then{["captureFlagDrop",[SRV_dominationCTF]]spawn life_fnc_dominationMission;};if!(isNull objectParent player) then{private _vehicle=vehicle player;life_dynamicMap_lastVehicle=_vehicle;[_vehicle]spawn life_fnc_dynamicMapVehicleFix;};private _containers=nearestObjects[getPosATL _unit,["WeaponHolderSimulated"],5];{deleteVehicle _x;}forEach _containers;private _partialMode=-1;switch(playerSide) do{case civilian:{[_unit]spawn life_fnc_dropItems;life_gear=[[[],[],[],["U_C_Poloshirt_blue",[]],[],[],"","",[],["ItemMap","","","ItemCompass","ItemWatch",""]],[[],0],[-1,-1]];life_ses_last_pos=[];_partialMode=11;};case west:{if(str player in["cop_detective_1","cop_detective_2","cop_detective_3"]) exitWith{};life_gear=[[["SMG_05_F","","","optic_ACO_grn_smg",["30Rnd_9x21_Mag_SMG_02_Tracer_Yellow",30],[],""],[],["hgun_P07_F","muzzle_snds_L","","",["30Rnd_9x21_Mag",30],[],""],["U_BG_Guerrilla_6_1",[]],["V_Rangemaster_belt",[["30Rnd_9x21_Mag",1,30],["30Rnd_9x21_Mag_SMG_02_Tracer_Yellow",1,30]]],[],"H_Cap_police","",["Binocular","","","",[],[],""],["ItemMap","ItemGPS","","ItemCompass","ItemWatch","Integrated_NVG_F"]],[[],0],[-1,-1]];_partialMode=12;};case independent:{life_gear=[[[],[],[],["U_Marshal",[]],[],["B_Messenger_Black_F",[]],"","G_Respirator_white_F",[],["ItemMap","ItemGPS","","","","Integrated_NVG_F"]],[[],0],[-1,-1]];_partialMode=13;};};life_lastSynced_gear=format["%1",life_gear];if!(_partialMode isEqualTo-1) then{[_partialMode]call life_fnc_ClupdatePartial};private _extra=switch(true) do{case((side _killer isEqualTo west)&&(_killer getVariable["ga_showrank",true])):{[west,_killer]call life_fnc_getRankString;};case(side _killer isEqualTo civilian):{(group _killer) getVariable["ga_grpTag",""];};case(_killerVehicle in["B_G_Offroad_01_armed_F","I_C_Offroad_02_LMG_F","O_LSV_02_armed_F"]&&{!isNull gunner _killer}):{(group(gunner _killer)) getVariable["ga_grpTag",""];};default{""};};private _groupTag=switch(true) do{case(playerSide isEqualTo civilian&&!((group player) getVariable["ga_grpTag",""]isEqualTo"")):{(group player) getVariable"ga_grpTag"};case(playerSide isEqualTo west&&ASY_Server isEqualTo 2&&(call life_fnc_isDominationActive)):{"SRT Trooper "};case(playerSide isEqualTo west&&player getVariable["ga_showrank",true]):{[west,player]call life_fnc_getRankString};case(playerSide isEqualTo independent):{[independent,player]call life_fnc_getRankString};default{""};};switch(true) do{case(_killerVehicle in["B_G_Offroad_01_armed_F","I_C_Offroad_02_LMG_F","O_LSV_02_armed_F"]&&{!isNull gunner _killer}):{[[0,format["%1%2 was killed by %3%4.",_groupTag,profileName,_extra,name(gunner _killer)]],"life_fnc_broadcast",-2,false,false]spawn life_fnc_MP;};case!(_killer isEqualTo _unit||!(isPlayer _killer)):{if(_isWarKill) then{[[0,format["%1%2 was killed by enemy gang member %3%4.",_groupTag,_unitName,_extra,_killerName]],"life_fnc_broadcast",-2,false,false]spawn life_fnc_MP;}else{[[0,format["%1%2 was killed by %3%4.",_groupTag,_unitName,_extra,_killerName]],"life_fnc_broadcast",-2,false,false]spawn life_fnc_MP;};};case(_killer isEqualTo _unit&&!isNil"life_suicide"):{[[0,format["%1%2 has taken their own life.",_groupTag,profileName]],"life_fnc_broadcast",-2,false,false]spawn life_fnc_MP;};default{[[0,format["%1 was killed.",profileName]],"life_fnc_broadcast",-2,false,false]spawn life_fnc_MP;}};switch(true) do{case(_killer isEqualTo _unit&&!isNil"life_suicide"):{[["-KILLED-",_unit,_unitName,"took their own life."],"TON_fnc_logIt",2,false,false]spawn life_fnc_MP;};case((_killer isKindOf"CAManBase"&&!(_killer isEqualTo _unit))||(_killer isKindOf"LandVehicle"&&{!(isNull gunner _killer)})):{private _killerWeapon=currentWeapon _killer;private _weaponDisplayName=getText(configFile>>"CfgWeapons">>_killerWeapon>>"displayName");private _magCapacity=getNumber(configfile>>"CfgMagazines">>currentMagazine _killer>>"count");if(_killer isKindOf"LandVehicle") then{_killer=gunner(vehicle _killer)};private _isAtWar=if(!(_killer getVariable["gang_data",[]]isEqualTo[])&&{(_killer getVariable["gang_data",[-1]]select 0) in life_gang_wars});if(_killer getVariable["ga_aMode",false]) then{[["-ADMINACTION-",_killer,name _killer,format["(%1) killed %2 - %3 (%4) with admin-mode activated using a %5, Ammo: %9/%10, Distance: %6m. Killer: %7, Dead: %8",side _killer,profileName,_unitPlayerID,playerSide,_weaponDisplayName,floor(_unit distance _killer),getpos _killer,getPos _unit,_killer ammo _killerWeapon,_magCapacity]],"TON_fnc_logIt",2]spawn life_fnc_MP;