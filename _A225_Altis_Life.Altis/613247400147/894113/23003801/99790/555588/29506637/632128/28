params[["_source",objNull,[objNull]],["_shanked",false,[false]]];if((call life_adminLevel) isEqualTo 0) then{(findDisplay 49) closeDisplay 1;};private _vehSource=false;private _asy_dmg=player;private _sourceStatArr=[];_asy_dmg setDamage 0;if(isNull _source) exitWith{player allowDamage true;life_isDowned=false;};if!(!life_isDowned&&alive player&&isNull(findDisplay 7300)) exitWith{};if(vehicle _source isKindOf"LandVehicle"&&{driver(vehicle _source) isEqualTo _source}) then{_vehSource=true;[[0,format["%1 has been run over by %2.",[profileName]call life_fnc_cleanName,[name _source]call life_fnc_cleanName]],"life_fnc_broadcast",-2,false,false]spawn life_fnc_MP;if(alive _source&&!(side _source isEqualTo west)) then{[[10,_source],"TON_fnc_wantedAdd",false,false]spawn life_fnc_MP;};}else{private _extra=switch(true) do{case((side _source isEqualTo west)&&(_source getVariable["ga_showrank",true])):{[west,_source]call life_fnc_getRankString;};case(side _source isEqualTo civilian):{(group _source) getVariable["ga_grpTag",""];};case(typeOf _source in["B_G_Offroad_01_armed_F","I_C_Offroad_02_LMG_F","O_LSV_02_armed_F"]&&{!isNull gunner _source}&&side _source isEqualTo civilian):{(group(gunner _source)) getVariable["ga_grpTag",""];};default{""};};private _groupTag=switch(true) do{case(playerSide isEqualTo civilian&&!((group player) getVariable["ga_grpTag",""]isEqualTo"")):{(group player) getVariable"ga_grpTag"};case(playerSide isEqualTo west&&player getVariable["ga_showrank",true]):{[west,player]call life_fnc_getRankString};case(playerSide isEqualTo independent):{[independent,player]call life_fnc_getRankString};default{""};};if((side _source isEqualTo civilian)&&(playerSide isEqualTo west)) then{_sourceStatArr pushBack["civ_cops_downed",1];};if((playerSide isEqualTo civilian)&&(456 in life_completedLifetimeQuests)&&((round random 100)<=5)&&(life_inv_adrenalineShot>=1)) then{[]spawn{uiSleep 5;[false,"adrenalineShot",1]call life_fnc_handleInv;[]call life_fnc_adrenalineShotEffect;};};if!(_shanked) then{if(isPlayer _source&&!(_source isEqualTo player)) then{[[[0],format["%1%2 was downed by %3%4.",_groupTag,profileName,_extra,name _source]],"life_fnc_broadcast",-2,false,false]spawn life_fnc_MP;private _isAtWar=if(!(_source getVariable["gang_data",[]]isEqualTo[])&&!(group _source isEqualTo group player)&&{(_source getVariable["gang_data",[-1]]select 0) in life_gang_wars});[["-DOWNED-",player,(profileName),format["(%5) was downed by %1 (%2) (%6) with a %3, DIST: %4m. Shooter: %7, Target: %8, In War: %9",(name _source),(getPlayerUID _source),(getText(configFile>>"CfgWeapons">>(currentWeapon(vehicle _source))>>"DisplayName")),(floor(player distance _source)),(side player),(side _source),getPos _source,getPos player,_isAtWar]],"TON_fnc_logIt",2,false,false]spawn life_fnc_MP;