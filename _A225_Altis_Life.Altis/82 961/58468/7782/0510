#include"..\..\..\macro.h"
disableSerialization;private"_display";private _displays=[[3030,"RscConfigEditor_Main"],[162,"RscDisplayFieldManual"],[125,"RscDisplayEditDiaryRecord"],[69,"RscDisplayPort"],[19,"RscDisplayIPAddress"],[71,"RscDisplayFilter"],[45,"RscDisplayArcadeMarker"],[132,"RscDisplayHostSettings"],[132,"RscDisplaySetupServer"],[32,"RscDisplayIntel"],[165,"RscDisplayPublishMission"],[165,"display3DENPublishMission"],[2727,"RscDisplayLocWeaponInfo"],[157,"RscDisplayPhysX3Debug"],[157,"RscDisplayModLauncher"],[30,"RscDisplayTemplateLoad"],[166,"RscDisplayPublishMissionSelectTags"],[166,"display3DENPublishMissionSelectTags"],[167,"RscDisplayFileSelect"],[167,"RscDisplayFileSelectImage"],[167,"display3DENPublishMissionSelectImage"],["RscDisplayMultiplayer","RscDisplayMultiplayer"],["RscDisplayRemoteMissions","RscDisplayRemoteMissions"],["RscDisplayMovieInterrupt","RscDisplayMovieInterrupt"],["RscDisplayArsenal","RscDisplayArsenal"]];private _badUIStrings=["menu loaded","rustler","hangender","hungender","douggem","monstercheats","bigben","fireworks"," is god","hydroxus","kill target","no recoil","rapid fire","explode all","teleportall","destroyall","destroy all","code to execute","g-e-f","box-esp","god on","god mode","unlimited mags","_execscript","_theban","rhynov1","b1g_b3n","infishit","e_x_t_a_s_y","weppp3","att4chm3nt","f0od_dr1nk","m3d1c4l","t0ol_it3ms","b4ckp4cks","it3m5","cl0th1ng","lystic","extasy","glasssimon_flo","remote_execution","gladtwoown","_pathtoscripts","flo_simon","sonicccc_","fury_","phoenix_","_my_new_bullet_man","_jm3","thirtysix","dmc_fnc_4danews","w_o_o_k_i_e_m_e_n_u","xbowbii_","jm3_","wuat","menutest_","listening to jack","dmcheats.de","kichdm","_news_banner","fucked up","lystics menu","rsccombo_2100","\dll\datmalloc","rsclistbox_1501","rsclistbox_1500","\dll\tcmalloc_bi","___newbpass","updated_playerlist","recking_ki","gg_ee_ff","ggggg_eeeee_fffff","gggg_eeee_ffff","mord all","teleport all","__byass","_altislifeh4x","antifrezze","ownscripts","ownscripted","mesnu","mystic_","init re","init life re","spoody","gef_","throx_","_adasaasasa","_dsfnsjf","cheatmenu","in54nity","markad","fuck_me_","_v4fin","a3randvar","infinite ammo","player markers","+ _code +","menu","infistar","target","T e l e p o r t","N u K e","Crash","Spawn","Money","Remote","Scripts","â","ð","ĝ","ĵ","ś","Ź","Ŵ","Ĥ","Ţ","Ñ","ESP:","AIM:","silentaim","troll","godmode","restrain"];private _badUIVariables=["_obscuratedmain","_gitmadistrack","_lb1","_lb2","_lb3","_eggsrcute","_popedit","_infobox","_lb3mode","_loadouts","_fhandler","_colortogges","_colortogges","_lb3mode","_lb3mode","_lb3mode","_lb3mode","_lb3mode","_lb3mode","_lb3mode","_PlayahVision","_playerdraw","_PlayahVision","_bombehicleVission","_Vehiclerdraw","_bombehicleVission","_safeviz","_safedraw","_safeviz","_messiahmode","_messiahmode","_speeeeeedy","_speeeeeedy","_staminup","_staminup","_murdurmode","_muderenabled","_murdurmode","_fastaskeem","_fastaskeem","_neverrunsout","_neverrunsout","_nocoil","_nocoil","_explooammo","_exploammo","_explooammo","_flareamooo","_flareamooo","_noosway","_noosway","ExileIsLocked","ExileIsLocked","_animalfarmers","_animalfarmers","_ghettoflyy","_ghettoflyy","ExileLocker","_spawntabs","_PlayahVision","_bombehicleVission","_murdurmode","_messiahmode","_ghettoflyy","_fastaskeem","_neverrunsout","_explooammo","_noosway","_animalfarmers","_nocoil","_staminup","_safeviz","_speeeeeedy","_slidersetup","_flareamooo","_infohandler","_spectator","_nearvehicss","_bantyplayers","_bantah2add","_lbvihics","_vehcisarrayy","_bags","_magazines","_weapons","_bombests","_heads","_uniforms","_fillemup","_remotemethod","_safezz","_kissmyballs","_colortogges","_colorfunccs","w_1","w_2","w_3","b_1","b_2","ac","bc"];private _flaggedMenus=[];private _detection=false;for"_i"from 0 to 1 step 0 do{{_x params["_targetDisplay","_targetName"];private _display=switch(typeName _targetDisplay) do{case(typeName 0):{findDisplay _targetDisplay};case(typeName""):{uiNamespace getVariable[_targetDisplay,displayNull]};default{displayNull};};if!(isNull _display) then{_display closeDisplay 0;_detection=true;};if(_detection) exitWith{if!(_targetName in _flaggedMenus) then{_flaggedMenus pushBack _targetName;[["-HACKLOG-",player,profileName,format["has a potentially bad menu open: %1. Controls: %2",_targetName,((allControls _display) select{!((ctrlText _x) isEqualTo"")}) apply{ctrlText _x}]],"TON_fnc_logIt",2]spawn life_fnc_MP;};};uiSleep 0.075;}forEach _displays;{if!(isNull _x) then{private _display=_x;{if!(isNil{_display getVariable _x}) exitWith{[["-HACKLOG-",player,profileName,format["was detected with a blacklisted variable in %1. Variable detected: %2 - value: %3.",_display,_x,_display getVariable _x]],"TON_fnc_logIt",2]spawn life_fnc_MP;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};}forEach _badUIVariables;};}forEach[findDisplay 0,(findDisplay 0) displayCtrl 999];if!(isNull(uiNamespace getVariable["BIS_dynamicText",displayNull])) then{{private _string=toLower _x;{if(_string in(toLower(ctrlText _x))) exitWith{[["-HACKLOG-",player,profileName,format["was detected with dynamic text display (BIS_dynamicText). Detected string: %1 - full text: %2.",_string,ctrlText _x]],"TON_fnc_logIt",2]spawn life_fnc_MP;(uiNamespace getVariable["BIS_dynamicText",displayNull]) closeDisplay 0;(findDisplay 24) closeDisplay 0;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};}forEach(allControls(uiNamespace getVariable["BIS_dynamicText",displayNull]));}forEach _badUIStrings;};if!(isNull(findDisplay-1)) then{private _toCheck=(allControls(findDisplay-1)) select{ctrlText _x!=""&&!("A3\"in ctrlText _x)};if!(_toCheck isEqualTo[]) then{private _detectedStrings=[];{private _string=toLower _x;{if(_string in(toLower(ctrlText _x))&&(count(ctrlText _x)<=35)) then{_detectedStrings pushBack(ctrlText _x);};}forEach _toCheck;}forEach _badUIStrings;if((count _detectedStrings)>=2) then{[["-HACKLOG-",player,profileName,format["was detected with bad controls for a display with no ID. Detected strings: %1. See logs for all ctrlTexts.",_detectedStrings]],"TON_fnc_logIt",2]spawn life_fnc_MP;[["-HACKLOG-",player,profileName,format["All ctrlTexts: %1.",_toCheck apply{ctrlText _x}]],"TON_fnc_logIt",2]spawn life_fnc_MP;(findDisplay-1) closeDisplay 0;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";}else{if(((count _detectedStrings) isEqualTo 1)&&!(life_wasDetected)) then{life_wasDetected=true;[["-HACKLOG-",player,profileName,format["was detected with a potentially bad control for a display with no ID. Detected string: %1. See logs for all ctrlTexts.",_detectedStrings select 0]],"TON_fnc_logIt",2]spawn life_fnc_MP;[["-HACKLOG-",player,profileName,format["All ctrlTexts: %1.",_toCheck apply{ctrlText _x}]],"TON_fnc_logIt",2]spawn life_fnc_MP;};};};};if!(isNull(findDisplay 6)) then{private _controls=allControls(findDisplay 6);if(count _controls>33) then{private _toCheck=_controls select{ctrlText _x!=""};{private _string=toLower _x;{if(_string in(toLower(ctrlText _x))) exitWith{[["-HACKLOG-",player,profileName,format["was detected with bad controls for Display 6 (RscDisplayOptionsAudio). Detected string: %1 - full text: %2. Expected control count: 30 - actual: %3.",_string,ctrlText _x,count _controls]],"TON_fnc_logIt",2]spawn life_fnc_MP;