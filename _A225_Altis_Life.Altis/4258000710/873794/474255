params[["_item","",[""]],"_cannaData"];if(_item isEqualTo"") exitWith{};if!(_item in["createVape","createGlassRig","createBongRig","createJoint"]) then{closeDialog 0;};switch(_item) do{case("canna_papers"):{private _exit=false;private _chosenItem="";{private _xItem=_x;private _amount=missionNamespace getVariable(format["life_inv_%1",_xItem]);if(_amount>0) then{private _action=[format["Would you like to roll your %1 with %2 to make %3 Rolled Joint(s)?",["getName",_xItem]call life_fnc_virtItemCfg,"RAW Papers",_amount],"RAW Papers Stoner","Roll It","Hell Nah"]call BIS_fnc_GUIMessage;if(_action) exitWith{_exit=true;_chosenItem=_xItem;};};}forEach["cannas_3","cannai_3","marijuanam","marijuana"];if((_chosenItem isEqualTo"")||!(_exit)) exitWith{["You either didn't have any flower to roll with or didn't choose!","basic"]spawn life_fnc_handleMessage};if!([false,_chosenItem,1]call life_fnc_handleInv) exitWith{[format["You didn't have a %1 to roll with!",["getName",_chosenItem]call life_fnc_virtItemCfg],"basic"]spawn life_fnc_handleMessage};[player,"","","canna_joint"]spawn life_fnc_processAction;};case("canna_bong"):{private _exit=false;private _chosenItem="";{private _xItem=_x;private _amount=missionNamespace getVariable(format["life_inv_%1",_xItem]);if(_amount>0) then{private _action=[format["Would you like to smoke %1 from your Glass Bong?",["getName",_xItem]call life_fnc_virtItemCfg],"420 Stoner","Blaze It","No"]call BIS_fnc_GUIMessage;if(_action) exitWith{_exit=true;_chosenItem=_xItem;};};}forEach["cannas_3","cannai_3","marijuanam","marijuana"];if((_chosenItem isEqualTo"")||!(_exit)) exitWith{["You either didn't have any flower to smoke or didn't choose!","basic"]spawn life_fnc_handleMessage};if!([false,_chosenItem,1]call life_fnc_handleInv) exitWith{};["smokeWeedBongOrRig",[false]]spawn life_fnc_cannabisItems;};case("canna_rig"):{private _exit=false;private _chosenItem="";{private _xItem=_x;private _amount=missionNamespace getVariable(format["life_inv_%1",_xItem]);if(_amount>0) then{private _action=[format["Would you like to smoke %1 from your Glass Rig?",["getName",_xItem]call life_fnc_virtItemCfg],"3000 Degree Dab","Yes","No"]call BIS_fnc_GUIMessage;if(_action) exitWith{_exit=true;_chosenItem=_xItem;};};}forEach["canna_dab"];if((_chosenItem isEqualTo"")||!(_exit)) exitWith{["You either didn't have any Golden Wax to smoke or didn't choose!","basic"]spawn life_fnc_handleMessage};if!([false,_chosenItem,1]call life_fnc_handleInv) exitWith{};["smokeWeedBongOrRig",[true]]spawn life_fnc_cannabisItems;};case("smokeWeedJointOrVape"):{_cannaData params[["_isVape",false,[false]],["_jointType","",[""]]];private _exit=false;if!(_isVape) then{if!([false,_jointType,1]call life_fnc_handleInv) exitWith{_exit=true};};if(_exit) exitWith{[format["You didn't have a %1 to smoke!",["getName",_jointType]call life_fnc_virtItemCfg],"basic"]spawn life_fnc_handleMessage};private _toSend=allPlayers select{player distance _x<=300};player setVariable["ga_cannabisUsing",true];if(_isVape) then{[["createVape",[player,"cannabisvaperip"]],"life_fnc_cannabisItems",_toSend]spawn life_fnc_MP;}else{[["createJoint",[player,"cannabisjointrip"]],"life_fnc_cannabisItems",_toSend]spawn life_fnc_MP;["action","smokeprerolledjoint",1]call life_fnc_handleQuest;};player forceWalk true;disableSerialization;5 cutRsc["life_progress","PLAIN"];private _display=uiNameSpace getVariable["life_progress",displayNull];private _progressBar=_display displayCtrl 38201;private _progressText=_display displayCtrl 38202;private _increment=1;private _totalTime=if(_isVape) then{8}else{12};private _currentPoint=0;private _loopDelay=_totalTime/floor(100/_increment);private _text=if(_isVape) then{"Ripping Dab Pen"}else{"Chiefing Big Doink"};private _startCount=0;_progressBar progressSetPosition _startCount;_progressText ctrlSetText format["%1 (%2%3)",_text,_startCount,"%"];private _isSuccess=for"_i"from 0 to 1 step 0 do{uiSleep _loopDelay;if(isNull _progressBar) exitWith{["Your bong/rig fell out of your hands and broke into millions of pieces!","basic"]spawn life_fnc_handleMessage;false;};_currentPoint=(progressPosition _progressBar)+(_increment/100);_progressBar progressSetPosition _currentPoint;_progressText ctrlSetText format["%1 (%2%3)",_text,round(_currentPoint*100),"%"];if(_currentPoint>=1) exitWith{true};false;};5 cutText["","PLAIN"];player forceWalk false;life_drug_level=selectMin[life_drug_level+0.005,1];if(_isVape) then{systemChat"I can't tell if that was nicotine or wax...";}else{systemChat"WOOOOO, This doink is straight zaza fire!";["cannabisReduceSwayEffect",[60]]spawn life_fnc_cannabisItems;};[]call life_fnc_hudUpdate;[player]call life_fnc_painkillers;["cannabis"]call life_fnc_drugUsed;[_isVape]spawn{params["_isVape"];if(_isVape) then{player setAnimSpeedCoef 0.5;"radialBlur"ppEffectEnable true;titleText["Who the hell put nicotine in my dab pen?!","PLAIN"];uiSleep 5;"radialBlur"ppEffectEnable false;titleText["","PLAIN"];player setAnimSpeedCoef 1;}else{"radialBlur"ppEffectEnable true;titleText["Cheech and Chong would be proud, WOOOOO!","PLAIN"];uiSleep 5;"radialBlur"ppEffectEnable false;titleText["","PLAIN"];};};player setVariable["ga_cannabisUsing",false];if!(life_smoking) then{life_smoking=true;[[player],"life_fnc_attachSmoke",allPlayers select{player distance _x<=2000}]spawn life_fnc_MP;uiSleep 300;life_smoking=false;};};case("smokeWeedBongOrRig"):{_cannaData params[["_isDabRig",false,[false]]];private _toSend=allPlayers select{player distance _x<=300};player setVariable["ga_cannabisUsing",true];if(_isDabRig) then{[["createGlassRig",[player,"cannabisbongrip"]],"life_fnc_cannabisItems",_toSend]spawn life_fnc_MP;}else{[["createBongRig",[player,"cannabisbongrip"]],"life_fnc_cannabisItems",_toSend]spawn life_fnc_MP;};player forceWalk true;disableSerialization;5 cutRsc["life_progress","PLAIN"];private _display=uiNameSpace getVariable["life_progress",displayNull];private _progressBar=_display displayCtrl 38201;private _progressText=_display displayCtrl 38202;private _increment=1;private _totalTime=if(_isDabRig) then{12}else{12};private _currentPoint=0;private _loopDelay=_totalTime/floor(100/_increment);private _text=if(_isDabRig) then{"Heating Wax to 9000 Degrees"}else{"Taking Massive Bong Rip"};private _startCount=0;_progressBar progressSetPosition _startCount;_progressText ctrlSetText format["%1 (%2%3)",_text,_startCount,"%"];private _isSuccess=for"_i"from 0 to 1 step 0 do{uiSleep _loopDelay;if(isNull _progressBar) exitWith{["Your bong/rig fell out of your hands and broke into millions of pieces!","basic"]spawn life_fnc_handleMessage;false;};_currentPoint=(progressPosition _progressBar)+(_increment/100);_progressBar progressSetPosition _currentPoint;_progressText ctrlSetText format["%1 (%2%3)",_text,round(_currentPoint*100),"%"];