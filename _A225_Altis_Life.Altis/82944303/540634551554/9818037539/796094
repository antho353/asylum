private _ui=uiNamespace getVariable"life_progress";private _progress=_ui displayCtrl 38201;private _pgText=_ui displayCtrl 38202;private _text=format["Cost: $%1 | %2/%3 litres",0,round(_capacity*_fuelLevel),_capacity];_pgText ctrlSetText format["%2 (1%1)...","%",_text];private _cP=if(_fuelLevel>0) then{_fuelLevel/1}else{0.01};_progress progressSetPosition _cP;life_action_in_use=true;private _success=true;private _tick=0;while{_fuelLevel<1}do{uiSleep _delay;_litres=_litres+1;_cost=_cost+6;if(life_atmcash<_cost) exitWith{_success=false};_tick=1/_capacity;_fuelLevel=_fuelLevel+_tick;if(_fuelLevel>1) then{_fuelLevel=1};_text=format["Cost: $%1 | %2/%3 litres",[_cost]call life_fnc_numberText,round(_capacity*_fuelLevel),_capacity];_cP=_cP+_tick;_progress progressSetPosition _cP;_pgText ctrlSetText format["%3 (%1%2)...",round(_cP*100),"%",_text];if(speed player>1) exitWith{};if(player distance(_this select 0)>5) exitWith{};if!(life_action_in_use) exitWith{};};5 cutText["","PLAIN"];life_action_in_use=false;if!(local _vehicle) then{[[_vehicle,_fuelLevel],"life_fnc_setFuel",_vehicle]spawn life_fnc_MP;}else{_vehicle setFuel _fuelLevel;};if(_success) then{[format["<t align='center' color='#cec25b'>Litres: %1</t><br/><t align='center' color='#cec25b'>Cost: $%2</t><br/><t align='center' color='#cec25b'>Filled: %3%4</t><br/><br/><t align='center' color='#00FF00'>Refueling completed</t>",_litres,[_cost]call life_fnc_numberText,round(_fuelLevel*100),"%"],"basic"]spawn life_fnc_handleMessage;life_atmcash=life_atmcash-_cost;life_atmcashCache=((life_atmcash/4)+5);[1]call life_fnc_ClupdatePartial;}else{["You cannot afford more gas!","basic"]spawn life_fnc_handleMessage;};