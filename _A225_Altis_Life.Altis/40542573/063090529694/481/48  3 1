params[["_selectedType","",[""]],["_controlData",[],[[]]]];if(_selectedType isEqualTo""||_controlData isEqualTo[]) exitWith{};_controlData params["_control","_selectedIndex"];private _asy_display=findDisplay 875000;private _menuTitle=_asy_display displayCtrl 875002;private _itemPreview=_asy_display displayCtrl 875001;private _mainFilterList=_asy_display displayCtrl 875003;private _leftFilterList=_asy_display displayCtrl 875004;private _mainListGroup=_asy_display displayCtrl 875005;private _mainItemList=_mainListGroup controlsGroupCtrl 1000;private _mainItemListBackground=_mainListGroup controlsGroupCtrl 1003;private _leftListGroup=_asy_display displayCtrl 875006;private _leftItemList=_leftListGroup controlsGroupCtrl 1000;private _leftItemListBackground=_mainListGroup controlsGroupCtrl 1003;private _rightListGroup=_asy_display displayCtrl 875007;private _rightInfoList=_rightListGroup controlsGroupCtrl 1000;private _retractListingButton=_mainListGroup controlsGroupCtrl 1001;private _purchaseListingButton=_rightListGroup controlsGroupCtrl 1001;private _checkAvailButton=_leftListGroup controlsGroupCtrl 1001;private _mainFilterListSelect=lbCurSel _mainFilterList;private _leftFilterListSelect=lbCurSel _leftFilterList;private _leftItemListSelect=lbCurSel _leftItemList;private _mainItemListSelect=lbCurSel _mainItemList;_rightInfoList ctrlSetText"";_itemPreview ctrlSetText"";if((_control isEqualTo _leftItemList)&&!(_selectedIndex isEqualTo-1)) then{_purchaseListingButton ctrlEnable false};if((_control isEqualTo _mainItemList)&&(_selectedIndex isEqualTo-1)) exitWith{_purchaseListingButton ctrlEnable false};{_x ctrlEnable false;}forEach[_retractListingButton,_purchaseListingButton,_checkAvailButton];switch(_selectedType) do{case"selectedListing":{private _listingData=parseSimpleArray(_control lnbData[_selectedIndex,0]);_listingData params["_exchangeID","_playerUID","_playerName","_itemClassname","_vehicleID","_sellingPrice","_itemQuantity","_isVirtual","_isPhysical","_isVehicle","_expiresTimeArray","_boughtTimeArray"];([(_expiresTimeArray/3600),((_expiresTimeArray%3600)/60),(_expiresTimeArray%60)]) params["_crHours","_crMinutes","_crSeconds"];_createdServerTimeString=format["%1 Hours and %2 Minutes",round _crHours,round _crMinutes,round _crSeconds];([(_boughtTimeArray/3600),((_boughtTimeArray%3600)/60),(_boughtTimeArray%60)]) params["_exHours","_exMinutes","_exSeconds"];_createdServerTimeStringExpires=format["%1 Hours and %2 Minutes",round _exHours,round _exMinutes,round _exSeconds];switch(true) do{case(_isVirtual isEqualTo 1):{_resourceDisplayName=["getName",_itemClassname]call life_fnc_virtItemCfg;_resourceImage=["getIcon",_itemClassname]call life_fnc_virtItemCfg;_isIllegalItem=["getIllegalPrice",_itemString]call life_fnc_virtItemCfg;_isIllegalItem=if(_isIllegalItem isEqualTo-1) then{"Legal"}else{"Illegal"};_structuredString1=format["<t align='left' size='1.0'>Listing Owner: %1</t><br/><t align='left' size='1.0'>Virtual Item: %3</t><br/><t align='left' size='1.0'>Legality: %4",_playerName,_playerUID,_resourceDisplayName,_isIllegalItem];