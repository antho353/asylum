private _startMags=count(magazinesAmmoFull[player,true]);private _magazines=[];private _price=0;private _capacity=0;{_x params["_magClassname","_magCurrentAmmo","_loaded"];if!("Grenade"in _magClassname||"Smoke"in _magClassname||"Chem"in _magClassname) then{_capacity=getNumber(configFile>>"CfgMagazines">>_magClassname>>"count");if!(_magCurrentAmmo isEqualTo _capacity) then{_price=_price+50;};if!(_loaded) then{_magazines pushBack _magClassname;};};}forEach(magazinesAmmoFull[player,true]);if(_price isEqualTo 0) exitWith{["You don't have any mags which need refilling.","basic"]spawn life_fnc_handleMessage};private _action=[format["Do you wish to pay $%1 to refill your magazines?",[_price]call life_fnc_numberText],"Refill Magazines","Yes","No"]call BIS_fnc_guiMessage;if!(_action) exitWith{};private _startPos=getPos player;