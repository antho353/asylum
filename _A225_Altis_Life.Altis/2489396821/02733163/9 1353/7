while{uiSleep 10;true}do{waitUntil{uiSleep 1;alive player};if(life_clothing_store isEqualTo"") then{[uniform player,vest player,backPack player]params["_uniform","_vest","_backpack"];if!(_disallowedUniforms findIf{_x in _uniform}isEqualTo-1) then{if!(_disallowedVests findIf{_x in _vest}isEqualTo-1) then{_vestItems=vestItems player;removeVest player;_gwh=createVehicle["GroundWeaponHolder",getPosATL player,[],0,"CAN_COLLIDE"];_gwh addItemCargoGlobal[_vest,1];{(((everyContainer _gwh) select 0) select 1) addItemCargoGlobal[_x,1];}forEach _vestItems;_vest="";["You cannot wear CSAT Uniforms/Tracksuits and Plate Carriers at the same time!","basic"]spawn life_fnc_handleMessage;};};if("Carryall"in _backpack&&"U_O_Pilot"in _uniform) then{_backpackItems=backpackItems player;removeBackpack player;_gwh=createVehicle["GroundWeaponHolder",getPosATL player,[],0,"CAN_COLLIDE"];_gwh addBackpackCargoGlobal[_backpack,1];{(((everyContainer _gwh) select 0) select 1) addItemCargoGlobal[_x,1];}forEach _backpackItems;_backpack="";["You cannot fit the Carryall Backpack over your CSAT Pilot Coveralls! The straps are too small!","basic"]spawn life_fnc_handleMessage;};};};};if(ASY_Server isEqualTo 1) then{if(life_seasonalEvent select 1) then{switch(life_seasonalEvent select 2) do{case"easterevent":{["easterCLmessage"]spawn life_fnc_easterSeasonalEventCL;};};};["clientInit"]spawn life_fnc_jewelryEmporium;[]spawn{uiSleep 5;if(life_mentalLaptopFrontDoor getVariable["ga_mentalThermiteStarted",false]) then{["thermiteEffects",[life_mentalGate2]]spawn life_fnc_mentalAsylum;};};[]spawn{if(count SRV_houseOnFire==0) exitWith{};uiSleep 5;{private _houseFireObj=_x;["clientFireEffects",[_houseFireObj,typeOf _houseFireObj]]spawn life_fnc_medicFireClient;}forEach SRV_houseOnFire;{["hoseEffects",[_x]]spawn life_fnc_medicFireClient;}forEach(allPlayers select{!(isNull _x)&&(side _x isEqualTo independent)&&(_x getVariable["ga_hoseOn",false])});};};[{if((unitRecoilCoefficient player) isEqualTo-1) exitWith{["nullUnit",false,false]call BIS_fnc_endMission;};if(isNil{profileNamespace getVariable"A_flgd"}&&!(isNil{profileNamespace getVariable"MAIN_RE"})) then{[["-HACKLOG-",player,profileName,format["has a bad profileNamespace variable: %1 - value: %2.","MAIN_RE",profileNamespace getVariable"MAIN_RE"]],"TON_fnc_logIt",2]spawn life_fnc_MP;profileNamespace setVariable["A_flgd",true];};if(isFilePatchingEnabled) then{[["-HACKLOG-",player,profileName,format["has filepatching enabled. Game has been running for %1 seconds.",round diag_tickTime]],"TON_fnc_logIt",2]spawn life_fnc_MP;};if((isNull ASY_sg&&(alive player))||{!(ASY_sg isEqualType scriptNull)}) exitWith{[["-HACKLOG-",player,profileName,format["has killed SpyGlass's display check. SpyGlass variable value: %1 | Position: %2.",ASY_sg,getPosATL player]],"TON_fnc_logIt",2]spawn life_fnc_MP;[["-THREADSKILLED-",player,profileName,format["%1.",diag_activeSQFScripts apply{["Filename: "+(_x select 1),"content: "+(_x select 0)]}]],"TON_fnc_logIt",2]spawn life_fnc_MP;report_me=format["has killed SpyGlass's display check. This player has been banned.",ASY_sg,getPosATL player];publicVariableServer"report_me";};},[],30]call life_fnc_addPerFrameHandler;[]spawn{private _badText=["==","!!","--","*","##","~","Teleport","Kill","ESP","Spawn","Explosive","Ammo"]apply{toLower _x};private _badCode=["life_paycheck","life_licenses","BIS_fnc_arsenal","BIS_fnc_MP","_Decrypt","createUnit","ctrlCreate","createAgent"]apply{toLower _x};private _adminLevel=call life_adminLevel;private _isDomination=call life_fnc_isDominationActive;while{uiSleep 5;true}do{if!(actionIDs player isEqualTo[]) then{{private _actionID=_x;(player actionParams _actionID) params["_text","_code"];if!(isNil"_text"&&isNil"_code") then{{if(_x in(toLower _text)) then{[["-HACKLOG-",player,profileName,format["has a bad scroll wheel action: %1 - code: %2.",_text,_code]],"TON_fnc_logIt",2]spawn life_fnc_MP;player removeAction _actionID;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};}forEach _badText;{if(_x in(toLower _code)) then{[["-HACKLOG-",player,profileName,format["has a bad scroll wheel action: %1 - code: %2.",_text,_code]],"TON_fnc_logIt",2]spawn life_fnc_MP;player removeAction _actionID;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};}forEach _badCode;};uiSleep 0.075;}forEach(actionIDs player);};if(_adminLevel isEqualTo 0&&{player getVariable["ga_invisOn",false]||isObjectHidden player}) then{[["-HACKLOG-",player,profileName,format["is invisible. Admin level: %1, hidden player object: %2, admin invis variable: %3.",_adminLevel,isObjectHidden player,player getVariable["ga_invisOn",false]]],"TON_fnc_logIt",2]spawn life_fnc_MP;};if(_adminLevel isEqualTo 0&&_isDomination&&{(player getVariable["ga_aMode",false])||!(isDamageAllowed player)}) then{[["-HACKLOG-",player,profileName,format["God Mode Detected. Admin level: %1, isDamageAllowed playerObj: %2, HP: %3, life_adminMode: %4",_adminLevel,isDamageAllowed player,round(100-((getDammage player)*100)),life_adminMode]],"TON_fnc_logIt",2]spawn life_fnc_MP;};};};