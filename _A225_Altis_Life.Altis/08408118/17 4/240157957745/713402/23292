disableSerialization;if(visibleMap||{!alive player}||{dialog}) exitWith{500 cutText["","PLAIN"];};private _ui=uiNamespace getVariable["ga_hud_nametags",displayNull];if(isNull _ui) then{500 cutRsc["ga_hud_nametags","PLAIN"];_ui=uiNamespace getVariable["ga_hud_nametags",displayNull];};private _isDominationActive=call life_fnc_isDominationActive;if(life_targetTag&&!(_isDominationActive)) then{if!(isNull cursorTarget) then{if!(cursorTarget in life_tag_units) then{if((cursorTarget isKindOf"CAManBase"&&isPlayer cursorTarget)||cursorTarget isKindOf"Car"||cursorTarget isKindOf"Air"||cursorTarget isKindOf"Ship") then{life_tag_units pushBack cursorTarget;};};};};private _eyePosVehicle=if(isNull objectParent player) then{player}else{objectParent player};{private _idc=_ui displayCtrl(78000+_forEachIndex);private _targetEyePosVehicle=if(isNull objectParent _x) then{_x}else{objectParent _x};if(alive _x&&{!(lineIntersects[eyePos _eyePosVehicle,eyePos _targetEyePosVehicle,_eyePosVehicle,_targetEyePosVehicle])}) then{private _pos=[visiblePosition _x select 0,visiblePosition _x select 1,((_x modelToWorld(_x selectionPosition"head")) select 2)+0.5];private _sPos=worldToScreen _pos;private _distance=_pos distance player;private _maxDistance=if(goggles _x in life_masks) then{[5,10]select _isDominationActive}else{20};private _hidden=((goggles _x in life_masks)&&(_distance>_maxDistance)&&!(side _x isEqualTo independent));if(count _sPos>1&&!(_x getVariable["ga_invisOn",false])&&{(_distance<=_maxDistance)||{life_targetTag&&_x isEqualTo cursorTarget}}) then{if(_x isKindOf"CAManBase"||!((crew _x) isEqualTo[])) then{private _icon=call{if!(_x isKindOf"CAManBase") exitWith{if(_x getVariable["ga_vehicleIconCache",""]isEqualTo"") then{_x setVariable["ga_vehicleIconCache",getText(configFile>>"CfgVehicles">>typeOf _x>>"picture")];};format["<img image='%1' size='1'></img>  ",_x getVariable["ga_vehicleIconCache",""]];};if(side _x isEqualTo independent) exitWith{private _iconPath=["","icons\med_emr.paa","icons\med_emt.paa","icons\med_advemt.paa","icons\med_paramedic.paa","icons\med_asstchief.paa","icons\med_chief.paa"]select(_x getVariable["ga_medLevel",0]);format["<img image='%1' size='1'></img>  ",MISSION_ROOT+_iconPath];};if((side _x isEqualTo west)&&(call life_fnc_isDominationActive)) exitWith{format["<img image='%1icons\SrtIcon.paa' size='1'></img>  ",MISSION_ROOT]};if((side _x isEqualTo west)&&(_x getVariable["ga_showrank",true])) exitWith{private _iconPath=["","\A3\Ui_f\data\GUI\Cfg\Ranks\private_gs.paa",MISSION_ROOT+"icons\pfc_gs.paa","\A3\Ui_f\data\GUI\Cfg\Ranks\corporal_gs.paa","\A3\Ui_f\data\GUI\Cfg\Ranks\sergeant_gs.paa","\A3\Ui_f\data\GUI\Cfg\Ranks\lieutenant_gs.paa","\A3\Ui_f\data\GUI\Cfg\Ranks\captain_gs.paa"]select(_x getVariable["ga_copLevel",0]);format["<img image='%1' size='1'></img>  ",_iconPath];};if(_x getVariable["ga_activeBounty",false]) exitWith{format["<img image='%1icons\police.paa' size='1'></img>  ",MISSION_ROOT]};if((getPlayerUID _x) isEqualTo(SRV_governorData param[0,"Nah"])) exitWith{format["<img image='%1icons\govern.paa' color='#FF0000' size='1'></img>  ",MISSION_ROOT]};if((_x getVariable["ga_subscriber",false])&&!(call life_fnc_isDominationActive)&&(_x getVariable["ga_ShowAsylumPlusIcon",false])) exitWith{format["<img image='%1icons\asylumPlus.paa' size='1'></img>  ",MISSION_ROOT]};""};private _text=call{if!(_x isKindOf"CAManBase") exitWith{_text=[];{private _extra=if(_forEachIndex>0) then{", "}else{""};if((goggles _x in life_masks)&&{(_distance>_maxDistance)}) then{if((currentWeapon player in["Binocular","Rangefinder"]&&{cameraView=="Gunner"})||(_x in(units group player))) then{_text pushBack(format["%1%3%2",_extra,(_x getVariable["ga_name",[name _x]call life_fnc_cleanName]),((group _x) getVariable["ga_grpTag",""])]) }else{_text pushBack(format["%1Unknown",_extra]);};}else{_text pushBack(format["%1%3%2",_extra,(_x getVariable["ga_name",[name _x]call life_fnc_cleanName]),((group _x) getVariable["ga_grpTag",""])]) };