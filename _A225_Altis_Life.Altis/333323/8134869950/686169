#include"..\..\macro.h"
disableSerialization;createDialog"ClientSettings";waitUntil{!isNull(findDisplay 2900)};private _display=findDisplay 2900;[_display]spawn life_fnc_p_updateMenu;private _settingsGroup=_display displayCtrl 2901;private _fixUniform=_display displayCtrl 2902;private _subscriber=call life_subscribed;private _allGroupControls=[];{if((ctrlParentControlsGroup _x) isEqualTo _settingsGroup) then{(ctrlPosition _x) params["_placeX","_placeY","_width","_height"];private _controlIDC=ctrlIDC _x;private _control=_x;_allGroupControls pushBack _x;private _previousControl=_allGroupControls param[(_allGroupControls findIf{_x isEqualTo _control})-1,controlNull];private _previousControlPosition=if!(isNull _previousControl) then{ctrlPosition _previousControl}else{ctrlPosition _control};private _spacing=switch(true) do{case(isNull _previousControl):{0};case("Start"in ctrlClassName _x):{0.055};case("Start"in ctrlClassName _previousControl):{0.03125};case("Header"in ctrlClassName _x):{0.055};case("Start"in ctrlClassName _x):{0.055};case("Label"in ctrlClassName _x):{0.055};case("_Slider"in ctrlClassName _x):{0};case("_Filter"in ctrlClassName _x):{0};case("MarkerClass"in ctrlClassName _x):{0.055};case("End"in ctrlClassName _x):{0.0575};case("MiscClass"in ctrlClassName _x):{0.055};default{0};};switch(ctrlType _x) do{case 0:{_x ctrlSetPosition[_placeX,(_previousControlPosition select 1)+_spacing,(ctrlPosition _settingsGroup) select 2,_height];if((((ctrlClassName _x) find"Header")>=0)&&(true)) then{_x ctrlSetBackgroundColor[1,0,0,0.25]};};case 43:{private _position=switch(true) do{case(_controlIDC<=1006):{[_placeX,(_previousControlPosition select 1)+_spacing,((ctrlPosition _settingsGroup) select 2)-(_placeX+(((ctrlPosition _settingsGroup) select 2)*0.263)),_height]};case(_controlIDC isEqualTo 1008):{[_placeX,(_previousControlPosition select 1)+_spacing,((ctrlPosition _settingsGroup) select 2)-(_placeX+(((ctrlPosition _settingsGroup) select 2)*0.202)),_height]};case(_controlIDC>=2000):{[_placeX,(_previousControlPosition select 1)+_spacing,((ctrlPosition _settingsGroup) select 2)-_placeX,_height]};default{[_placeX,(_previousControlPosition select 1)+_spacing,_width,_height]};};_x ctrlSetPosition _position;};case 7:{_x ctrlSetPosition[_placeX,(_previousControlPosition select 1)+_spacing,((ctrlPosition _settingsGroup) select 2)-_placeX,_height];};case 4:{_x ctrlSetPosition[_placeX,(_previousControlPosition select 1)+_spacing,((ctrlPosition _settingsGroup) select 2)-_placeX,_height];};default{};};_x ctrlCommit 0;};}forEach(allControls _display);_fixUniform ctrlSetText"Fix Uniform";_fixUniform ctrlAddEventHandler["ButtonClick","[player, _this select 0] spawn life_fnc_fixUniform"];if(time<life_uniformCooldown) then{_fixUniform ctrlEnable false;[_fixUniform]spawn{if!(params[["_button",controlNull]]) exitWith{};while{!isNull _button}do{private _timeRemaining=toArray([ceil(life_uniformCooldown-time),"MM:SS"]call BIS_fnc_secondsToString);if((_timeRemaining select 0) in[48]) then{_timeRemaining deleteAt 0};private _timeRemaining=toString _timeRemaining;_button ctrlSetText format["Fix Uniform [%1]",_timeRemaining];uiSleep 1;};_button ctrlSetText"Fix Uniform";_button ctrlEnable true;};};private _clientSettings=profileNamespace getVariable["AsylumClientSettings",life_clientDefaultSettings];{_x params["_controlIDC","_viewDistance","_updateMode"];(_display displayCtrl(_controlIDC+1)) sliderSetSpeed[100,100,100];slidersetRange[_controlIDC+1,100,12000];sliderSetPosition[_controlIDC+1,_viewDistance];ctrlSetText[_controlIDC,format["%1m",[_viewDistance]call life_fnc_numberText]];(_display displayCtrl(_controlIDC+1)) ctrlAddEventHandler["SliderPosChanged",format["[%1, _this select 1] call life_fnc_s_onSliderChange",_forEachIndex]];}forEach[[1001,tawvd_foot],[1003,tawvd_car],[1040,tawvd_air]];slidersetRange[1008,0.01,1];sliderSetPosition[1008,life_volume];(_display displayCtrl 1008) sliderSetSpeed[0.01,0.01,0.01];ctrlSetText[1007,format["[%1%2]",round(life_volume*100),"%"]];(_display displayCtrl 1008) ctrlAddEventHandler["SliderPosChanged","[7, _this select 1] call life_fnc_s_onSliderChange"];private _ringerToggle=_settingsGroup controlsGroupCtrl 1009;private _sidechatToggle=_settingsGroup controlsGroupCtrl 1010;private _playerTagsToggle=_settingsGroup controlsGroupCtrl 1011;private _envSoundsToggle=_settingsGroup controlsGroupCtrl 1012;private _scrollOptsToggle=_settingsGroup controlsGroupCtrl 1016;private _earplugsVolumeToggle=_settingsGroup controlsGroupCtrl 1017;private _grpHexToggle=_settingsGroup controlsGroupCtrl 1018;private _titlesToggle=_settingsGroup controlsGroupCtrl 1019;private _ignoreCallToggle=_settingsGroup controlsGroupCtrl 1020;private _ignoreGangInvToggle=_settingsGroup controlsGroupCtrl 1021;private _enableAmbientLifeToggle=_settingsGroup controlsGroupCtrl 1022;private _enableCustomHexesToggle=_settingsGroup controlsGroupCtrl 1023;