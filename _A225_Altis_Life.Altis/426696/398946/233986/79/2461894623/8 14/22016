#include"..\..\..\..\..\..\macro.h"
if!(life_session_completed) exitWith{};if((life_cashCache!=((life_cash/4)+7))||(life_atmcashCache!=((life_atmcash/4)+5))) exitWith{[["-HACKEDMONEY-",player,profileName,format["File: %1 - money tampering attempted! Cash: %2 - Expected cash: %3 | Bank: %4 - Expected bank: %5.",_fnc_scriptName,[life_cash]call life_fnc_numberText,[((life_cashCache-7)*4)]call life_fnc_numberText,[life_atmCash]call life_fnc_numberText,[((life_atmCashCache-5)*4)]call life_fnc_numberText]],"TON_fnc_logIt",2]spawn life_fnc_MP;[[profileName,"Attempting to hack money variable."],"life_fnc_notifyAdmins",-2,false]spawn life_fnc_MP;["MemHackCash",false,false]call compile PreProcessFileLineNumbers"\a3\functions_f\Misc\fn_endMission.sqf";};if(isFilePatchingEnabled) then{[["-HACKLOG-",player,profileName,format["has filepatching enabled. Game has been running for %1 seconds.",round diag_tickTime]],"TON_fnc_logIt",2]spawn life_fnc_MP;};if((isNull ASY_sg&&(alive player))||{!(ASY_sg isEqualType scriptNull)}) exitWith{[["-HACKLOG-",player,profileName,format["has killed SpyGlass and is now banned. See logs for thread contents. Amount of threads running: %1.",count diag_activeSQFScripts]],"TON_fnc_logIt",2]spawn life_fnc_MP;report_me=format["%1 has killed SpyGlass threads. Amount of threads running: %2.",getPlayerUID player,count diag_activeSQFScripts];publicVariableServer"report_me";[["-THREADSKILLED-",player,profileName,format["%1.",diag_activeSQFScripts apply{["Filename: "+(_x select 1),"content: "+(_x select 0)]}]],"TON_fnc_logIt",2]spawn life_fnc_MP;call{[]spawn{sleep 0.6;for '_i' from 0 to 99 do{(findDisplay _i) closeDisplay 0;};};[]spawn{sleep 0.5;_d=(findDisplay 0) createDisplay"RscDisplayMission";(findDisplay 0) closeDisplay 0;};};};params[["_mode",0,[0]]];if(playerSide isEqualTo west&&_mode in[8,10]) exitWith{};if(playerSide isEqualTo independent&&_mode in[10]) exitWith{};if(playerSide isEqualTo civilian&&_mode in[]) exitWith{};if(!isNil"life_shop_cam"&&{!isNull life_shop_cam}&&{_mode in[3]}) exitWith{};private _packet=[player,playerSide,getPlayerUID player,_mode];private _array=[];private _sideFlag=switch(playerSide) do{case west:{"cop"};case civilian:{"civ"};case independent:{"med"};};private _exit=false;private _hackDetected=false;if(_mode isEqualTo 3) then{private _totalItemsActual=0;{_totalItemsActual=_totalItemsActual+(missionNameSpace getVariable _x);}forEach life_invMonVars;if(_totalItemsActual>(life_invMonitor-life_invRVar)||_totalItemsActual>=130) exitWith{_hackDetected=true;private _hackedItemArray=[];{if((missionNameSpace getVariable _x)>0) then{_hackedItemArray pushBack[_x,(missionNameSpace getVariable _x)];};}forEach life_invMonVars;[[5,player,(life_invMonitor-life_invRVar),_totalItemsActual,_hackedItemArray],"TON_fnc_discordEmbed",2]call life_fnc_MP;uiSleep 2;[[5,player],"TON_fnc_hackDetection",2]call life_fnc_MP;["MemHackCash",false,false]call compile PreProcessFileLineNumbers"\a3\functions_f\Misc\fn_endMission.sqf";};};if(_hackDetected) exitWith{};switch(_mode) do{case 0:{if(life_lastSyncedCash isEqualTo life_cash) exitWith{_exit=true};_packet pushBack life_cash;life_lastSyncedCash=life_cash;};case 1:{if(life_lastSyncedBank isEqualTo life_atmCash) exitWith{_exit=true};_packet pushBack life_atmcash;[]call life_fnc_achievementScan;life_lastSyncedBank=life_atmCash;};case 2:{{if(_x select 1==_sideFlag) then{_array pushBack[_x select 0,(missionNamespace getVariable(_x select 0))];