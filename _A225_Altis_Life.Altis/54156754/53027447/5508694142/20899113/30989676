params[["_caseType","",[""]],"_phoneData"];switch(_caseType) do{case("startPhoneCall"):{_phoneData params[["_button",controlNull,[controlNull]]];if(_button isEqualTo controlNull) exitWith{[format["fucked %1",_this],"warning"]spawn life_fnc_handleMessage;};if!((lbCurSel 9501)>=0) exitWith{["You must select a player you are trying to call!","basic"]spawn life_fnc_handleMessage;};private _data=(lbData[9501,lbCurSel 9501]);private _target=vehicles param[vehicles findIf{(parseNumber _data) isEqualTo(_x getVariable["ga_dbInfo",[]]param[1,-1])},objNull];if!(isNull _target) exitWith{["callInBomb",_target]spawn life_fnc_remoteExplosive};private _target=allPlayers param[allPlayers findIf{_data isEqualTo(getPlayerUID _x)},objNull];if(isNull _target) exitWith{["The player you are trying to message can't be found","basic"]spawn life_fnc_handleMessage;};if(((side _target) isEqualTo west)&&((life_is_arrested param[0,0]) isEqualTo 1)) exitWith{["Prison inmates are not allowed to call officers of the law!","basic"]spawn life_fnc_handleMessage;};life_phoneCallStatus=1;[]spawn life_fnc_cellphone_call;[["receivePhoneCall",[profileName,player]],"life_fnc_phoneCallClient",_target]spawn life_fnc_MP;[format["You have started calling %1",[name _target]call life_fnc_cleanName],"basic"]spawn life_fnc_handleMessage;[]spawn{for"_i"from 1 to 4 do{if(life_phoneCallStatus isNotEqualTo 1) exitWith{};if!(life_isRingEnabled) exitWith{};playSound"PhoneDial";uiSleep 3;};};private _ringStart=time;waitUntil{uiSleep 1;((_ringStart<time-30)||(life_phoneCallStatus isNotEqualTo 1))};if((_ringStart<time-30)&&(life_phoneCallStatus isEqualTo 1)) then{["declinePhoneCallReciever"]spawn life_fnc_phoneCallClient;};if!(isNull(findDisplay 9500)) then{[]spawn life_fnc_cellphone_call;};[]spawn{waitUntil{uiSleep 0.5;(life_phoneCallStatus isEqualTo-1)};if!(isNull(findDisplay 9500)) then{[]spawn life_fnc_cellphone_call;};};};case("receivePhoneCall"):{_phoneData params[["_callerName","",[""]],["_callerObj",objNull,[objNull]]];if(life_phoneCallStatus isEqualTo 2) exitWith{};if!(life_incomingCallsIgnored) then{[format["%1 is calling your phone! Press 8 to answer or 9 to decline.",_callerName],"phone_call"]spawn life_fnc_handleMessage;systemChat"You can also disable all incoming calls in your phone settings";[]spawn{for"_i"from 1 to 4 do{if!(life_isRingEnabled) exitWith{};if(life_phoneCallStatus isNotEqualTo 1) exitWith{};playSound"PhoneRing";uiSleep 3;};};};life_phoneCallStatus=1;life_phoneCallData=[_callerObj,_callerName,player,profileName];private _ringStart=time;waitUntil{uiSleep 1;((_ringStart<time-30)||(life_phoneCallStatus isNotEqualTo 1))};if((_ringStart<time-30)&&(life_phoneCallStatus isEqualTo 1)) then{if!(life_incomingCallsIgnored) then{[format["You ignored the incoming phone call from %1",_callerName],"basic"]spawn life_fnc_handleMessage;};life_phoneCallStatus=3;life_phoneCallData=[objNull,"",objNull,""];if!(isNull(findDisplay 9500)) then{[]spawn life_fnc_cellphone_call;};[]spawn{uiSleep 10;life_phoneCallStatus=0;if!(isNull(findDisplay 9500)) then{[]spawn life_fnc_cellphone_call;