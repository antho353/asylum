#include"..\..\..\macro.h"
if((playerSide isEqualTo civilian&&!(license_civ_bounty))||(playerSide isEqualTo west&&!(life_coprole in["all","warrant"]))||playerSide isEqualTo independent) exitWith{};if(scriptAvailable(5)) exitWith{["You must wait 5 seconds to request another bounty.","basic"]spawn life_fnc_handleMessage;};private _maxBounty=switch(true) do{case(8 in life_side_talents||playerSide isEqualTo west):{5000000};case(3 in life_side_talents):{150000};case(2 in life_side_talents):{100000};case(1 in life_side_talents):{50000};default{0};};private _maxBounties=switch(true) do{case(4 in life_side_talents):{4};case(playerSide isEqualTo civilian):{2};case(playerSide isEqualTo west):{1};default{0};};if(_maxBounty isEqualTo 0||_maxBounties isEqualTo 0) exitWith{};if(count life_bounty_list>=_maxBounties) exitWith{[format["You already have a maximum of %1 bounties.",_maxBounties],"basic"]spawn life_fnc_handleMessage};private _initPossibleBounties=(allPlayers-allDeadMen) select{(side _x isEqualTo civilian)&&{_x getVariable["ga_wantedAmt",-1]<=_maxBounty}&&(_x getVariable["ga_wantedAmt",-1]>=25000)};if(_initPossibleBounties isEqualTo[]) exitWith{["No bounties are currently available. Please try again later.","basic"]spawn life_fnc_handleMessage};private _finalPossibleBounties=[];private _weights=[];{private _person=_x;private _failedCount={!(_x)}count[!isNull _person,(_person getVariable["ga_wantedAmt",0])>=25000,(_person getVariable["ga_wantedAmt",0])<=_maxBounty,!((getPlayerUID player) isEqualTo(getPlayerUID _person)),!(_person getVariable["ga_arrested",false]),(_person distance(getMarkerPos"Respawn_west"))>=750,(life_bounty_list findIf{getPlayerUID _person in _x}isEqualTo-1),[getPlayerUID _person]call life_fnc_isUIDActive,!((group _person) isEqualTo(group player)),!(_person getVariable["ga_invisOn",false]),!((_person getVariable["gang_data",[-123]]select 0) isEqualTo(player getVariable["gang_data",[-321]]select 0)) ];if(_failedCount isEqualTo 0) then{_finalPossibleBounties pushBack _person;_weights pushBack((_person getVariable"ga_wantedAmt")/25000);};}forEach _initPossibleBounties;if(_finalPossibleBounties isEqualTo[]) exitWith{["No bounties are currently available. Please try again later.","basic"]spawn life_fnc_handleMessage};private _bounty=objNull;private _dropped=[];private _exitTime=time+5;while{true}do{if(_finalPossibleBounties isEqualTo[]||!(isNull _bounty)||time>_exitTime) exitWith{};private _randomBounty=_finalPossibleBounties selectRandomWeighted _weights;if(getPlayerUID _randomBounty in life_dropped_bounties) then{_dropped pushBack _randomBounty;private _bountyIndex=_finalPossibleBounties findIf{_x isEqualTo _randomBounty};_finalPossibleBounties deleteAt _bountyIndex;