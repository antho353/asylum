{_x ctrlCommit 0}forEach(allControls _asy_display);};private _headerInfo=[["Listing Information",false],["Type",true]];{private _mainItemList=_x;private _itemList=_x controlsGroupCtrl 1000;private _itemListWidth=(ctrlPosition _itemList) select 2;private _columnPositions=lnbGetColumnsPosition _itemList;{private _currentColumnPosition=_x*_itemListWidth;(_headerInfo select _forEachIndex) params[["_headerText",""],["_sortByValue",false]];private _nextColumnPosition=if!(_forEachIndex isEqualTo((count _columnPositions)-1)) then{_columnPositions select(_forEachIndex+1)}else{1};_nextColumnPosition=_nextColumnPosition*_itemListWidth;private _control=_asy_display ctrlCreate["Life_RscListNBoxHeaderButton",1002,_mainItemList];_control ctrlSetPosition[_currentColumnPosition,0,(_nextColumnPosition-_currentColumnPosition)+0.0002,0.05];_control ctrlSetStructuredText parseText format["<t size='0.8'>%1</t><t align='right' size='0.6'><img image='%2'/></t>",_headerText,"icons\arrows.paa"];_control ctrlCommit 0;_control ctrlAddEventHandler["ButtonClick",format["[%1, %2, %3, false, _this select 0] call life_fnc_listNBoxSort;",format["((findDisplay 876000) displayCtrl %1) controlsGroupCtrl 1000",ctrlIDC _mainItemList],_forEachIndex,_sortByValue]];if(_forEachIndex isEqualTo 0) then{[_itemList,_forEachIndex,_sortByValue,false,_control]call life_fnc_listNBoxSort};}forEach _columnPositions;}forEach[_mainListGroup];{_x ctrlEnable false}forEach[_retrieveButton,_relistButton];_mainFilterList ctrlAddEventHandler["LBSelChanged",format["['%1', _this] call life_fnc_exchangeStorageMenuFilter;","listingFilter"]];_mainItemList ctrlAddEventHandler["LBSelChanged",format["['%1', _this] call life_fnc_exchangeStorageMenuSelection;","selectedListing"]];_relistButton ctrlAddEventHandler["ButtonClick",format["['%1', _this select 0] spawn life_fnc_exchangeStorageMenuManage;","relistListing"]];_retrieveButton ctrlAddEventHandler["ButtonClick",format["['%1', _this select 0] spawn life_fnc_exchangeStorageMenuManage;","retrieveListing"]];_mainFilterList lbSetCurSel 0;private _allControls=allControls _asy_display;if((lbSize _mainFilterList)<=1) then{_allControls=_allControls-[_mainFilterList]};{waitUntil{ctrlCommitted _x};_x ctrlSetFade 0;_x ctrlCommit 0.05}forEach _allControls;waitUntil{(isNull _asy_display)};life_exchangeStorageRequested=false;life_exchangeFailedListings=[];life_exchangeStorage=[];