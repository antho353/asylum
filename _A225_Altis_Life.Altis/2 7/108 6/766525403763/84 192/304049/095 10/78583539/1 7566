if!(alive player) exitWith{};if(_cp>=1) exitWith{_success=true;};};5 cutText["","PLAIN"];life_action_in_use=false;if!(_success) exitWith{["The loadout equipping process has failed. Try again.","basic"]spawn life_fnc_handleMessage;};if(_currency isEqualTo"$"&&{life_atmcash<_price}) exitWith{["You don't have enough money in your bank account for this loadout.","basic"]spawn life_fnc_handleMessage;};if(_currency isEqualTo"BM"&&{life_bloodMoney<_price}) exitWith{["You don't have enough Blood Money for this loadout.","basic"]spawn life_fnc_handleMessage;};if(_currency isEqualTo"$") then{life_atmcash=(round(life_atmcash-_price)) max 0;life_atmcashCache=((life_atmcash/4)+5);[1]call life_fnc_ClupdatePartial;}else{life_bloodMoney=life_bloodMoney-_price;[18]call life_fnc_ClupdatePartial;};private _asy_obj=player;_asy_obj setUnitLoadout _gearArray;if(_virtualArray isNotEqualTo[]) then{life_carryWeight=0;{missionNamespace setVariable[_x,0];}forEach([1]call life_fnc_virtItemCfg);{_x params["_item","_amount"];[true,_item,_amount]call life_fnc_handleInv;}forEach _virtualArray;if(life_inv_debitcard isEqualTo 0) then{[true,"debitcard",1]call life_fnc_handleInv;};[]call life_fnc_giveMedkits;};[_skins]spawn{params["_skins"];uiSleep 0.5;[uniform player,"setIdx",_skins select 0]call life_fnc_clothingTextures;[backpack player,"setIdx",_skins select 1]call life_fnc_clothingTextures;life_uniformBackpack_skins=[_skins select 0,_skins select 1];};private _var=switch(playerSide) do{case civilian:{"ga_clothingSkinsCiv"};case west:{"ga_clothingSkinsCop"};case independent:{"ga_clothingSkinsMed"};};profileNamespace setVariable[_var,life_uniformBackpack_skins];if(_type isEqualTo"rebel") then{private _pointData=arms_flag getVariable["ga_capData",[0,"Neutral",-1]];_pointData params["_flagGangID","","_progress"];if(_flagGangID isEqualTo 0) exitWith{};life_armsCartel=[false,0,_flagGangID];if((count life_gang_data)>0) then{if((_flagGangID isEqualTo(life_gang_data select 0))&&(_progress>=0)) then{life_armsCartel set[0,true];};};};private _extra="";private _cut=switch(true) do{case((_type isEqualTo"rebel")&&!(life_armsCartel select 0)&&((call life_adminLevel)<3)):{floor(_price*0.08)};case!(_type isEqualTo"rebel"):{floor(_price*(call life_fnc_getGovTax))};default{0};};private _govTaxedShops=["skiptracer","medic","cop"];if((_type isEqualTo"rebel")&&!(life_armsCartel select 0)&&((call life_adminLevel)<3)) then{private _updateVal=(life_armsCartel select 1);_updateVal=_updateVal+_cut;life_armsCartel set[1,_updateVal];_extra=format[", with $%1 going to the owner of the Arms Dealer",[_cut]call life_fnc_numberText];};if((_type in _govTaxedShops)&&((call life_adminLevel)<3)) then{private _updateVal=(life_govTax select 1);_updateVal=_updateVal+_cut;life_govTax set[1,_updateVal];_extra=format[", including a tax of $%1",[_cut]call life_fnc_numberText];};if(!((life_armsCartel select 2) isEqualTo-1)&&!((life_armsCartel select 1) isEqualTo 0)) then{[[2,life_armsCartel select 2,player,life_armsCartel select 1],"TON_fnc_gangBank",false,false]spawn life_fnc_MP;life_armsCartel=[false,0,-1];};if(((_govTaxedShops find _type) isNotEqualTo-1)&&!(life_govTax param[0,false])) then{if(!((life_govTax select 2) isEqualTo-1)&&!((life_govTax select 1) isEqualTo 0)) then{["payGovernor",[(life_govTax param[1,0])]]spawn life_fnc_govSystem;life_turfTax set[1,0];};};if((call life_fnc_isDominationActive)&&([player]call life_fnc_inDomSafezone)&&((call life_adminLevel)<3)) then{life_dominationPotCache=life_dominationPotCache+_price;[format["Your loadout cost has added $%1 to the Domination event prize pool!",[_price]call life_fnc_numberText]]spawn life_fnc_handleMessage;};private _rebelOutposts=["Rebelop_1","Rebelop_2","Rebelop_3","Rebelop_4","Rebelop_5","Rebelop_6"];if!(({player distance(getMarkerPos _x)<=200}count _rebelOutposts) isEqualTo 0) then{["moneyspentrebel",_price]call life_fnc_statArrUpdate;};[["-DOMLOADOUTEQUIP-",player,(profileName),format["equipped a loadout for $%1 at POS: %2 - %3 - %4",_price,getPos player,_gearArray,_virtualArray]],"TON_fnc_logIt",2]spawn life_fnc_MP;