#include"..\..\macro.h"
if(scriptAvailable(8)) exitWith{["You spam this action...","basic"]spawn life_fnc_handleMessage;};if((life_cashCache!=((life_cash/4)+7))||(life_atmcashCache!=((life_atmcash/4)+5))) exitWith{[["-HACKEDMONEY-",player,profileName,format["File: %1 - money tampering attempted! Cash: %2 - Expected cash: %3 | Bank: %4 - Expected bank: %5.",_fnc_scriptName,[life_cash]call life_fnc_numberText,[((life_cashCache-7)*4)]call life_fnc_numberText,[life_atmCash]call life_fnc_numberText,[((life_atmCashCache-5)*4)]call life_fnc_numberText]],"TON_fnc_logIt",2]spawn life_fnc_MP;[[profileName,"Attempting to hack money variable."],"life_fnc_notifyAdmins",-2,false]spawn life_fnc_MP;["MemHackCash",false,false]call compile PreProcessFileLineNumbers"\a3\functions_f\Misc\fn_endMission.sqf";};params[["_type","",[""]],["_controlData",[],[[]]],["_currency","$",[""]]];_controlData params["_control","_selectedIndex"];private _asy_display=findDisplay 388000;if(isNull _asy_display) exitWith{};private _filterList=_asy_display displayCtrl 388002;private _mainListGroup=_asy_display displayCtrl 388004;private _mainItemList=_mainListGroup controlsGroupCtrl 1000;private _mainItemListBackground=_mainListGroup controlsGroupCtrl 1003;private _sideListGroup=_asy_display displayCtrl 388005;private _sideItemList=_sideListGroup controlsGroupCtrl 1000;private _sideItemListButton=_sideListGroup controlsGroupCtrl 1001;private _deleteButton=_sideListGroup controlsGroupCtrl 1005;private _saveButton=_sideListGroup controlsGroupCtrl 1004;private _dollarsButton=_sideListGroup controlsGroupCtrl 1006;private _bloodMoneyButton=_sideListGroup controlsGroupCtrl 1007;{_x ctrlEnable false;}forEach[_deleteButton,_saveButton,_sideItemListButton,_dollarsButton,_bloodMoneyButton];private _selectedLoadout=_sideItemList lnbValue[lbCurSel _sideItemList,0];private _price=(_sideItemList lnbValue[lbCurSel _sideItemList,1]);private _displayPrice=if(_currency isEqualTo"$") then{"$"+([_price]call life_fnc_numberText)}else{([_price]call life_fnc_numberText)+" Blood Money"};if(_selectedLoadout<0||_price<0) exitWith{};(life_domLoadoutHolder select _selectedLoadout) params[["_uniqueID",-10,[0]],["_loadoutType","",[""]],["_loadoutName","",[""]],["_gearArray",[],[[]]],["_virtualArray",[],[[]]],["_skins",[-1,-1],[[]]]];if(_uniqueID isEqualTo-10||_gearArray isEqualTo[]||!(_currency in["$","BM"])) exitWith{};private _action=[format["Are you sure you want to equip the %1 loadout for %2? It will replace all your current gear and virtual.",_loadoutName,_displayPrice],"Equip Loadout","Purchase","Cancel"]call BIS_fnc_guiMessage;if!(_action) exitWith{};if(_currency isEqualTo"$"&&{life_atmcash<_price}) exitWith{["You don't have enough money in your bank account for this loadout.","basic"]spawn life_fnc_handleMessage;};if(_currency isEqualTo"BM"&&{life_bloodMoney<_price}) exitWith{["You don't have enough Blood Money for this loadout.","basic"]spawn life_fnc_handleMessage;};closeDialog 0;disableSerialization;5 cutRsc["life_progress","PLAIN"];private _ui=uiNamespace getVariable"life_progress";private _progress=_ui displayCtrl 38201;private _pgText=_ui displayCtrl 38202;private _text="Equipping loadout...";_pgText ctrlSetText format["%2 (1%1)...","%",_text];_progress progressSetPosition 0.01;private _cP=0.01;life_action_in_use=true;private _success=false;private _startPos=getPosATL player;private _sleepDelay=if(call life_fnc_isDominationActive) then{0}else{0.15};for"_i"from 0 to 1 step 0 do{uiSleep _sleepDelay;_cP=_cP+0.01;_progress progressSetPosition _cP;_pgText ctrlSetText format["%3 (%1%2)...",round(_cP*100),"%",_text];if((getPosATL player) distance _startPos>10) exitWith{};if!(life_action_in_use) exitWith{};if(player getVariable["ga_restrained",false]) exitWith{};if(life_isDowned) exitWith{};if!(isNull objectParent player) exitWith{};