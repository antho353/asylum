params[["_caseType","",[""]],"_jewelryData"];switch(_caseType) do{case("startDrill"):{if(SRV_jewelryEmporiumSRV param[1,false]) exitWith{["The Jewelry Emporium is already being drilled!"]spawn life_fnc_handleMessage};if!(playerSide isEqualTo civilian) exitWith{};if(life_inv_drill<=0) exitWith{[2,"You need a diamond tip drill to do this."]call life_fnc_broadcast};if!((vehicle player) isEqualTo player) exitWith{[2,"You cannot do this from within a vehicle."]call life_fnc_broadcast};if([]call life_fnc_activeFederalEvent) exitWith{["There is already another Federal Event happening.","basic"]spawn life_fnc_handleMessage;};if!([4]call life_fnc_policeRequired) exitWith{};if(SRV_lastRobbery>(serverTime-(60*15))) exitWith{[2,format["Security is high due to a recent robbery and you cannot start the robbery. Try again in %1 minute(s).",ceil((SRV_lastRobbery-(serverTime-(60*15)))/60)]]call life_fnc_broadcast};if((SRV_jewelryEmporiumSRV param[0,-1800])>serverTime-1800) exitWith{[format["The Jewelry Emporium has recently been breached! Try again in %1 minute(s).",ceil((((SRV_jewelryEmporiumSRV param[0,-1800])+1800)-serverTime)/60)],"basic"]spawn life_fnc_handleMessage;};disableSerialization;5 cutRsc["life_progress","PLAIN"];private _display=uiNameSpace getVariable["life_progress",displayNull];private _progressBar=_display displayCtrl 38201;private _progressText=_display displayCtrl 38202;life_action_in_use=true;private _increment=1;private _totalTime=10;private _currentPoint=0;private _loopDelay=_totalTime/floor(100/_increment);private _text=format["Placing Drill On Emporium Back Door"];private _startCount=0;_progressBar progressSetPosition _startCount;_progressText ctrlSetText format["%1 (%2%3)",_text,_startCount,"%"];[["Acts_TerminalOpen",(_totalTime*5),"switchMove",player],"life_fnc_handleAnim",(allPlayers select{(_x distance player)<=40})]spawn life_fnc_MP;private _isSuccess=for"_i"from 0 to 1 step 0 do{uiSleep _loopDelay;if(isNull _progressBar) exitWith{["You have failed to start the drill","basic"]spawn life_fnc_handleMessage;false};_currentPoint=(progressPosition _progressBar)+(_increment/100);_progressBar progressSetPosition _currentPoint;_progressText ctrlSetText format["%1 (%2%3)",_text,round(_currentPoint*100),"%"];if(_currentPoint>=1) exitWith{true};if((speed player)>=3) exitWith{["You have failed to start the drill","basic"]spawn life_fnc_handleMessage;false};if!(isNull objectParent player) exitWith{["You have failed to start the drill","basic"]spawn life_fnc_handleMessage;false};if(!life_action_in_use||!alive player) exitWith{["You have failed to start the drill","basic"]spawn life_fnc_handleMessage;false};false;};["",0,"switchMove",player]spawn life_fnc_handleAnim;life_action_in_use=false;5 cutText["","PLAIN"];if!(_isSuccess) exitWith{};uiSleep(random 2);uiSleep(random 1);if(SRV_jewelryEmporiumSRV param[1,false]) exitWith{["The Jewelry Emporium is already being drilled!"]spawn life_fnc_handleMessage};["jewelrydrilled",1]call life_fnc_statArrUpdate;[["robberyStarted",[player]],"TON_fnc_jewelryEmporiumSRV",2]spawn life_fnc_MP;};case("weldSafe"):{_jewelryData params[["_safeObj",objNull,[objNull]]];if(life_inv_jewelLaser<=0) exitWith{[2,"You need a Plasma Cutter to open this safe."]call life_fnc_broadcast};if(_safeObj isNotEqualTo life_jewerlySafe) exitWith{};if!(SRV_jewelryEmporiumSRV param[3,false]) exitWith{["You have yet to meet the requirments for torching the safe!"]spawn life_fnc_handleMessage};if(isNull(_safeObj getVariable["ga_jewelWelder",objNull])) then{_safeObj setVariable["ga_jewelWelder",player,true];};disableSerialization;5 cutRsc["life_progress","PLAIN"];private _display=uiNameSpace getVariable["life_progress",displayNull];private _progressBar=_display displayCtrl 38201;private _progressText=_display displayCtrl 38202;life_action_in_use=true;private _increment=1;private _totalTime=12;private _currentPoint=0;private _loopDelay=_totalTime/floor(100/_increment);private _text=format["Starting Plasma Cutter On Safe Door"];private _startCount=0;_progressBar progressSetPosition _startCount;_progressText ctrlSetText format["%1 (%2%3)",_text,_startCount,"%"];player playMoveNow"Acts_carFixingWheel";private _isSuccess=for"_i"from 0 to 1 step 0 do{uiSleep _loopDelay;if(isNull _progressBar) exitWith{["You have failed to start the plasma cutter","basic"]spawn life_fnc_handleMessage;false};_currentPoint=(progressPosition _progressBar)+(_increment/100);_progressBar progressSetPosition _currentPoint;_progressText ctrlSetText format["%1 (%2%3)",_text,round(_currentPoint*100),"%"];if(_currentPoint>=1) exitWith{true};if((speed player)>=3) exitWith{["You have failed to start the plasma cutter","basic"]spawn life_fnc_handleMessage;false};if!(isNull objectParent player) exitWith{["You have failed to start the plasma cutter","basic"]spawn life_fnc_handleMessage;false};if(!life_action_in_use||!alive player) exitWith{["You have failed to start the plasma cutter","basic"]spawn life_fnc_handleMessage;false};false;};player switchMove"";