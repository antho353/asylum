if!(params["_target","_caller","_actionID",["_parameters","",["",[]]]]) exitWith{};private _type=if!(_parameters isEqualType[]) then{_parameters}else{_parameters select 0};private _bloodMoneyShop=if!(_parameters isEqualType[]) then{false}else{_parameters select 1};if((player distance _target)>7) exitWith{["You are too far away","basic"]spawn life_fnc_handleMessage;};if!((vehicle player) isEqualTo player) exitWith{["This action cannot be performed from within a vehicle","basic"]spawn life_fnc_handleMessage;};if(lineIntersects[eyePos player,aimPos _target,player,_target]) exitWith{["It would be hard to buy things through the wall, don't you think?","basic"]spawn life_fnc_handleMessage;};if(player getVariable["ga_restrained",false]) exitWith{};if(player getVariable["ga_surrendered",false]) exitWith{};if((_type in["civ","dive","rebcloth","kart","skip"])&&!(playerSide isEqualTo civilian)&&!(life_coprole in["all","detective"])) exitWith{["You need to be a civilian to use this store!","basic"]spawn life_fnc_handleMessage;};if((_type in["cop","copdive"])&&!(playerSide isEqualTo west)) exitWith{["You need to be a cop to use this store!","basic"]spawn life_fnc_handleMessage;};if((_type in["med"])&&!(playerSide isEqualTo independent)) exitWith{["You need to be a medic to use this store!","basic"]spawn life_fnc_handleMessage;};if((_type in["kart"])&&!(69 in life_side_talents)) exitWith{["You're simply not talented enough to wear these epic clothes","basic"]spawn life_fnc_handleMessage;};if((_type in["skip"])&&!(8 in life_side_talents)) exitWith{["You must be a Master Bounty Hunter to shop here!","basic"]spawn life_fnc_handleMessage;};if(life_eviSpawn) exitWith{};if(player getVariable["ga_surrendered",false]) exitWith{["Put your hands down!","basic"]spawn life_fnc_handleMessage;};if((_type isEqualTo"rebcloth")&&!(license_civ_rebel)&&!(_target getVariable["ga_turfCloth",false])) exitWith{["You don't have a rebel license to buy from this shop.","basic"]spawn life_fnc_handleMessage;};if((_type isEqualTo"skip")&&!(license_civ_bounty)) exitWith{["You don't have a bounty hunter license to buy from this shop.","basic"]spawn life_fnc_handleMessage;};private _oldFace=face player;private _oldGlasses=goggles player;private _oldHeadgear=headgear player;private _findSimpleItems={if!(params[["_itemList",[]]]) exitWith{[]};private _returnList=[];{if!(_x in(magazines player)) then{_returnList pushBack _x}}forEach _itemList;_returnList};private _oldUniform=uniform player;private _oldUniformItems=[uniformItems player]call _findSimpleItems;private _oldVest=vest player;private _oldVestItems=[vestItems player]call _findSimpleItems;private _oldBackpack=backpack player;private _oldBackpackItems=[backpackItems player]call _findSimpleItems;private _oldMagazines=magazinesAmmo player;private _oldTexture=player getVariable["ga_customTexture",[]];life_dead_gear=[player]call life_fnc_fetchDeadGear;["Life_Clothing"]call life_fnc_createDialog;disableSerialization;life_clothing_store=_type;life_clothesPurchased=nil;life_clothing_purchase=[0,0,0,0,0];life_shop_cam=if(isNull life_shop_cam) then{"camera"camCreate(getPosATL player)}else{life_shop_cam};waitUntil{!isNull life_shop_cam};private _distance=4;while{_distance>1}do{if(!lineIntersects[ATLToASL(player modelToWorld[1,_distance,2]),ATLToASL(player modelToWorld[0,0,1]),player]) exitWith{};_distance=_distance-0.5;};life_shop_cam camSetTarget(player modelToWorld[0,0,1]);