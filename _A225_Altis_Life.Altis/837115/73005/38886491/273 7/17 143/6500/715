#include"..\..\..\..\..\..\macro.h"
if(scriptAvailable(3)) exitWith{["You cannot metal detect so fast!","basic"]spawn life_fnc_handleMessage;};private _resourceZones=["mine_1","mine_2","mine_3","mine_4","mine_5","mine_6"];private _nearbyZones=_resourceZones select{player distance(getMarkerPos _x)<=150};private _zone=_nearbyZones param[(_nearbyZones apply{player distance(getMarkerPos _x)}) findIf{_x isEqualTo(selectMin(_nearbyZones apply{player distance(getMarkerPos _x)}))},""];private _distance=70;if(life_action_in_use) exitWith{};if(isNil"life_action_gathering") then{life_action_gathering=false;};if(life_action_gathering) exitWith{};if(life_inv_metaldetector<1) exitWith{["You must have a metal detector in order to scan for metals.","basic"]spawn life_fnc_handleMessage;};if(_zone isEqualTo"") exitWith{};titleText[format["Starting Metal Detection..."],"PLAIN"];PlaySound"metalDetectScan";life_action_gathering=true;life_action_in_use=true;private _delay=if(52 in life_side_talents) then{8}else{10};private _random="";private _gathered=[];private _exit=false;private _randomID=round(random 500);profileNamespace setVariable["ga_metalDetectorID",_randomID];private _asy_player=player;private _asy_obj="Weapon_hgun_esd_01_antenna_02_F"createVehicleLocal[0,0,0];_asy_obj attachTo[_asy_player,[0,0,0.05],"righthand"];_asy_obj setVectorUp[1,0.5,0.5];private _itemTable=[["plateMetal"],7,["lockpick"],8,["rubber"],6,["doubloon"],16,["pearl"],8,["ruby"],7,["cocainep"],3,["uraniump"],3,["lsd_0"],4,["silverpiece"],10,["redgull"],1];private _yield=switch(true) do{case(_zone in["mine_2","mine_3","mine_4","mine_5",""]):{1};case(_zone in["mine_1","mine_6"]):{2};