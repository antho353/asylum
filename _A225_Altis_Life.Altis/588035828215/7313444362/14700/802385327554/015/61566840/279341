[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addWeapon _trunkItemSelected;}else{if(player canAdd _trunkItemSelected) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};};case(_itemClass isEqualTo"Headgear"):{if((headgear player) isEqualTo"") then{private _isNVG=false;if((!((hmd player) isEqualTo""))&&(_trunkItemSelected in _pilotHelms)) then{_isNVG=true;if(player canAdd _trunkItemSelected) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};if(_isNVG) exitWith{};_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addHeadgear _trunkItemSelected;}else{if(player canAdd _trunkItemSelected) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};};case(_itemClass isEqualTo"Glasses"):{if((goggles player) isEqualTo"") then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addGoggles _trunkItemSelected;}else{if(player canAdd _trunkItemSelected) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};};case(_itemClass isEqualTo"Vest"):{if((vest player) isEqualTo"") then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addVest _trunkItemSelected;}else{if(player canAdd _trunkItemSelected) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};};case(_itemClass isEqualTo"Backpack"):{if((backpack player) isEqualTo"") then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addBackpackGlobal _trunkItemSelected;}else{if(player canAdd _trunkItemSelected) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};};case(_itemClass isEqualTo"Uniform"):{if((uniform player) isEqualTo"") then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addUniform _trunkItemSelected;}else{if(player canAdd _trunkItemSelected) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};};case(_itemClass isEqualTo"NVGoggles"):{if((hmd player) isEqualTo"") then{private _isPilot=false;if((headgear player) in _pilotHelms) then{_isPilot=true;if(player canAdd _trunkItemSelected) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};if(_isPilot) exitWith{};_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addWeapon _trunkItemSelected;}else{if(player canAdd _trunkItemSelected) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};};default{private _magazineAdded=false;if!(primaryWeapon player isEqualTo"") then{private _weaponMagazines=getArray(configFile>>"cfgWeapons">>primaryWeapon player>>"Magazines");private _weaponItems=(primaryWeapon player) call BIS_fnc_compatibleItems;if((_trunkItemSelected in _weaponMagazines)&&(count(primaryWeaponMagazine player) isEqualTo 0)) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addPrimaryWeaponItem _trunkItemSelected;_magazineAdded=true;}else{private _canAttach=false;{if(_trunkItemSelected==_x) exitWith{_canAttach=true;};}forEach _weaponItems;if(_canAttach) then{switch(true) do{case((["optic_",_trunkItemSelected]call BIS_fnc_inString)&&(((primaryWeaponItems player) select 2) isEqualTo"")):{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addPrimaryWeaponItem _trunkItemSelected;_magazineAdded=true;};case((["acc_",_trunkItemSelected]call BIS_fnc_inString)&&(((primaryWeaponItems player) select 1) isEqualTo"")):{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addPrimaryWeaponItem _trunkItemSelected;_magazineAdded=true;};};};};};if!(secondaryWeapon player isEqualTo"") then{private _weaponMagazines=getArray(configFile>>"cfgWeapons">>secondaryWeapon player>>"Magazines");private _weaponItems=(secondaryWeapon player) call BIS_fnc_compatibleItems;if(((_trunkItemSelected in _weaponMagazines)&&(count(secondaryWeaponMagazine player) isEqualTo 0))) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addSecondaryWeaponItem _trunkItemSelected;_magazineAdded=true;}else{private _canAttach=false;{if(_trunkItemSelected==_x) exitWith{_canAttach=true;};}forEach _weaponItems;if(_canAttach) then{switch(true) do{case((["optic_",_trunkItemSelected]call BIS_fnc_inString)&&(((secondaryWeaponItems player) select 2) isEqualTo"")):{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addSecondaryWeaponItem _trunkItemSelected;_magazineAdded=true;};case((["acc_",_trunkItemSelected]call BIS_fnc_inString)&&(((secondaryWeaponItems player) select 1) isEqualTo"")):{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addSecondaryWeaponItem _trunkItemSelected;_magazineAdded=true;};};};};};if!(handgunWeapon player isEqualTo"") then{private _weaponMagazines=getArray(configFile>>"cfgWeapons">>handgunWeapon player>>"Magazines");private _weaponItems=(handgunWeapon player) call BIS_fnc_compatibleItems;if(((_trunkItemSelected in _weaponMagazines)&&(count(handgunMagazine player) isEqualTo 0))) then{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addhandgunItem _trunkItemSelected;_magazineAdded=true;}else{private _canAttach=false;{if(_trunkItemSelected==_x) exitWith{_canAttach=true;};}forEach _weaponItems;if(_canAttach) then{switch(true) do{case((["optic_",_trunkItemSelected]call BIS_fnc_inString)&&(((handGunItems player) select 2) isEqualTo"")):{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addhandgunItem _trunkItemSelected;_magazineAdded=true;};case((["acc_",_trunkItemSelected]call BIS_fnc_inString)&&(((handGunItems player) select 1) isEqualTo"")):{_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addhandgunItem _trunkItemSelected;_magazineAdded=true;};};};};};if!(_magazineAdded) then{if(player canAdd _trunkItemSelected) then{if("bipod"in _trunkItemSelected) exitWith{["You cannot use this item!","basic"]spawn life_fnc_handleMessage};private _preInv=+_inv;_inv=[_trunkItemSelected,_inv]call _fnc_adjustArray;if(_preInv isEqualTo _inv) exitWith{_exit=true};[life_trunk_vehicle,_inv]call _fnc_updatePhysicalTrunk;player addItem _trunkItemSelected;}else{["You don't have enough space to hold that item!","basic"]spawn life_fnc_handleMessage;_exit=true;};};};};};};[life_trunk_vehicle,life_is_virtual]call life_fnc_refreshInventory;};