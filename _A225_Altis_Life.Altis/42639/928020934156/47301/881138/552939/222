params[["_type","",[""]],["_asy_obj",objNull,[objNull]]];if!(playerSide isEqualTo civilian) exitWith{};private _asy_player=player;switch(_type) do{case"startEvent":{if(player getVariable["ga_downed",false]||player getVariable["ga_restrained",false]||((life_is_arrested select 0) isEqualTo 1)) exitWith{["You cannot join the admin event at this time.","basic"]spawn life_fnc_handleMessage;};if(life_adminEvent select 1) exitWith{["You cannot join the admin event in progress.","basic"]spawn life_fnc_handleMessage;};[[true,player],"TON_fnc_eventParticipants",2]spawn life_fnc_MP;life_inEvent=true;private _preEventLoadout=getUnitLoadout player;private _preEventSkins=life_uniformBackpack_skins;private _preEventPos=if(surfaceIsWater(getPosATL player)) then{getPosASL player}else{getPosATL player};private _asy_player=player;private _location=(["getLocationByID",(life_adminEvent select 3)]call life_fnc_eventCfg) select 2;if!(isNull objectParent player) then{moveOut player;};[_location,0,{life_adminEvent select 1||!(life_adminEvent select 0)},"Halloween Graveyard Shift Admin Event"]spawn life_fnc_uavCinematic;titleText["Welcome to the Asylum 2020 Halloween Graveyard Shift Admin Event<br/>To win, you must burn skeletal remains and be lucky enough to find a special secret!<br/>You must stay within this zone to participate<br/>May the best grave robber win!","PLAIN",-1,true,true];disableUserInput true;life_old_group=group player;[player]join grpNull;uiSleep 2;private _asy_pos=_location;while{_asy_pos isEqualTo _location}do{_asy_pos=[_location,1,75,1,0,0,0,[],_location]call BIS_fnc_findSafePos;};player setPos _asy_pos;player setDamage 0;private _eventLoadout=[[],[],[],["U_C_Uniform_Farmer_01_F",[]],["V_BandollierB_blk",[]],["B_Carryall_eaf_F",[]],"H_HeadBandage_bloody_F","G_Bandanna_beast",[],["ItemMap","","","ItemCompass","ItemWatch",""]];player setUnitLoadout _eventLoadout;uiSleep 2.5;waitUntil{life_adminEvent select 1};disableUserInput false;if(sunOrMoon<0.5) then{player action["nvGoggles",player];};private _task=player createSimpleTask["AE_GraveyardShift_Task"];_task setSimpleTaskDescription["","Graveyard Shift Event",""];_task setSimpleTaskDestination _location;_task setTaskState"Assigned";player setCurrentTask _task;_asy_player setVariable["ga_eventHallow_playerStats",[0,0]];private _eventShovel="Land_Shovel_F"createVehicleLocal[0,0,0];private _eventCampfire1="Land_Campfire_F"createVehicleLocal[0,0,0];private _eventCampfire2="Land_Campfire_F"createVehicleLocal[0,0,0];private _eventCampfire3="Land_Campfire_F"createVehicleLocal[0,0,0];private _eventCampfire4="Land_Campfire_F"createVehicleLocal[0,0,0];private _eventCampfire5="Land_Campfire_F"createVehicleLocal[0,0,0];private _eventCampfire6="Land_Campfire_F"createVehicleLocal[0,0,0];private _eventCampfire7="Land_Campfire_F"createVehicleLocal[0,0,0];private _eventCampfire8="Land_Campfire_F"createVehicleLocal[0,0,0];private _eventCampfire9="Land_Campfire_F"createVehicleLocal[0,0,0];private _eventCampfire10="Land_Campfire_F"createVehicleLocal[0,0,0];private _churchObject1="Land_OrthodoxChurch_03_F"createVehicleLocal[0,0,0];private _churchObject2="Land_Canal_Wall_Stairs_F"createVehicleLocal[0,0,0];{_x setPos[9610.1,15868.1,0.343491];_x setDir 119.399;_x allowDamage false;}forEach[_churchObject1];{_x setPos[9614.71,15879.7,1.5089];_x setDir 208.586;_x allowDamage false;}forEach[_churchObject2];_eventCampfire1 setPosATL[9604.13,15858,0.35];_eventCampfire2 setPosATL[9601.33,15858.8,0.35];_eventCampfire3 setPosATL[9599.1,15860.3,0.35];_eventCampfire4 setPosATL[9596.74,15862.1,0.35];_eventCampfire5 setPosATL[9599.22,15873.6,1];_eventCampfire6 setPosATL[9595.46,15867.4,0.35];_eventCampfire7 setPosATL[9609.13,15860.2,0.4];_eventCampfire8 setPosATL[9612.92,15866.6,0.9];_eventCampfire9 setPosATL[9606.32,15870.3,1];_eventCampfire10 setPosATL[9604.52,15867.1,0.7];_eventShovel attachTo[_asy_player,[0,0.15,-0.3],"righthand"];_eventShovel setVectorUp[0,1,0.5];{_x allowDamage false;}forEach[_eventShovel,_eventCampfire1,_eventCampfire2,_eventCampfire3,_eventCampfire4,_eventCampfire5,_eventCampfire6,_eventCampfire7,_eventCampfire8,_eventCampfire9,_eventCampfire10];_objLocations=[[9612.13,15853.8,7.62939e-006],[9614.02,15852.4,7.62939e-006],[9619.89,15851,7.62939e-006],[9617.12,15852.4,0],[9622.86,15849.1,0],[9625.07,15847.2,0],[9627.45,15846,0],[9630.44,15844.8,0],[9634.03,15842.3,0],[9636.67,15841.9,7.62939e-006],[9640.81,15840.4,0],[9663.45,15831.5,7.62939e-006],[9667.83,15829.2,0],[9638.1,15848.1,0],[9635.39,15848.1,0],[9633.75,15850.1,0],[9631.09,15851,0],[9628.13,15852.6,-7.62939e-006],[9625.77,15853.7,-7.62939e-006],[9623.43,15855.5,0],[9621.5,15857.7,0],[9624.08,15866,0],[9626.41,15863.4,0],[9628.95,15862.2,0],[9631.41,15860.2,0],[9637.56,15856.7,0],[9640.93,15855.3,0],[9643.55,15853.7,0],[9646.21,15851.6,0],[9639.36,15867.2,0],[9629.9,15881.6,0],[9632.34,15880.7,0],[9635.46,15880.2,0],[9639.01,15878.6,0],[9649.15,15863.2,0],[9651.99,15862.1,-7.62939e-006],[9654.89,15859.6,0],[9657.5,15858.2,0],[9659.9,15856.6,0],[9656.52,15871.1,0],[9659.7,15869.5,-7.62939e-006],[9661.84,15866.8,0],[9665.35,15867.8,7.62939e-006],[9668.1,15864.7,0],[9671.74,15864.5,0],[9674.38,15863.2,7.62939e-006],[9676.89,15862.2,0],[9681.1,15861.3,0],[9680.01,15849.7,0],[9679.94,15847.2,7.62939e-006],[9679.44,15844.9,7.62939e-006],[9662.52,15848.7,0],[9660.72,15846.8,-7.62939e-006],[9659.34,15844.7,-7.62939e-006],[9666.08,15841.2,0]];{private _xLocation=_x;_xEventObj="Land_ShellCrater_01_F"createVehicleLocal[0,0,0];{_x allowDamage false;_x enableSimulation false;_x setPosATL _xLocation;}forEach[_xEventObj];}forEach _objLocations;uiSleep 5;[format["<t color='#ff7b0e' align='center'><t size='1.25'>Halloween Graveyard Shift Event</t></t><br/><br/>A Graveyard Keeper has tasked with you unearthing remains of skeletons in their graves! Each grave will contain remains that need to burned at the church! Burning bones that aren't any special will still grant you valuable items!<br/><br/>You've been given a shovel in order to do your job as a grave robber!<br/><br/>In order to win this event you must find the bones one of the four horsemen, Death himself and burn them!"],"event"]spawn life_fnc_handleMessage;waitUntil{!(life_adminEvent select 0)||!(player distance(getMarkerPos"graveyardshift1")<300)};if(life_adminEvent select 0) then{if!(player distance(getMarkerPos"graveyardshift1")<300) then{["You have left the event area, so you were removed!","basic"]spawn life_fnc_handleMessage;};};uiSleep 10;[[false,player],"TON_fnc_eventParticipants",2]spawn life_fnc_MP;life_inEvent=false;{deleteVehicle _x}forEach(nearestObjects[_asy_pos,["Land_Grave_11_F","Land_HumanSkeleton_F","Sign_Arrow_F","Land_ShellCrater_01_F"],300]);{deleteVehicle _x;}forEach[_eventShovel,_eventCampfire1,_eventCampfire2,_eventCampfire3,_eventCampfire4,_eventCampfire5,_eventCampfire6,_eventCampfire7,_eventCampfire8,_eventCampfire9,_eventCampfire10,_churchObject1,_churchObject2];if(life_isDead) then{["You have 45 seconds to respawn, in order to keep your pre-event position and loadout!","basic"]spawn life_fnc_handleMessage;uiSleep 45;};player removeSimpleTask _task;player setUnitLoadout _preEventLoadout;life_uniformBackpack_skins=_preEventSkins;if(surfaceIsWater _preEventPos) then{player setPosASL _preEventPos}else{player setPosATL _preEventPos};_asy_player setDamage 0;[player]joinSilent life_old_group;[10]call life_fnc_ClupdatePartial;titleText["You have been given back your previous loadout","PLAIN"];[]spawn{uiSleep 0.5;[uniform player,"setUniform",""]call life_fnc_clothingTextures;[backpack player,"setBackpack",""]call life_fnc_clothingTextures;};};case"digGrave":{if!(life_adminEvent select 0) exitWith{["The Graveyard Shift Event has already ended and a winner was already chosen!","basic"]spawn life_fnc_handleMessage;};if(_asy_obj getVariable["ga_eventHallow_objGraveRobbed",false]) exitWith{["This grave has already been robbed! Try another grave!","basic"]spawn life_fnc_handleMessage;};if(_asy_player getVariable["ga_eventHallow_currentlyDiggingGrave",false]) exitWith{["You are currently already robbing a grave, don't try to get greedy!","basic"]spawn life_fnc_handleMessage;};if(_asy_player getVariable["ga_eventHallow_activeSkeletalRemains",false]) exitWith{["You are currently have bones in your backpack or active skeletal remains on the ground, burn those first to dig for more!","basic"]spawn life_fnc_handleMessage;};_asy_obj setVariable["ga_eventHallow_objGraveRobbed",true];_asy_player setVariable["ga_eventHallow_currentlyDiggingGrave",true];["You start to unearth the reamins of this tomb... Stay within 7 meters or else digging will fail!","basic"]spawn life_fnc_handleMessage;