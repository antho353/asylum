_civVehicle setVariable["ga_drugrunning",false,true];_civVehicle setVariable["ga_canSeize",true,true];[[player,_seizeValue],"TON_fnc_copSplit",2]spawn life_fnc_MP;[floor(_seizeValue/10)]spawn life_fnc_earnPrestige;[0,format["A drug plane was searched and $%1 worth of drugs / contraband has been taken into evidence.",[_seizeValue]call life_fnc_numberText]]remoteExec["life_fnc_broadcast",-2];_seizeValue=0;};if(_civVehicle getVariable["ga_supplyPlane",false]) then{_seizeValue=_seizeValue+10000;_civVehicle setVariable["ga_supplyPlane",false,true];_civVehicle setVariable["ga_canSeize",true,true];[[player,_seizeValue],"TON_fnc_copSplit",2]spawn life_fnc_MP;[floor(_seizeValue/10)]spawn life_fnc_earnPrestige;[0,format["The Supply Plane cargo container was searched and $%1 worth of drugs / contraband has been taken into evidence.",[_seizeValue]call life_fnc_numberText]]remoteExec["life_fnc_broadcast",-2];_seizeValue=0;};private _isSuccess=false;if((_seizeValue>0)||(count(_weapons+_magazines+_wepItems+_bpItems+_clothes)>0)) then{disableSerialization;5 cutRsc["life_progress","PLAIN"];private _display=uiNameSpace getVariable["life_progress",displayNull];private _progressBar=_display displayCtrl 38201;private _progressText=_display displayCtrl 38202;life_action_in_use=true;private _increment=1;private _totalTime=20;private _currentPoint=0;private _loopDelay=_totalTime/floor(100/_increment);private _text="Seizing Vehicle Inventory";private _startCount=0;_progressBar progressSetPosition _startCount;_progressText ctrlSetText format["%1 (%2%3)",_text,_startCount,"%"];private _duration=20;private _animation="AinvPknlMstpSnonWnonDnon_medic_1";[_animation,_duration]spawn life_fnc_handleAnim;_isSuccess=for"_i"from 0 to 1 step 0 do{uiSleep _loopDelay;if(isNull _progressBar) exitWith{[2,format["You failed to seize the %1 inventory.",_vehText]]call life_fnc_broadcast;false};_currentPoint=(progressPosition _progressBar)+(_increment/100);_progressBar progressSetPosition _currentPoint;_progressText ctrlSetText format["%1 (%2%3)",_text,round(_currentPoint*100),"%"];if(_currentPoint>=1) exitWith{true};if((speed player)>=2) exitWith{[2,format["You failed to seize the %1 inventory.",_vehText]]call life_fnc_broadcast;false};if!((vehicle player) isEqualTo player) exitWith{[2,format["You failed to seize the %1 inventory.",_vehText]]call life_fnc_broadcast;false};if(player getVariable["ga_downed",false]||player getVariable["ga_restrained",false]) exitWith{[2,format["You failed to seize the %1 inventory.",_vehText]]call life_fnc_broadcast;false};if((!life_action_in_use)||(!alive player)||((player distance _civVehicle)>=5)||(player distance _copVehicle>30)) exitWith{[2,format["You failed to seize the %1 inventory.",_vehText]]call life_fnc_broadcast;false};false;};life_action_in_use=false;[]spawn life_fnc_handleAnim;5 cutText["","PLAIN"];if(_isSuccess) then{{_copVehicle addItemCargoGlobal[_x,1];}forEach(_weapons+_magazines+_wepItems+_bpItems+_clothes);clearWeaponCargoGlobal _civVehicle;clearMagazineCargoGlobal _civVehicle;clearItemCargoGlobal _civVehicle;{clearWeaponCargoGlobal _x;clearMagazineCargoGlobal _x;clearItemCargoGlobal _x;}forEach everyBackpack _civVehicle;if(_seizeValue>0) then{_civVehicle setVariable["ga_vinv",[_newCivItems,_civWeight],true];_copVehicle setVariable["ga_vinv",[_newCopItems,_copWeight],true];private _rank=[west,player]call life_fnc_getRankString;[[0,format["A %1 was searched by %2%3 and $%4 worth of drugs / contraband were taken into police custody.",getText(configFile>>"CfgVehicles">>typeOf _civVehicle>>"displayName"),_rank,profileName,[_seizeValue]call life_fnc_numberText]],"life_fnc_broadcast",-2,false,false]spawn life_fnc_MP;[["-SEIZE-",player,(profileName),format["seized $%1 worth of drugs / contraband from a %2, POS: %3",[_seizeValue]call life_fnc_numberText,(getText(configFile>>"CfgVehicles">>(typeOf _civVehicle)>>"displayName")),(getPos _civVehicle)]],"TON_fnc_logIt",2,false,false]spawn life_fnc_MP;if(_seizeValue>=5000) then{_civVehicle setVariable["ga_canSeize",true,true];};};titleText[format["The illegal items from this %1 have been seized into the nearest police vehicle. The items can be placed into evidence from any Police HQ.",_vehText],"PLAIN"];};}else{[format["Nothing illegal to seize in this %1.",_vehText],"basic"]spawn life_fnc_handleMessage;};_civVehicle setVariable["ga_seizing",nil,true];