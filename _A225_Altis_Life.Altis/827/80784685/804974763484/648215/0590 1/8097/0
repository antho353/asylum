#include"..\..\..\..\..\..\macro.h"
#include"\a3\editor_f\Data\Scripts\dikCodes.h"
params["_ctrl","_code","_shift","_ctrlKey","_alt"];private _handled=false;if!(isNull findDisplay 7300) exitWith{false};if(_code in(actionKeys"NextAction")||_code in(actionKeys"PrevAction")) then{if!(life_show_actions) then{[]spawn life_fnc_enableActions;};};life_lastActiveInput=time+305;switch(_code) do{case 2:{if(playerSide isEqualTo independent&&((call life_adminLevel)<=2)) exitWith{};if(playerSide isEqualTo civilian&&((call life_adminLevel)<=2)&&(life_bounty_list isEqualTo[])&&(A_stats_crimes select 0)<0) exitWith{};if!(isNull(findDisplay 39500)) exitWith{};[]call life_fnc_wantedMenu;};case 7:{if(!_alt&&!_ctrlKey) then{[vehicle player]spawn life_fnc_activateNitro;};};case 9:{if(life_medicLastRequest isNotEqualTo[objNull,"",""]) then{if(((life_medicLastRequest param[0,objNull]) distance2D(getMarkerPos"respawn_west")<=1000)&&!(isNull(life_medicLastRequest param[1,objNull]))) then{[[(life_medicLastRequest param[1,objNull])]]spawn life_fnc_medicRespondMenu;}else{["The last player to send a medic request is no longer in need of assistance.","basic"]spawn life_fnc_handleMessage;};}else{if(playerSide isEqualTo civilian&&!(life_bounty_list isEqualTo[])) then{if(life_arrestingBounty) then{life_arrestingBounty=false};};};};case 10:{if(playerSide isEqualTo west&&!isNil"life_copEviReq") then{if(life_inCombat) exitWith{["You were recently near or in combat. Leave combat and try again.","basic"]spawn life_fnc_handleMessage;};if!(isNull objectParent player) exitWith{["Exit the vehicle first.","basic"]spawn life_fnc_handleMessage;};[]spawn life_fnc_redeployMenu;};if((playerSide isEqualTo independent)||(playerSide isEqualTo west&&(life_coprole in["medic","all"]))) then{[]spawn life_fnc_medicRespondMenu;};if(!isNil"life_adminEvent"&&!life_inEvent) then{if(life_adminEvent select 0&&playerSide isEqualTo civilian) then{if(life_adminEvent select 2 isEqualTo 1) then{[2]spawn life_fnc_eventGunGameClient;};if(life_adminEvent select 2 isEqualTo 2) then{[]spawn life_fnc_eventBRClient;};if(life_adminEvent select 2 isEqualTo 4) then{["startEvent"]spawn life_fnc_eventGraveyardClient;};};};};case 15:{if(playerSide isEqualTo west&&!_alt&&!_ctrlKey&&!dialog&&vehicle player!=player&&(driver(vehicle player))==player) then{private _veh=vehicle player;if(!(_veh getVariable["ga_side",""]isEqualTo"cop")) exitWith{};[]call life_fnc_p_openLightSwitchBox;_handled=true;}else{if(!_alt&&!_ctrlKey&&dialog&&!((findDisplay 96000) isEqualTo displayNull)) then{closeDialog 0;_handled=true;};if(!_alt&&!_ctrlKey&&!_shift&&!dialog&&!life_isDowned) then{if(player getVariable["ga_surrendered",false]) then{player setVariable["ga_surrendered",false,true];}else{[]spawn life_fnc_surrender;};_handled=true;};};};case 22:{if(!_alt&&!_ctrlKey) then{private _veh=if(vehicle player isEqualTo player) then{cursorObject}else{vehicle player;};if(player getVariable["ga_restrained",false]||player getVariable["ga_downed",false]) exitWith{["How could you possibly reach your keys right now?","basic"]spawn life_fnc_handleMessage};if!(_veh isKindOf"House_F") exitWith{private _locked=locked _veh;private _owners=_veh getVariable["ga_vehOwners",[]];private _ownsVehicle=!(_owners findIf{getPlayerUID player in _x}isEqualTo-1);if((_ownsVehicle||_veh in life_vehicles)&&player distance _veh<10) then{if(_locked isEqualTo 2) then{_veh lock 0;if!(local _veh) then{[[_veh,0],"life_fnc_lockVehicle",_veh]spawn life_fnc_MP};PlaySound"unlock";systemChat"You have unlocked your vehicle.";}else{_veh lock 2;if!(local _veh) then{[[_veh,2],"life_fnc_lockVehicle",_veh]spawn life_fnc_MP};PlaySound"car_lock";systemChat"You have locked your vehicle.";};[_veh]call life_fnc_slingAndMass;};};if(_veh isKindOf"House_F") exitWith{private _door=[_veh]call life_fnc_nearestDoor;if(_door isEqualTo 0) exitWith{["You are not near a door.","basic"]spawn life_fnc_handleMessage;};private _locked=_veh getVariable[format["bis_disabled_Door_%1",_door],0];if((_veh in life_vehicles||_veh in life_gangBuilding||([_veh,getPlayerUID player,"accessLock"]call life_fnc_keyHolderStatus))&&playerSide isEqualTo civilian) then{(_veh getVariable["ga_house_electric",[false,0]]) params[["_electricNeedToPay",false,[false]],["_electricPriceToPay",0,[0]]];if(_electricNeedToPay) exitWith{[format["You are locked out of this house, until further notice! You need the house owner to pay the electric bill of $%1, to get access to the keys again!",[_electricPriceToPay]call life_fnc_numberText]]spawn life_fnc_handleMessage };if(_locked isEqualTo 0) then{_veh setVariable[format["bis_disabled_Door_%1",_door],1,true];_veh animate[format["door_%1_rot",_door],0];systemChat"Door locked.";}else{_veh setVariable[format["bis_disabled_Door_%1",_door],0,true];_veh animate[format["door_%1_rot",_door],1];systemChat"Door unlocked.";};}else{if(_locked isEqualTo 0) then{if(_veh animationPhase format["door_%1_rot",_door]isEqualTo 1) then{_veh animate[format["door_%1_rot",_door],0];systemChat"Door closed.";}else{_veh animate[format["door_%1_rot",_door],1];systemChat"Door opened.";};}else{if((call life_copLevel)>=5||(call life_medicLevel)>=4) then{if(_veh animationPhase format["door_%1_rot",_door]isEqualTo 1) then{_veh animate[format["door_%1_rot",_door],0];systemChat"Door closed. (Player Home)";}else{_veh animate[format["door_%1_rot",_door],1];systemChat"Door opened. (Player Home)";};}else{titleText["This door is locked!","PLAIN"];};};};};};};case 33:{if!(playerSide in[west,independent]) exitWith{};if!(isNull(findDisplay 2400)) exitWith{};private _veh=vehicle player;if((player isEqualTo(driver vehicle player))&&!(isNull objectParent player)&&!(isNull _veh)) then{if(playerSide isEqualTo west&&!(_veh getVariable["ga_side",""]isEqualTo"cop")) exitWith{};if(playerSide isEqualTo independent&&!(_veh getVariable["ga_side",""]isEqualTo"med")) exitWith{};if(_veh getVariable["ga_siren",false]) then{titleText["Sirens Off","PLAIN",0.1];_veh setVariable["ga_siren",false,true];if!(isNull life_siren_obj) then{deleteVehicle life_siren_obj;};}else{titleText["Sirens On","PLAIN",0.1];_veh setVariable["ga_siren",true,true];if!(isNull life_siren_obj) then{deleteVehicle life_siren_obj};life_siren_obj=createVehicle["Land_ClutterCutter_small_F",[0,0,0],[],0,"CAN_COLLIDE"];