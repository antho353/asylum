private["_textMessage","_textHeader","_textOK","_textCancel","_parent","_useParentBox","_isPause","_display","_ctrlRscMessageBox","_ctrlBcgCommonTop","_ctrlBcgCommon","_ctrlText","_ctrlBackgroundButtonOK","_ctrlBackgroundButtonMiddle","_ctrlBackgroundButtonCancel","_ctrlButtonOK","_ctrlButtonCancel","_allControls","_positions","_ctrlButtonOKPos","_ctrlBcgCommonPos","_bottomSpaceY","_marginX","_marginY","_ctrlTextPosH","_bottomPosY","_ctrlRscMessageBoxPos","_ctrlRscMessageBoxPosH","_focus","_ehKeyDown","_status"];
#define DISPLAY_DEFAULT (uinamespace getvariable"RscDisplayCommonMessage_display")
disableserialization;_textMessage=_this param[0,"",["",parsetext"",[]]];_textHeader=_this param[1,"",[""]];_textOK=_this param[2,true,["",false]];_textCancel=_this param[3,false,["",false]];_parent=_this param[4,[]call bis_fnc_displayMission,[displaynull]];_useParentBox=_this param[5,false,[false]];_isPause=_this param[6,true,[false]];_canDelete=false;if!(_useParentBox) then{_displayClass=if(_isPause) then{"RscDisplayCommonMessagePause"}else{"RscDisplayCommonMessage"};_parent createdisplay _displayClass;};if(!_useParentBox&&isnil{DISPLAY_DEFAULT}) exitwith{["Unable to create message box"]call bis_fnc_error;false};if(!_useParentBox&&isnull(DISPLAY_DEFAULT)) exitwith{["Unable to create message box."]call bis_fnc_error;false};if(_useParentBox&&isnull(_parent)) exitwith{["Parent display does not exist."]call bis_fnc_error;false};if(_useParentBox&&isnull(_parent displayctrl 2351)) then{_parent ctrlcreate["RscMessageBox",2351];_canDelete=true;};if(typename _textMessage==typename"") then{_textMessage=parsetext _textMessage;};_display=if(_useParentBox) then{_parent}else{DISPLAY_DEFAULT;};_ctrlRscMessageBox=_display displayctrl 2351;_ctrlBcgCommonTop=_display displayctrl 235100;_ctrlBcgCommon=_display displayctrl 235101;_ctrlText=_display displayctrl 235102;_ctrlBackgroundButtonOK=_display displayctrl 235103;_ctrlBackgroundButtonMiddle=_display displayctrl 235104;_ctrlBackgroundButtonCancel=_display displayctrl 235105;_ctrlButtonOK=_display displayctrl 235106;_ctrlButtonCancel=_display displayctrl 235107;_allControls=[_ctrlBcgCommonTop,_ctrlBcgCommon,_ctrlText,_ctrlBackgroundButtonOK,_ctrlBackgroundButtonMiddle,_ctrlBackgroundButtonCancel,_ctrlButtonOK,_ctrlButtonCancel];if(_useParentBox) then{_positions=uinamespace getvariable"BIS_fnc_guiMessage_defaultPositions";if(isnil"_positions") then{_positions=[];{_xPos=ctrlposition _x;_positions set[count _positions,_xPos];}foreach _allControls;uinamespace setvariable["BIS_fnc_guiMessage_defaultPositions",_positions];_display displayaddeventhandler["unload","uinamespace setvariable ['BIS_fnc_guiMessage_defaultPositions',nil];"];}else{{_x ctrlsetposition(_positions select _foreachindex);_x ctrlcommit 0;}foreach _allControls;};};_ctrlBcgCommonTop ctrlsettext _textHeader;_ctrlButtonOKPos=ctrlposition _ctrlButtonOK;_ctrlBcgCommonPos=ctrlposition _ctrlBcgCommon;_bottomSpaceY=(_ctrlButtonOKPos select 1)-((_ctrlBcgCommonPos select 1)+(_ctrlBcgCommonPos select 3));_ctrlTextPos=ctrlposition _ctrlText;_marginX=(_ctrlTextPos select 0)-(_ctrlBcgCommonPos select 0);