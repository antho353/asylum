};if(_length>20) exitWith{["The maximum character limit for a loadout name is 20.","basic"]spawn life_fnc_handleMessage;};private _badChar=false;{if(!(_x in _allowed)) exitWith{_badChar=true;};}forEach _chrByte;if(_badChar) exitWith{["Your loadout name contains unsupported characters!","basic"]spawn life_fnc_handleMessage;};private _inUse=life_loadoutHolder findIf{_loadoutName in _x};if!(_inUse isEqualTo-1) exitWith{["This loadout name is currently in use by another loadout of yours.","basic"]spawn life_fnc_handleMessage;};private _loadout=getUnitLoadout player;private _virtualInv=[_type]call life_fnc_getVirtualInv;private _loadoutPrice=[_type,_loadout,_virtualInv,true]call life_fnc_getLoadoutPrice;private _skins=[life_uniformBackpack_skins select 0,life_uniformBackpack_skins select 1];if(_loadoutPrice isEqualTo-1) exitWith{};if(life_carryWeight>90) exitWith{["The maximum virtual weight for a loadout is 90.","basic"]spawn life_fnc_handleMessage;};if(_indexValZero isEqualTo-4) then{private _uniqueID=round(serverTime);[[2,getPlayerUID player,_uniqueID,playerSide,_type,_loadoutName,_loadout,_virtualInv,_skins],"TON_fnc_handleLoadouts",2]call life_fnc_MP;life_loadoutHolder set[_indexValOne,[_uniqueID,_type,_loadoutName,_loadout,_virtualInv,_skins]];[format["You have successfully added the %1 loadout!",_loadoutName],"basic"]spawn life_fnc_handleMessage;};if(_indexValZero isEqualTo-3||(_indexValZero>=0&&_indexValZero<=5)) then{private _uniqueID=((life_loadoutHolder select _indexValZero) select 0);[[3,getPlayerUID player,_uniqueID,playerSide,_type,_loadoutName,_loadout,_virtualInv,_skins],"TON_fnc_handleLoadouts",2]call life_fnc_MP;life_loadoutHolder set[_indexValZero,[_uniqueID,_type,_loadoutName,_loadout,_virtualInv,_skins]];[format["You have successfully created the %1 loadout!",_loadoutName],"basic"]spawn life_fnc_handleMessage;};[["-LOADOUTSAVE-",player,(profileName),format["attempted to save loadout %1 at POS: %2 - %3 - %4",_loadoutName,getPos player,_loadout,_virtualInv]],"TON_fnc_logIt",2]spawn life_fnc_MP;closeDialog 0;waitUntil{!dialog};[nil,nil,nil,_type]spawn life_fnc_loadoutMenu;