params[["_veh",objNull,[objNull]],["_isVirtual",true,[true]]];if(isNull _veh||!alive _veh) exitWith{closeDialog 0;};if(!_isVirtual&&(_veh isKindOf"Car"||_veh isKindOf"Air"||_veh isKindOf"Ship")) exitWith{closeDialog 0;["Physical inventory via this method is not allowed on vehicles! Please use the Arma 3 inventory method.","basic"]spawn life_fnc_handleMessage;};if(isNil{(_veh getVariable["ga_vinv",[[],0]]) select 1}) exitWith{closeDialog 0;["The virtual inventory has corrupted. The inventory has been wiped and reset. This has been logged.","basic"]spawn life_fnc_handleMessage;[["-WIPEDVEH-",player,(profileName),format["had their vehicle wiped due to potential weight and item exploit. Old Inventory: %1",_veh getVariable["ga_vinv",[[],0]]]],"TON_fnc_logIt",2]spawn life_fnc_MP;_veh setVariable["ga_vinv",[[],0],true];};if(isNil{(_veh getVariable["ga_pinv",[[],0]]) select 1}) exitWith{closeDialog 0;["The physical inventory has corrupted. The inventory has been wiped and reset. This has been logged.","basic"]spawn life_fnc_handleMessage;[["-WIPEDVEH-",player,(profileName),format["had their house wiped due to potential weight and item exploits. Old Inventory: %1",_veh getVariable["ga_pinv",[[],0]]]],"TON_fnc_logIt",2]spawn life_fnc_MP;_veh setVariable["ga_pinv",[[],0],true];};disableSerialization;private _tInv=(findDisplay 4500) displayCtrl 4502;private _pInv=(findDisplay 4500) displayCtrl 4503;private _storeBtn=(findDisplay 4500) displayCtrl 4508;private _takeBtn=(findDisplay 4500) displayCtrl 4507;private _pEdit=(findDisplay 4500) displayCtrl 4506;private _tEdit=(findDisplay 4500) displayCtrl 4505;private _pDropBtn=(findDisplay 4500) displayCtrl 4522;private _tDropBtn=(findDisplay 4500) displayCtrl 4521;lbClear _tInv;lbClear _pInv;private _data=[[],0];_pDropBtn ctrlEnable!life_is_virtual;_tDropBtn ctrlEnable!life_is_virtual;if(_isVirtual) then{_data=_veh getVariable["ga_vinv",[[],0]];private _inventory=_data select 0;private _weight=_data select 1;ctrlSetText[4504,format["Weight: %1/%2",_weight,(_veh getVariable["ga_vcap",100])]];{_value=missionNameSpace getVariable _x;if(_value>0) then{_itemName=["getName",_x]call life_fnc_virtItemCfg;_itemShort=["getShortName",_x]call life_fnc_virtItemCfg;_itemPic=["getIcon",_itemShort]call life_fnc_virtItemCfg;_index=_pInv lbAdd(format["[%1] - %2",_value,_itemName]);_pInv lbSetData[_index,_itemShort];_pInv lbSetPicture[_index,_itemPic];};}forEach([1]call life_fnc_virtItemCfg);{_x params["_varName","_value"];if(_value>0) then{_itemName=["getName",_varName]call life_fnc_virtItemCfg;_index=_tInv lbAdd(format["[%1] - %2",_value,_itemName]);_tInv lbSetData[_index,_varName];_tInv lbSetPicture[_index,["getIcon",_varName]call life_fnc_virtItemCfg];};}forEach _inventory;}else{_pDropBtn ctrlEnable true;_tDropBtn ctrlEnable true;_data=_veh getVariable["ga_pinv",[[],0]];private _inventory=_data select 0;private _weight=_data select 1;ctrlSetText[4504,format["Weight: %1/%2",_weight,(_veh getVariable["ga_phys_cap",100])]];private _pCache=[];private _index=-1;private _tempItem="";private _headgear=headgear player;if!(_headgear IsEqualTo"") then{_index=-1;{if!(_index isEqualTo-1) exitWith{};if(_headgear isEqualTo(_x select 0)) exitWith{_index=_forEachIndex;};}forEach _pCache;if(_index isEqualTo-1) then{_pCache pushBack[_headgear,1];}else{_pCache set[_index,[_headgear,((_pCache select _index) select 1)+1]];};};private _goggles=goggles player;if!(_goggles IsEqualTo"") then{_index=-1;{if!(_index isEqualTo-1) exitWith{};if(_goggles isEqualTo(_x select 0)) exitWith{_index=_forEachIndex;};}forEach _pCache;if(_index isEqualTo-1) then{_pCache pushBack[_goggles,1];}else{_pCache set[_index,[_goggles,((_pCache select _index) select 1)+1]];};};private _uniform=uniform player;if!(_uniform IsEqualTo"") then{_index=-1;{if!(_index isEqualTo-1) exitWith{};if(_uniform isEqualTo(_x select 0)) exitWith{_index=_forEachIndex;};}forEach _pCache;if(_index isEqualTo-1) then{_pCache pushBack[_uniform,1];}else{_pCache set[_index,[_uniform,((_pCache select _index) select 1)+1]];};};private _vest=vest player;if!(_vest IsEqualTo"") then{_index=-1;{if!(_index isEqualTo-1) exitWith{};if(_vest isEqualTo(_x select 0)) exitWith{_index=_forEachIndex;};}forEach _pCache;if(_index isEqualTo-1) then{_pCache pushBack[_vest,1];}else{_pCache set[_index,[_vest,((_pCache select _index) select 1)+1]];};};private _bag=backpack player;if(count(backpackItems player)>0) then{{_tempItem=_x;_index=-1;{if!(_index isEqualTo-1) exitWith{};if(_tempItem isEqualTo(_x select 0)) exitWith{_index=_forEachIndex;};}forEach _pCache;if(_index isEqualTo-1) then{_pCache pushBack[_tempItem,1];}else{_pCache set[_index,[_tempItem,((_pCache select _index) select 1)+1]];};}forEach(backpackItems player);};if!(_bag IsEqualTo"") then{_index=-1;{if!(_index isEqualTo-1) exitWith{};if(_bag isEqualTo(_x select 0)) exitWith{_index=_forEachIndex;