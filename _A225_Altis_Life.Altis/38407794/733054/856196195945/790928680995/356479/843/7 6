params["_target","_caller","_actionId","_arguments"];if(playerSide isEqualTo west&&(SRV_evidence_status select 0)) then{if!(SRV_evidence_status select 0) exitWith{};if((SRV_evidence_status select 2)>serverTime-120) exitWith{[format["The generator is too hot to fix! Try again in %1 minute(s).",ceil((((SRV_evidence_status select 2)+300)-serverTime)/60)],"basic"]spawn life_fnc_handleMessage;};private _rebelsInPoly=allPlayers select{_x distance(getMarkerPos"armory_marker")<=100&&side _x isEqualTo civilian&&alive _x&&!(_x getVariable["ga_restrained",false])};if!(_rebelsInPoly isEqualTo[]) exitWith{["Secure the inside from the rebels first!","basic"]spawn life_fnc_handleMessage;};disableSerialization;5 cutRsc["life_progress","PLAIN"];private _display=uiNameSpace getVariable["life_progress",displayNull];private _progressBar=_display displayCtrl 38201;private _progressText=_display displayCtrl 38202;life_action_in_use=true;private _increment=1;private _totalTime=120;private _currentPoint=0;private _loopDelay=_totalTime/floor(100/_increment);private _text="Restoring Evidence Lockup Security";private _startCount=0;_progressBar progressSetPosition _startCount;_progressText ctrlSetText format["%1 (%2%3)",_text,_startCount,"%"];private _duration=20;private _animation="AinvPknlMstpSnonWnonDnon_medic_1";[_animation,_duration]spawn life_fnc_handleAnim;private _isSuccess=for"_i"from 0 to 1 step 0 do{uiSleep _loopDelay;if(isNull _progressBar) exitWith{["You have failed to restore security.","basic"]spawn life_fnc_handleMessage;false};_currentPoint=(progressPosition _progressBar)+(_increment/100);_progressBar progressSetPosition _currentPoint;_progressText ctrlSetText format["%1 (%2%3)",_text,round(_currentPoint*100),"%"];if(_currentPoint>=1) exitWith{true};if((speed player)>=2) exitWith{["You have failed to restore security.","basic"]spawn life_fnc_handleMessage;false};if!(isNull objectParent player) exitWith{["You have failed to restore security.","basic"]spawn life_fnc_handleMessage;false};if(!life_action_in_use||!alive player) exitWith{["You have failed to restore security.","basic"]spawn life_fnc_handleMessage;false};false;};life_action_in_use=false;[]spawn life_fnc_handleAnim;5 cutText["","PLAIN"];if(_isSuccess) then{[[objNull,_caller,4262,0],"TON_fnc_evidenceRobbery",2,false,false]spawn life_fnc_MP;};}else{if(true) exitWith{["This content is temporarily disabled and under development.","basic"]spawn life_fnc_handleMessage;};if(life_action_in_use) exitWith{};if!(playerSide isEqualTo civilian) exitWith{["You must be a civilian!","basic"]spawn life_fnc_handleMessage;};if((primaryWeapon player) isEqualTo"") exitWith{["You'll need a bigger gun to pull this off...","basic"]spawn life_fnc_handleMessage;