if(isNull _handlingComboBox) exitWith{};disableSerialization;private _asy_display=ctrlParent _handlingComboBox;if(isNull _asy_display) exitWith{};private _costText=_asy_display displayCtrl 100162;if!((_handlingComboBox lbValue _selectedIndex) isEqualTo(life_modShopMods select 2)) then{private _cost=switch(_handlingComboBox lbValue _selectedIndex) do{case 0:{0};case 1:{3500};case 2:{7500};default{1500};};life_modShopCosts set[2,_cost];}else{life_modShopCosts set[2,0];};life_modShopChanges set[2,_handlingComboBox lbValue _selectedIndex];private _saveButton=_asy_display displayCtrl 100160;private _licensePlate=ctrlText(_asy_display displayCtrl 100157);if([_licensePlate]call life_fnc_checkPlate) then{life_modShopCosts set[4,2500];_saveButton ctrlEnable true;}else{life_modShopCosts set[4,0];_saveButton ctrlEnable false;};if(_licensePlate isEqualTo"") then{life_modShopCosts set[4,0];_saveButton ctrlEnable true;};life_modShopChanges set[5,_licensePlate];private _total=0;{_total=_total+_x}forEach life_modShopCosts;_costText ctrlSetText format["$%1",[_total]call life_fnc_numberText];}];{_alarmCombo lbAdd(_x select 0);_alarmCombo lbSetValue[_forEachIndex,(_x select 1)];}forEach[["No Alarm System",0],["Alarm System - $500",1]];_alarmCombo ctrlAddEventHandler["LBSelChanged",{params[["_alarmComboBox",controlNull],["_selectedIndex",-1]];if(isNull _alarmComboBox) exitWith{};disableSerialization;private _asy_display=ctrlParent _alarmComboBox;if(isNull _asy_display) exitWith{};private _costText=_asy_display displayCtrl 100162;if!((_alarmComboBox lbValue _selectedIndex) isEqualTo(life_modShopMods select 0)) then{private _cost=switch(_alarmComboBox lbValue _selectedIndex) do{case 0:{0};case 1:{500};default{250};};life_modShopCosts set[0,_cost];}else{life_modShopCosts set[0,0];};life_modShopChanges set[0,_alarmComboBox lbValue _selectedIndex];private _saveButton=_asy_display displayCtrl 100160;private _licensePlate=ctrlText(_asy_display displayCtrl 100157);if([_licensePlate]call life_fnc_checkPlate) then{life_modShopCosts set[4,2500];_saveButton ctrlEnable true;}else{life_modShopCosts set[4,0];_saveButton ctrlEnable false;};if(_licensePlate isEqualTo"") then{life_modShopCosts set[4,0];_saveButton ctrlEnable true;};life_modShopChanges set[5,_licensePlate];private _total=0;{_total=_total+_x}forEach life_modShopCosts;_costText ctrlSetText format["$%1",[_total]call life_fnc_numberText];}];private _sideFlag=switch(playerSide) do{case west:{"cop"};case independent:{"med"};case civilian:{"civ"};};private _availTextures=[];_availTextures=["modTextures",_classname,_sideFlag]call life_fnc_vehicleTextures;{_skinCombo lbAdd(_x select 1);_skinCombo lbSetValue[_forEachIndex,(_x select 0)];}forEach _availTextures;_skinCombo ctrlAddEventHandler["LBSelChanged",{params[["_skinComboBox",controlNull],["_selectedIndex",-1]];if(isNull _skinComboBox) exitWith{};disableSerialization;private _asy_display=ctrlParent _skinComboBox;if(isNull _asy_display) exitWith{};private _costText=_asy_display displayCtrl 100162;if!((_skinComboBox lbValue _selectedIndex) isEqualTo(life_modShopMods select 5)) then{life_modShopCosts set[5,2500];}else{life_modShopCosts set[5,0];};life_modShopChanges set[4,_skinComboBox lbValue _selectedIndex];private _saveButton=_asy_display displayCtrl 100160;private _licensePlate=ctrlText(_asy_display displayCtrl 100157);if([_licensePlate]call life_fnc_checkPlate) then{life_modShopCosts set[4,2500];_saveButton ctrlEnable true;}else{life_modShopCosts set[4,0];_saveButton ctrlEnable false;};if(_licensePlate isEqualTo"") then{life_modShopCosts set[4,0];_saveButton ctrlEnable true;};life_modShopChanges set[5,_licensePlate];private _total=0;{_total=_total+_x}forEach life_modShopCosts;_costText ctrlSetText format["$%1",[_total]call life_fnc_numberText];}];private _vehName=([_classname]call life_fnc_fetchVehInfo) select 3;private _customPlate=if!(_classname isKindOf"Car") then{_plate}else{if(_customPlate isEqualTo"") then{"No Custom Plate"}else{_customPlate}};private _curAlarm=switch(_vehAlarm) do{case 0:{"No Alarm System"};case 1:{"Basic Alarm"};default{"Code Error !!!"};};private _curTrunk=switch(_trunkMod) do{case 0:{"Base Storage"};case 50:{"+50 Storage"};case 75:{"+75 Storage"};case 100:{"+100 Storage"};default{"Code Error !!!"};};private _curHandling=switch(_handlingMod) do{case 0:{"Stock Handling"};case 1:{"Suspension Mod"};case 2:{"Brakes and Suspension"};default{"Code Error !!!"};};private _curHorn=(_availableHorns param[_availableHorns findIf{(_x select 0) isEqualTo _hornMod},"Stock Horn"]) param[1,"Stock Horn"];if!(_classname isKindOf"Car") then{_licenseText ctrlShow false;_licensePlate ctrlShow false;private _idx=_handlingCombo lbAdd"Unmodifiable";_handlingCombo lbSetCurSel _idx;_idx=_hornCombo lbAdd"Unmodifiable";_hornCombo lbSetCurSel _idx;_skinCombo ctrlEnable true;_trunkCombo ctrlEnable true;_trunkCombo lbSetCurSel _trunkMod;}else{_hornCombo ctrlEnable true;_licensePlate ctrlEnable true;_handlingCombo ctrlEnable true;_skinCombo ctrlEnable true;_trunkCombo ctrlEnable true;};_alarmCombo ctrlEnable true;if(playerSide isEqualTo independent) then{_skinCombo ctrlEnable false;_trunkCombo ctrlEnable false;};private _currentSkin=["colorname",_classname,_color]call life_fnc_vehicleTextures;_currentMods ctrlSetStructuredText parseText format["<t align='center'>%1</t><br/><br/><t size='0.85'>Storage: %2<br/>Paint: %3<br/>Horn: %4<br/>Handling: %5<br/>Alarm: %6<br/>Plate Text: %7</t>",_vehName,_curTrunk,if(_currentSkin isEqualTo"") then{"Default"}else{_currentSkin},_curHorn,_curHandling,_curAlarm,if(_customPlate isEqualTo"") then{"No Cu"}else{_customPlate}];_saveButton buttonSetAction"[] call life_fnc_garageBuyMods;";