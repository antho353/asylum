life_shop_cam camSetPos(player modelToWorld[1,_distance,2]);life_shop_cam camSetFOV 0.33;life_shop_cam camSetFocus[50,0];life_shop_cam camCommit 0;showCinemaBorder false;life_shop_cam cameraEffect["internal","back"];private _display=findDisplay 3100;if(isNull _display) exitWith{};if(_bloodMoneyShop) then{life_bloodMoneyShop=true};private _preBloodMoney=life_bloodMoney;private _list=_display displayCtrl 3101;private _filter=_display displayCtrl 3102;private _total=_display displayCtrl 3106;private _price=_display displayCtrl 3107;private _cancel=_display displayCtrl 1000;private _purchase=_display displayCtrl 1001;_purchase ctrlEnable false;{lbClear _x}forEach[_filter,_list];{_x ctrlSetText"$0"}forEach[_total,_price];if!(_type isEqualTo"faces") then{for"_selection"from 0 to 4 do{private _clothesFound=switch(_type) do{case"civ":{[_selection]call life_fnc_clothing_civ};case"cop":{[_selection]call life_fnc_clothing_cop};case"skip":{[_selection]call life_fnc_clothing_reb};case"rebcloth":{[_selection]call life_fnc_clothing_reb};case"dive":{[_selection]call life_fnc_clothing_dive};case"copdive":{[_selection]call life_fnc_clothing_copdive};case"kart":{[_selection]call life_fnc_clothing_kart};case"med":{[_selection]call life_fnc_clothing_med};};if!(_clothesFound isEqualTo[]) then{private _index=switch(_selection) do{case 0:{_filter lbAdd"Uniforms"};case 1:{_filter lbAdd"Headgear"};case 2:{_filter lbAdd"Glasses"};case 3:{_filter lbAdd"Vests"};case 4:{_filter lbAdd"Backpacks"};};_filter lbSetValue[_index,_selection];};};}else{_filter lbAdd"Faces";};private _oldLoadout=[_oldUniform,_oldHeadgear,_oldGlasses,_oldVest,_oldBackpack];_purchase ctrlSetEventHandler["ButtonClick",format["[%1] call life_fnc_buyClothes",[_type,_oldUniform,_oldHeadgear,_oldGlasses,_oldVest,_oldBackpack]]];_list ctrlSetEventHandler["LBSelChanged",format["[_this, '%1', %2] call life_fnc_changeClothes",_type,_oldLoadout]];_filter ctrlSetEventHandler["LBSelChanged",format["[_this, '%1', %2] call life_fnc_clothingFilter",_type,_oldLoadout]];_filter lbSetCurSel 0;waitUntil{isNull _display};[6]call life_fnc_ClupdatePartial;if(life_bloodMoneyShop) then{life_bloodMoneyShop=false;if!(life_bloodMoney isEqualTo _preBloodMoney) then{[18]call life_fnc_ClupdatePartial;};};life_shop_cam cameraEffect["terminate","back"];camDestroy life_shop_cam;life_clothing_store="";if(isNil"life_clothesPurchased") exitWith{if(_type isEqualTo"faces") exitWith{player setFace _oldFace};if!(_oldUniform isEqualTo"") then{player forceAddUniform _oldUniform}else{removeUniform player};if!(_oldHeadgear isEqualTo"") then{player addHeadgear _oldHeadgear}else{removeHeadgear player};if!(_oldGlasses isEqualTo"") then{player addGoggles _oldGlasses}else{removeGoggles player};if!((backpack player) isEqualTo"") then{if(_oldBackpack isEqualTo"") then{removeBackpack player}else{removeBackpack player;player addBackpack _oldBackpack;clearAllItemsFromBackpack player;if((count _oldBackpackItems)>0) then{{[_x,true,true]call life_fnc_handleItem}forEach _oldBackpackItems};};};if(((count _oldUniformItems)>=1)&&!((uniform player) isEqualTo"")) then{{[_x,true,false,false,true]call life_fnc_handleItem}forEach _oldUniformItems};if!((vest player) isEqualTo"") then{if(_oldVest isEqualTo"") then{removeVest player}else{removeVest player;player addVest _oldVest;if((count _oldVestItems)>0) then{{[_x,true,false,false,true]call life_fnc_handleItem}forEach _oldVestItems};};};if((count _oldMagazines)>0) then{{player addMagazine _x}forEach _oldMagazines};[uniform player,"setUniform",""]call life_fnc_clothingTextures;[backpack player,"setBackpack",""]call life_fnc_clothingTextures;};