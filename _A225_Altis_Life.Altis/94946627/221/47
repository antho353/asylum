[format["Your %1 was repaired by %2%3 and a fee of $%4 was taken from your bank account.",getText(configFile>>"CfgVehicles">>typeOf _building>>"displayName"),[independent,_medic]call life_fnc_getRankString,name _medic,[_fee]call life_fnc_numberText],"basic"]spawn life_fnc_handleMessage;_building setVariable["ga_repairRequested",false,true];private _index=life_vehicles find _building;if!(_index isEqualTo-1) then{life_vehicles set[_index,-1];life_vehicles=life_vehicles-[-1];};_index=[str(getPosATL _building),life_houses]call life_fnc_index;if!(_index isEqualTo-1) then{life_houses set[_index,-1];life_houses=life_houses-[-1];};[[player,_building,_ruins],"TON_fnc_repairBuildingSRV",2]spawn life_fnc_MP;[["repairPayment",[_fee,profileName,getText(configFile>>"CfgVehicles">>typeOf _building>>"displayName")]],"life_fnc_medicRepairBuilding",_medic]spawn life_fnc_MP;[["-HOUSEREPAIR-",player,(profileName),format["House was repaired by AFD Medic: %1, House Type: %2, House ID: %3, Amount Paid to Medic: $%4, House Pos: %5",name _medic,typeOf _building,_building getVariable["ga_houseID",-1],[_fee]call life_fnc_numberText,getPos _building]],"TON_fnc_logIt",2,false,false]spawn life_fnc_MP;};case("houseRepaired"):{_repairHouseData params[["_newHouse",objNull,[objNull]],["_oldHouse",objNull,[objNull]]];life_vehicles pushBack _newHouse;life_houses pushBack[(str(getPosATL _newHouse)),[]];{if!((_x find"phouse_") isEqualTo-1) then{deleteMarker _x;};}forEach allMapMarkers;[]spawn life_fnc_CLinitHouses;};case("gangHouseRepaired"):{_repairHouseData params[["_newHouse",objNull,[objNull]],["_oldHouse",objNull,[objNull]]];if!((life_gang_data param[3,[0,0,0]]) isEqualTo[0,0,0]) then{if!(isNull _newHouse) then{waitUntil{uiSleep 1;!(isNil{_newHouse getVariable"ga_house_gang"})};private _gangID=_newHouse getVariable["ga_house_gang",-1];private _gangOwner=_newHouse getVariable["ga_homeOwner",""];private _houseTypes=["getHouses"]call life_fnc_houseConfig;if(_gangID isEqualTo-1||_gangOwner isEqualTo"") exitWith{};if!((typeOf _newHouse) in _houseTypes) exitWith{};life_gangBuilding=[_newHouse,getPosATL _newHouse];if(_gangOwner isEqualTo(getPlayerUID player)) exitWith{};life_vehicles deleteAt(life_vehicles find _oldHouse);life_houses deleteAt(life_houses find(str(getPosATL _oldHouse)));deleteMarkerLocal life_gangBldgMark;life_gangBldgMark="";private _marker=createMarkerLocal[format["phouse_%1%2",_gangID,_gangOwner],getPosATL _newHouse];_marker setMarkerTextLocal"Gang Building";_marker setMarkerColorLocal"ColorGreen";_marker setMarkerTypeLocal"mil_end";life_gangBldgMark=_marker;};};};};