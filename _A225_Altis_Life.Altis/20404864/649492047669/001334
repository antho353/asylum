_cP=_cP+0.01;_progress progressSetPosition _cP;_pgText ctrlSetText format["%3 (%1%2)...",round(_cP*100),"%",_text];if((_input in["crank","crankp"])&&(player distance _vehicle>10)) exitWith{};if(player distance _vendor>10) exitWith{};if!(life_action_in_use) exitWith{};if(_cp>=1) exitWith{_success=true;};};5 cutText["","PLAIN"];life_is_processing=false;life_action_in_use=false;if!(_success) exitWith{};if((player getVariable["ga_restrained",false])||!(alive player)) exitWith{["You didn't complete the processing successfully.","basic"]spawn life_fnc_handleMessage;};private _inputValsCheck=[];{_inputValsCheck pushBack(missionNamespace getVariable(format["life_inv_%1",_x select 0]));}forEach _input;if!(_inputVals isEqualTo _inputValsCheck) exitWith{};{if([false,_x select 0,_inputCount]call life_fnc_handleInv);}forEach _input;if((_input select 0) isEqualTo"plateMetal") exitWith{if((life_is_arrested select 0) isEqualTo 0) then{["You shouldn't be pressing license plates while not in jail...","basic"]spawn life_fnc_handleMessage;}else{if(A_stats_crimes select 57>=1) then{["You cannot press plates while admin jailed.","basic"]spawn life_fnc_handleMessage;}else{life_jailReleaseTime=life_jailReleaseTime-(_inputCount*25);life_is_arrested set[2,life_jailReleaseTime];[format["Your jail time was reduced by %1 seconds.",_inputCount*25],"basic"]spawn life_fnc_handleMessage;["plates",_inputCount]call life_fnc_statArrUpdate;["process","plates",1]call life_fnc_handleQuest;};};};private _reduce=false;if((_type in["marijuana","marijuanam"])&&(playerSide isEqualTo civilian&&!(23 in life_side_talents))) then{_reduce=true;};if((_type isEqualTo"heroin")&&(playerSide isEqualTo civilian&&!(24 in life_side_talents))) then{_reduce=true;};if((_type isEqualTo"cocaine")&&(playerSide isEqualTo civilian&&!(25 in life_side_talents))) then{_reduce=true;};if((_type isEqualTo"meth")&&(playerSide isEqualTo civilian&&!(26 in life_side_talents))) then{_reduce=true;};if((_type isEqualTo"crankp")&&(playerSide isEqualTo civilian&&!(26 in life_side_talents))) then{_reduce=true;};if(_reduce) then{_inputCount=floor(_inputCount*0.75);};private _capture=if(_capIndex>0) then{true}else{false};if(_capIndex isEqualTo 3) then{_capture=false};private _reductionAmt=0;private _flag=switch(_capIndex) do{case 1:{[drug_flag,", you retain %1 after the owners of Drug Cartel took a cut of %2 %3",0.85,"Drug Cartel"]};case 2:{oil_flag,", you retain %1 after the owners of Oil Cartel took a cut of %2 %3",0.85,"Oil Cartel"};default{[objNull,"",0.85,""]};};_flag params["_flagObj","_extra","_tax","_cartelName"];private _gangId=if!(life_gang_data isEqualTo[]) then{life_gang_data select 0}else{-1};if(_capture) then{if!(isNull _flagObj) then{(_flagObj getVariable["ga_capData",[0,"Neutral",0.5]]) params["_flagGangID","_flagGangName","_progress"];if!(_flagGangID isEqualTo _gangId) then{_reductionAmt=abs((floor(_inputCount*_tax))-_inputCount);_inputCount=floor(_inputCount*_tax);private _value=_reductionAmt*(["getLowestPrice",_output]call life_fnc_virtItemCfg);[[2,_flagGangID,player,_value],"TON_fnc_gangBank",2]spawn life_fnc_MP;}else{_extra="owner";};};};if([true,_output,_inputCount]call life_fnc_handleInv) then{if(_capture) then{if(_extra isEqualTo"owner") then{titleText[format["You have processed your goods into %1 %2. As the owner of %3, you retain the entire amount",_inputCount,(["getName",_output]call life_fnc_virtItemCfg),_cartelName],"PLAIN"];}else{titleText[format["You have processed your goods into %1%2",(["getName",_output]call life_fnc_virtItemCfg),format[_extra,_inputCount,_reductionAmt]],"PLAIN"];};}else{titleText[format["You have processed your goods into %1 %2",_inputCount,(["getName",_output]call life_fnc_virtItemCfg)],"PLAIN"];};if(_type isEqualTo"oil") then{private _rubbers=ceil(random 7);if(70 in life_side_talents) then{_rubbers=_rubbers+1};[true,"rubber",_rubbers]call life_fnc_handleInv;systemChat format["You've received %1 units of rubber while processing oil.",_rubbers];};};