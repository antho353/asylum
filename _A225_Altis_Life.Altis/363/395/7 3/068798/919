params[["_vehicle",objNull,[objNull]]];if(ASY_Server isEqualTo 2) exitWith{["This action is currently disabled on Server 2.","basic"]spawn life_fnc_handleMessage;};if(isNull _vehicle) exitWith{};if!(objNull isEqualTo(_vehicle getVariable["ga_mining",objNull])) exitWith{["This vehicle is already mining","basic"]spawn life_fnc_handleMessage;};closeDialog 0;life_action_in_use=true;if(((_vehicle getVariable["ga_vinv",[[],0]]) select 1)>=900) exitWith{["The vehicle is full","basic"]spawn life_fnc_handleMessage;life_action_in_use=false;};private _zone="";private _resourceZones=["apple_1","apple_2","apple_4","apple_5","peaches_2","peaches_3","peaches_4","weed_1","illegal_marker_1_0","illegal_marker_2_0","illegal_marker_3_0","rock_1","rock_2","rock_3","oil_1","oil_2","oil_3","salt_1"];private _dbInfo=_vehicle getVariable["ga_dbInfo",[]];private _zone=_resourceZones param[_resourceZones findIf{(player distance(getMarkerPos _x)<290)},""];if(_zone isEqualTo"") exitWith{["You are not near a resource field.","basic"]spawn life_fnc_handleMessage;life_action_in_use=false;};private _gatherArray=switch(true) do{case(_zone isEqualTo"illegal_marker_1_0"):{["heroinu",150];};case(_zone isEqualTo"illegal_marker_2_0"):{["cocaine",150];};case(_zone isEqualTo"illegal_marker_3_0"):{["ephedrau",150];};case(_zone isEqualTo"weed_1"):{["cannabis",150];};case(_zone find"rock"!=-1):{["phos",150];};case(_zone find"oil"!=-1):{["hydro",150];};case(_zone find"salt"!=-1):{["salt",150];};case(_zone find"apple"!=-1):{["apple",50];};case(_zone find"peaches"!=-1):{["peach",50];};default{""};};_gatherArray params["_item","_distance"];if(player distance(getMarkerPos _zone)>_distance) exitWith{};life_action_in_use=false;if(isEngineOn _vehicle) exitWith{titleText["The vehicle must be turned off before mining.","PLAIN"];};if!(objNull isEqualTo(_vehicle getVariable["ga_mining",objNull])) exitWith{["This vehicle is already mining","basic"]spawn life_fnc_handleMessage;};uiSleep(random 1);_vehicle setVariable["ga_mining",player,true];private _toSend=(allPlayers-[allDeadMen]) select{(_x distance player)<=2000};[[_vehicle],"life_fnc_soundDevice",_toSend,false,false]spawn life_fnc_MP;private _time=0;private _maxWeight=_vehicle getVariable["ga_vcap",900];private _sum=0;private _index=0;private _itemWeight=0;private _totalGathered=0;private _timeDelay=33.2;private _amountPerCycle=12;for"_i"from 0 to 1 step 0 do{if(!alive _vehicle||isNull _vehicle) exitWith{};if(player distance _vehicle>10) exitWith{["You must stay near the vehicle.","basic"]spawn life_fnc_handleMessage;