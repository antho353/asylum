};private _adminLevel=call life_adminLevel;if(_adminLevel==3) then{[["kill","admin",1],"life_fnc_handleQuest",_killer]spawn life_fnc_MP;};if(_killerVehicle in["B_G_Offroad_01_armed_F","I_C_Offroad_02_LMG_F","O_LSV_02_armed_F"]) then{private _vehKillStat=switch(true) do{case(_killerVehicle isEqualTo"I_C_Offroad_02_LMG_F"):{"killsbyarmedjeep"};case(_killerVehicle isEqualTo"O_LSV_02_armed_F"):{"killsbyarmedquil"};case(_killerVehicle isEqualTo"B_G_Offroad_01_armed_F"):{"killsbyarmedoffroad"};default{""};};_killerStatArr pushBack[_vehKillStat,1];};private _isWarKill=(!(_killer getVariable["gang_data",[]]isEqualTo[])&&{(_killer getVariable["gang_data",[-1]]select 0) in life_gang_wars});private _isInRestrictedAreas=((((getPosATL _killer) inPolygon life_drugPenPoly)&&((getPosATL _unit) inPolygon life_drugPenPoly))||(((getPosATL _killer) inPolygon life_warzonePoly)&&((getPosATL _unit) inPolygon life_warzonePoly)));private _notInWarzone=(!(getPos _unit inPolygon life_dominationPoly)&&!(getPos _killer inPolygon life_dominationPoly));private _notGangMember=if((_killer getVariable["gang_data",[]]isEqualTo[])||(life_gang_data isEqualTo[])) then{true}else{!((_killer getVariable["gang_data",[-1]]select 0) isEqualTo(life_gang_data select 0))};private _isCivs=((playerSide isEqualTo civilian)&&(side _killer isEqualTo civilian));private _inActiveFortress=((([["gang_fortress_marker"],400,_killer]call life_fnc_inZone)&&([["gang_fortress_marker"],400,_unit]call life_fnc_inZone))&&((gang_fortress_flag getVariable["ga_gang_fortress_data",[-1,"Unknown",false,"Unknown",grpNull]]) param[2,false]));private _isBountyKill=if(!(((_killer getVariable["ga_myBounties",[]]) findIf{(getPlayerUID player) in _x}) isEqualTo-1)&&side _killer isEqualTo civilian) then{true}else{false};[[_killer,_unit,playerSide,life_gang_data,(_killer getVariable["gang_data",[]]),_isWarKill,_isBountyKill,call life_copLevel,life_activeSWAT,_isHeadshot,(getPosATL _killer),(_killer distance2D _unit),_killerVehicle,(typeOf vehicle player),uniform _killer,_deadPlayerUniform],"life_fnc_questPlayerKilled",_killer]spawn life_fnc_MP;if(_isCivs&&_notInWarzone&&(_isWarKill||((_isInRestrictedAreas||_inActiveFortress)&&_notGangMember))) then{[[11,_killer],"TON_fnc_wantedAdd",false,false]spawn life_fnc_MP;private _killCache=(profileNamespace getVariable["ga_asy_killCache",[ASY_instance_id,[]]]) select 1;private _alreadyKilled=_killCache findIf{(getPlayerUID _killer) in _x};private _giveStat=true;if!(_alreadyKilled isEqualTo-1) then{if(((_killCache select _alreadyKilled) select 1)>time) then{_giveStat=false};if(_giveStat) then{(_killCache select _alreadyKilled) set[1,time+600];};}else{_killCache pushBack[getPlayerUID _killer,time+600];};profileNameSpace setVariable["ga_asy_killCache",[ASY_instance_id,_killCache]];if(_giveStat) then{private _killerNearCartel=!({(_killer distance getPos _x)<=300}count[arms_flag,drug_flag,oil_flag,wongs_flag]isEqualTo 0);private _killedNearCartel=!({(_unit distance getPos _x)<=300}count[arms_flag,drug_flag,oil_flag,wongs_flag]isEqualTo 0);private _distanceBonus=((_killer distance2D _unit)>=500);private _heightBonus=((getPosATL(vehicle _unit) select 2)>=100);private _killstreakBonus=((_killer getVariable["ga_warKillstreak",0])>=3);private _killerLoadoutPrice=(["rebel",getUnitLoadout _killer]call life_fnc_getLoadoutPrice);private _unitLoadoutPrice=(["rebel",getUnitLoadout _unit]call life_fnc_getLoadoutPrice);private _pointDiff=[_unitLoadoutPrice,_killerLoadoutPrice]call life_fnc_calculateWarRating;private _initialPoints=if(_distanceBonus||_heightBonus||_killstreakBonus) then{10}else{0};private _pointsToKiller=if(_killerNearCartel||_killedNearCartel) then{round(_initialPoints+_pointDiff+3)}else{round(_initialPoints+_pointDiff)};[[8,_pointsToKiller,(_killerNearCartel||_killedNearCartel||_distanceBonus||_heightBonus||_killstreakBonus)],"life_fnc_updateRemoteStat",_killer]spawn life_fnc_MP;[4,1]call life_fnc_updateRemoteStat;[5,ceil(-_pointDiff)]call life_fnc_updateRemoteStat;switch(true) do{case(_distanceBonus):{[[1,format["You killed %1 from a whopping distance of %2 meters! You have recieved a blood money and war rating bonus for this war kill.",name _unit,(_killer distance2D _unit)]],"life_fnc_broadcast",_killer]spawn life_fnc_MP;};case(_heightBonus):{[[1,format["You killed %1 whom was %2 meters above in the sky! You have recieved a blood money and war rating bonus for this war kill.",name _unit,(getPosATL _unit select 2)]],"life_fnc_broadcast",_killer]spawn life_fnc_MP;};case(_killstreakBonus):{[[1,format["You killed %1 while having a war killstreak of %2 kills! You have recieved a blood money and war rating bonus for this war kill.",name _unit,((_killer getVariable["ga_warKillstreak",0])+1)]],"life_fnc_broadcast",_killer]spawn life_fnc_MP;};};};}else{if(_unit getVariable["ga_civRestrained",false]) then{[[9,_killer],"TON_fnc_wantedAdd",false,false]spawn life_fnc_MP;}else{[[12,_killer],"TON_fnc_wantedAdd",false,false]spawn life_fnc_MP;};};};};removeAllWeapons player;private _clear=nearestObjects[_unit,["WeaponHolderSimulated"],3];{deleteVehicle _x}forEach _clear;"RadialBlur"ppEffectEnable false;disableUserInput false;if!(_unit getVariable["ga_name",""]isEqualTo profileName) then{_unit setVariable["ga_name",profileName,true]};if!(_unit getVariable["ga_group",grpNull]isEqualTo(group player)) then{_unit setVariable["ga_group",group player,true]};_unit setVariable["ga_revivable",false,true];{if!(isNil{_unit getVariable[_x,nil]}) then{_unit setVariable[_x,nil,true];};}forEach["ga_restrained","ga_escorting","ga_transporting","ga_can_revive","ga_disarmed"];if!(isNull life_escort) then{[]call life_fnc_stopEscorting;};if(playerSide isEqualTo west) then{private _spawnPoints=([playerSide]call life_fnc_spawnPointCfg) apply{_x select 0};_spawnPoints deleteAt 0;private _nearSPIdx=_spawnPoints findIf{_unit distance(getMarkerPos _x)<=100};if!(_nearSPIdx isEqualTo-1) then{(_spawnPoints select _nearSPIdx) spawn{life_disabled_spawns pushBackUnique _this;uiSleep 120;life_disabled_spawns=life_disabled_spawns-[_this];};};};if(life_adminEvent select 0&&playerSide isEqualTo civilian&&life_inEvent&&((life_adminEvent select 2) isEqualTo 1)) exitWith{if(_unit!=_killer&&((side _killer) isEqualTo civilian)) then{[[_killer,true],"life_fnc_eventGungameKill",_killer]spawn life_fnc_MP;};[_unit]call life_fnc_deathCamera;uiSleep 2;[player,false,_unit]spawn life_fnc_eventGungameKill;[life_sidechat]call life_fnc_manageSidechat;};if(life_adminEvent select 2 isEqualTo 2&&life_inEvent) exitWith{[_unit]call life_fnc_deathCamera;life_inEvent=false;life_respawned=true;[]call life_fnc_doRespawn;[life_sidechat]call life_fnc_manageSidechat;};if(life_isActiveFirefighter) then{deleteVehicle life_hoseObject;deleteVehicle life_axeObject;life_axeObject=objNull;life_hoseObject=objNull;life_isActiveFirefighter=false;life_firehoseGallons=0;life_firehoseProgress=0;};if!(_killerRemoteStats isEqualTo[]) then{[[0,0,false,_killerRemoteStats],"life_fnc_updateRemoteStat",_killer]spawn life_fnc_MP;};if!(_killerStatArr isEqualTo[]) then{[["",-1,_killerStatArr],"life_fnc_statArrUpdate",_killer]spawn life_fnc_MP;};_unit spawn{waitUntil{!dialog};uiSleep 0.25;createDialog"DeathScreen";(findDisplay 7300) displaySetEventHandler["KeyDown","(_this select 1) isEqualTo 1"];[]spawn life_fnc_deathScreen;disableSerialization;private _timer=(findDisplay 7300) displayCtrl 7301;private _respawnBtn=(findDisplay 7300) displayCtrl 7302;private _maxTime=time+(life_respawn_timer*60);_respawnBtn ctrlEnable false;waitUntil{_timer ctrlSetStructuredText parseText format["<t align='center'>Respawn Available in: %1</t>",[_maxTime-time,"MM:SS"]call BIS_fnc_secondsToString];round(_maxTime-time)<=0||isNull _this };_respawnBtn ctrlEnable true;_timer ctrlSetStructuredText parseText"<t align='center'>You can now respawn</t>";private _medic="";private _medicName="";private _maxTime=time+(life_death_timer*60);private _timerStopTime=-1;waitUntil{if!(isNull life_medic_enroute) then{_medicName=if(side life_medic_enroute isEqualTo west) then{format["APD Medic %1",name life_medic_enroute]}else{format["AFD Medic %1",name life_medic_enroute]};_medic=format["%1 is en-route!<br/>",_medicName];if((!isNull life_medic_enroute)&&!(alive life_medic_enroute)) then{[format["%1 was killed enroute, you may respawn or request a new medic!",_medicName],"basic"]spawn life_fnc_handleMessage;player setVariable["ga_medRequest",false];life_medic_enroute=objNull;_medic="";};if(player getVariable["ga_medRequest",false]) then{_respawnBtn ctrlEnable false;}else{_respawnBtn ctrlEnable true;};};if!(isNull(_this getVariable["ga_reviving",objNull])) then{if(_timerStopTime==-1) then{_timerStopTime=time;};_timer ctrlSetStructuredText parseText format["<t align='center'>You are currently being revived</t>",_medic];}else{if(_timerStopTime!=-1) then{_maxTime=_maxTime+(time-_timerStopTime);_timerStopTime=-1;};_timer ctrlSetStructuredText parseText format["<t align='center'>%2You will bleed to death in: %1</t>",[_maxTime-time,"MM:SS"]call BIS_fnc_secondsToString,_medic];};((round(_maxTime-time)<=0)&&isNull(_this getVariable["ga_reviving",objNull]))||isNull _this||life_respawned };if(!isNull _this&&!(life_respawned)) then{life_respawned=true;[]call life_fnc_doRespawn;};};[_unit]call life_fnc_deathCamera;asyv_hunger=100;asyv_thirst=100;life_carryWeight=0;if(player getVariable["ga_warKillstreak",0]>=1) then{player setVariable["ga_warKillstreak",0,true]};if(player getVariable["ga_domKillstreak",0]>=1) then{player setVariable["ga_domKillstreak",0,true]};if!(isNil"life_actions") then{{_unit removeAction _x;}forEach life_actions;life_actions=[];};if!(playerSide isEqualTo civilian) then{[0]call life_fnc_ClupdatePartial;};