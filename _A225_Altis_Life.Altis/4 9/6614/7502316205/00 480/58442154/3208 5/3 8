_priceArr append((["skiptracer"]call life_fnc_weaponShopCfg) select 1);};case"medic":{_priceArr=[5]call life_fnc_clothing_med;_priceArr append((["med_basic"]call life_fnc_weaponShopCfg) select 1);};};private _virtualPrice=0;private _shopType=if(playerSide isEqualTo civilian) then{"rebel"}else{"cop"};if(_virtualLoadout isNotEqualTo[]) then{{_x params[["_virtName",""],["_virtQty",0]];private _basePrice=["getBasePrice",_virtName]call life_fnc_virtItemCfg;private _price=_basePrice*([_shopType,true]call life_fnc_getDiscount);private _shortName=["getShortName",_virtName]call life_fnc_virtItemCfg;_price=switch(true) do{case((_shortName isEqualTo"vammo")&&(7 in life_achievements)):{0};default{_price};};_price=if(_shopType in["rebel","turf"]) then{_price}else{_price+(_price*(call life_fnc_getGovTax))};_virtualPrice=_virtualPrice+(_price*_virtQty);}forEach _virtualLoadout;};if(_items isEqualTo[]||_priceArr isEqualTo[]) exitWith{-1};private _noPrice=false;private _loadoutCost=0;private _unavailItems="";{_x params["_classname","_count"];private _index=_priceArr findIf{_classname==(_x select 0)};if(_count isEqualType true) then{_count=1};if!(_index isEqualTo-1) then{_loadoutCost=_loadoutCost+(((_priceArr select _index) select 2)*_count);}else{_noPrice=true;_unavailItems=_unavailItems+format["%1<br/>",(([_classname]call life_fnc_fetchCfgDetails) select 1)];};}forEach _items;if(_noPrice) exitWith{if(_msg) then{[format["The following items are unavailable at this shop location and will not allow saving or purchasing of this loadout.<br/><t color='#FF0000'>%1</t>",_unavailItems],"weppurchase"]spawn life_fnc_handleMessage;};-1};_loadoutCost=_loadoutCost+_virtualPrice;if(_type isNotEqualTo"rebel") then{_loadoutCost=_loadoutCost+(_loadoutCost*(call life_fnc_getGovTax))};private _ownAndInFortress=([["gang_fortress_marker"],400,player]call life_fnc_inZone)&&(((gang_fortress_flag getVariable["ga_gang_fortress_data",[-1,"Unknown",false,"Unknown",grpNull]]) param[0,-1]) isEqualTo(life_gang_data param[0,-1]));_loadoutCost=if(_ownAndInFortress) then{_loadoutCost-(_loadoutCost*0.15)}else{_loadoutCost};_loadoutCost=if(SRV_dominationCheapWeapons&&(call life_fnc_isDominationActive)) then{_loadoutCost-(_loadoutCost*0.45)}else{_loadoutCost};_loadoutCost=if(playerSide!=west) then{(_loadoutCost-(_loadoutCost*0.10))}else{0};_loadoutCost;