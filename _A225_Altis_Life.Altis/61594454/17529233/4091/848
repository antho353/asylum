params["","","",["_target",objNull,[objNull]]];private _unit=cursorTarget;if(_target isEqualTo player) then{_unit=player};if(damage player<0.25&&((player getVariable["ga_can_revive",-1000])>time)) exitWith{[format["Because you have been revived recently, you cannot bloodbag for another %1 seconds",(player getVariable["ga_can_revive",time])-time],"basic"]spawn life_fnc_handleMessage;};if(isNull _unit||!(_unit isKindOf"CAManBase")||!(isPlayer _unit)||!(alive _unit)) exitWith{["Not a valid target for blood bag.","basic"]spawn life_fnc_handleMessage};if(player distance _unit>6||life_action_in_use) exitWith{};if!(isNull objectParent player) exitWith{["You can't help someone from within a vehicle.","basic"]spawn life_fnc_handleMessage};life_action_in_use=true;private _success=false;private _text=format["Giving transfusion to %1",name _unit];disableSerialization;5 cutRsc["life_progress","PLAIN"];private _ui=uiNamespace getVariable["life_progress",displayNull];private _progress=_ui displayCtrl 38201;private _pgText=_ui displayCtrl 38202;_pgText ctrlSetText format["%2 (1%1)...","%",_text];_progress progressSetPosition 0.01;private _cP=0.01;player forceWalk true;private _animation=switch(true) do{case((_unit isEqualTo player)&&playerSide isEqualTo civilian&&(stance player isEqualTo"PRONE")&&(468 in life_completedLifetimeQuests)):{"AinvPpneMstpSnonWnonDnon_G01"};case(!(_unit isEqualTo player)&&playerSide isEqualTo civilian&&(stance player isEqualTo"PRONE")&&(469 in life_completedLifetimeQuests)):{"AinvPpneMstpSnonWnonDnon_G01"};case((_unit isEqualTo player)&&playerSide isEqualTo independent&&(stance player isEqualTo"PRONE")&&(802 in life_completedLifetimeQuests)):{"AinvPpneMstpSnonWnonDnon_G01"};case(!(_unit isEqualTo player)&&playerSide isEqualTo independent&&(stance player isEqualTo"PRONE")&&(803 in life_completedLifetimeQuests)):{"AinvPpneMstpSnonWnonDnon_G01"};case(!(_unit isEqualTo player)&&playerSide isEqualTo west&&(stance player isEqualTo"PRONE")&&(34 in life_cop_talents)):{"AinvPpneMstpSnonWnonDnon_G01"};default{"AinvPknlMstpSnonWnonDnon_medic_1"};};if(_animation isEqualTo"AinvPpneMstpSnonWnonDnon_G01") then{player playMoveNow"AinvPpneMstpSlayWnonDnon_medic";}else{[_animation,1.5]spawn life_fnc_handleAnim;};private _multiplier=switch(true) do{case(119 in life_side_talents):{0.25};case(118 in life_side_talents):{0.5};case(117 in life_side_talents):{0.8};case(life_coprole in["all","medic"]&&{17 in life_cop_talents}):{0.5};case(life_coprole in["all","medic"]&&{16 in life_cop_talents}):{0.75};