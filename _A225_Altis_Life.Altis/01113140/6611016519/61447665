if(life_isDowned||!(alive player)||!(life_action_in_use)||isWeaponDeployed player) exitWith{};if(player getVariable["ga_restrained",false]) exitWith{};if(player distance _target>4||isNull _target) exitWith{};if!(_revivable) exitWith{};if(isNull(_target getVariable["ga_reviving",objNull])) exitWith{["This person can no longer be saved","basic"]spawn life_fnc_handleMessage;};if(_target getVariable["ga_reviving",objNull]!=player) exitWith{["Someone else is already reviving this person.","basic"]spawn life_fnc_handleMessage;};if(_cP>=1) exitWith{_success=true;};};5 cutText["","PLAIN"];life_action_in_use=false;_target setVariable["ga_reviving",nil,true];if!(_success) exitWith{private _anim=switch(true) do{case(currentWeapon player isEqualTo""):{"amovpknlmstpsnonwnondnon"};case(currentWeapon player isKindOf["Rifle",configFile>>"CfgWeapons"]):{"amovpknlmstpsraswrfldnon"};default{"amovpknlmstpsraswpstdnon"};};player switchMove _anim;player setVariable["ga_inAnim",false];};[]spawn life_fnc_handleAnim;private _nextRevive=if(121 in life_side_talents) then{time+60}else{time+240};private _defibChargeTime=switch(true) do{case(playerSide isEqualTo independent):{300};case(life_coprole in["all","medic"]&&{19 in life_cop_talents}):{240};default{360};};profileNameSpace setVariable["ga_recent_revive",[ASY_instance_id,time+_defibChargeTime]];if(isNull(life_medicAcceptedCorpse param[1,objNull])) then{private _reviveReward=if(playerSide isEqualTo independent) then{call life_revive_fee}else{((call life_revive_fee)-1000)};if(playerSide isNotEqualTo independent) then{life_atmcash=life_atmcash+_reviveReward;life_atmcashCache=((life_atmcash/4)+5);titleText[format["You have revived %1 and received $%2 for rendering aid.",_targetName,[_reviveReward]call life_fnc_numberText],"PLAIN"];}else{private _partners=[];if!(life_medPartners isEqualTo[]) then{_partners=[7,objNull]call life_fnc_medicPartners;};private _reviveReward=round(_reviveReward*0.85);if(_partners isEqualTo[]) then{life_atmcash=life_atmcash+_reviveReward;life_atmcashCache=((life_atmcash/4)+5);titleText[format["You have revived %1 and received $%2 for rendering aid.",_targetName,[_reviveReward]call life_fnc_numberText],"PLAIN"];}else{_reviveReward=round(_reviveReward/((count _partners)+1));life_atmcash=life_atmcash+_reviveReward;life_atmcashCache=((life_atmcash/4)+5);titleText[format["You have revived %1 and received $%2 for rendering aid.",_targetName,[_reviveReward]call life_fnc_numberText],"PLAIN"];[[_partners,_reviveReward],"TON_fnc_medicSplit",2]spawn life_fnc_MP;[[format["You have received %1 for a revive performed by %2.",[_reviveReward]call life_fnc_numberText,profileName]],"life_fnc_handleMessage",_partners]call life_fnc_MP;};if((floor(random 3)) isEqualTo 0&&playerSide isEqualTo independent) then{[[player],"TON_fnc_airDropMedic",2]call life_fnc_MP;};};private _xpReward=if(playerSide isEqualTo independent) then{50}else{30};life_side_exp=life_side_exp+_xpReward;[1]call life_fnc_ClupdatePartial;};[[player,false,false,false,_nextRevive],"life_fnc_revived",_target]spawn life_fnc_MP;if(_target getVariable["ga_lowtime",false]) then{life_newPlyrRev=life_newPlyrRev+1;};uiSleep 0.6;player reveal _target;_target setVariable["ga_requestAccepetor",[objNull,""],true];if(playerSide isEqualTo west&&life_coprole in["all","medic","detective"]) then{[500]spawn life_fnc_earnPrestige};["defibs",1]call life_fnc_statArrUpdate;switch(playerSide) do{case civilian:{A_stats_civRevives=A_stats_civRevives+1};case independent:{A_stats_medRevives=A_stats_medRevives+1;};default{};};["revived","player",1]spawn life_fnc_handleQuest;if(side _target==west) then{["revived","cop",1]spawn life_fnc_handleQuest;};if(side _target==civilian) then{["revived","civilian",1]spawn life_fnc_handleQuest;};