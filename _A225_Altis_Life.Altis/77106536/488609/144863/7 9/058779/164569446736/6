[["-HACKLOG-",player,profileName,format["All ctrlTexts: %1.",_toCheck apply{ctrlText _x}]],"TON_fnc_logIt",2]spawn life_fnc_MP;(findDisplay 6) closeDisplay 0;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};}forEach _toCheck;}forEach _badUIStrings };};if!(isNull findDisplay 12) then{if((count(allControls(findDisplay 12))>113)) then{private _toCheck=(allControls(findDisplay 12)) select{ctrlText _x!=""};{private _string=toLower _x;{if(_string in(toLower(ctrlText _x))) exitWith{[["-HACKLOG-",player,profileName,format["was detected with bad controls for Display 12 (Map display). Detected string: %1 - full text: %2. Expected control count: 113 - actual: %3.",_string,ctrlText _x,count(allControls(findDisplay 12))]],"TON_fnc_logIt",2]spawn life_fnc_MP;(findDisplay 12) closeDisplay 0;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};}forEach _toCheck;}forEach _badUIStrings };};if!(isNull(findDisplay 24)) then{if(count(allControls(findDisplay 24))>2) exitWith{[["-HACKLOG-",player,profileName,format["has too many controls for Display 24 (RscDisplayChat) - amount: %1. All ctrlTexts: %2",count(allControls(findDisplay 24)),((allControls(findDisplay 24)) select{ctrlText _x!=""&&!("\A3\"in ctrlText _x)}) apply{ctrlText _x}]],"TON_fnc_logIt",2]spawn life_fnc_MP;(findDisplay 24) closeDisplay 0;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};};if!(isNull(findDisplay 46)) then{if(12 in(allControls(findDisplay 46) apply{ctrlType _x})) then{private _treeControl=(allControls(findDisplay 46)) param[(allControls(findDisplay 46)) findIf{ctrlType _x isEqualTo 12},controlNull];if!(isNull _treeControl) then{private _tvTexts=[];for"_parent"from 0 to 10 do{private _tvCount=_treeControl tvCount[_parent];if!(_tvCount isEqualTo-1) then{for"_child"from 0 to(_tvCount-1) do{_tvTexts pushBack(_treeControl tvText[_parent,_child]) };};};{private _badString=toLower _x;if!(_tvTexts findIf{_badString in(toLower _x)}isEqualTo-1) exitWith{[["-HACKLOG-",player,profileName,format["was detected with a potential TreeView cheat menu for Display 46 (Mission display). TreeView texts: %1.",_tvTexts]],"TON_fnc_logIt",2]spawn life_fnc_MP;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};}forEach _badUIStrings;};};};if!(isNull(findDisplay 49)) then{{private _control=_x;{if(_x in(ctrlText _control)) exitWith{[["-HACKLOG-",player,profileName,format["was detected with modified display (RscDisplayInterrupt). Control: %1 - text: %2.",_control,ctrlText _control]],"TON_fnc_logIt",2]spawn life_fnc_MP;(findDisplay 49) closeDisplay 0;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};}forEach _badUIStrings;}forEach[(findDisplay 49) displayCtrl 2,(findDisplay 49) displayCtrl 103,(findDisplay 49) displayCtrl 1010];};_display=findDisplay 54;if!(isNull _display) then{if!((count allControls(findDisplay 54)) isEqualTo 9) then{[["-HACKLOG-",player,profileName,format["doesn't have the right control amount for Display 54 (RscDisplayInsertMarker) - amount: %1 (expected 9). All ctrlTexts: %2",count(allControls(findDisplay 54)),((allControls(findDisplay 24)) select{ctrlText _x!=""&&!("\A3\"in ctrlText _x)}) apply{ctrlText _x}]],"TON_fnc_logIt",2]spawn life_fnc_MP;(findDisplay 54) closeDisplay 0;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};{if(_x&&!isNull _display) exitWith{[[3,player,"Menu Hack Detected","RscDisplayInsertMarker"],"TON_fnc_discordEmbed",2]call life_fnc_MP;[["-SpyG-",player,(profileName),"DisplayInsertMarker Hack"],"TON_fnc_logIt",2]call life_fnc_MP;closeDialog 0;uiSleep 4;[[7,player],"TON_fnc_hackDetection",2]call life_fnc_MP;};}forEach[(toLower ctrlText(_display displayCtrl 1001)!=toLower localize"STR_A3_RscDisplayInsertMarker_Title"),{if(buttonAction(_display displayCtrl _x)!="") exitWith{true};false}forEach[1,2]];};if!(isNull(findDisplay 129)) then{(findDisplay 129) closeDisplay 0;};_display=findDisplay 131;if!(isNull _display) then{(_display displayCtrl 102) ctrlRemoveAllEventHandlers"LBDblClick";(_display displayCtrl 102) ctrlRemoveAllEventHandlers"LBSelChanged";{if(_x&&!isNull _display) exitWith{[["-SpyG-",player,(profileName),"DisplayConfigureAction Hack"],"TON_fnc_logIt",2]call life_fnc_MP;closeDialog 0;uiSleep 4;[[7,player],"TON_fnc_hackDetection",2]call life_fnc_MP;};}forEach[(toLower ctrlText(_display displayCtrl 1000)!=toLower localize"STR_A3_RscDisplayConfigureAction_Title"),{if(buttonAction(_display displayCtrl _x)!="") exitWith{true};false}forEach[1,104,105,106,107,108,109]];};if!(isNull(findDisplay 148)) then{uiSleep 0.5;if((lbSize 104)-1>3) exitWith{[["-SpyG-",player,(profileName),"MenuBasedHack_RscDisplayConfigureControllers"],"TON_fnc_logIt",2]call life_fnc_MP;closeDialog 0;uiSleep 4;[[7,player],"TON_fnc_hackDetection",2]call life_fnc_MP;};};if!(isNull(findDisplay 151)) then{if(count(allControls(findDisplay 151))>142) exitWith{[["-HACKLOG-",player,profileName,format["has too many controls for Display 151 (RscDisplayGameOptions) - amount: %1. ctrlTexts: %2",count(allControls(findDisplay 151)),((allControls(findDisplay 151)) select[142,count(allControls(findDisplay 151))]) apply{ctrlText _x}]],"TON_fnc_logIt",2]spawn life_fnc_MP;(findDisplay 151) closeDisplay 0;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};};_display=findDisplay 163;if!(isNull _display) then{(_display displayCtrl 101) ctrlRemoveAllEventHandlers"LBDblClick";(_display displayCtrl 101) ctrlRemoveAllEventHandlers"LBSelChanged";{if(_x&&!isNull _display) exitWith{[["-SpyG-",player,(profileName),"ControlSchemes Hack"],"TON_fnc_logIt",2]call life_fnc_MP;closeDialog 0;uiSleep 4;[[7,player],"TON_fnc_hackDetection",2]call life_fnc_MP;};}forEach[(toLower ctrlText(_display displayCtrl 1000)!=toLower localize"STR_DISP_OPTIONS_SCHEME"),{if(buttonAction(_display displayCtrl _x)!="") exitWith{true};false}forEach[1,2]];};if(!isNull(findDisplay 602)&&{(count(allControls(findDisplay 602))>97)&&!(count(allControls(findDisplay 602)) isEqualTo 107)}) exitWith{[["-HACKLOG-",player,profileName,format["has too many controls for Display 602 (RscDisplayInventory) - amount: %1. All ctrlTexts: %2",count(allControls(findDisplay 602)),((allControls(findDisplay 602)) select{ctrlText _x!=""&&!("\A3\"in ctrlText _x)}) apply{ctrlText _x}]],"TON_fnc_logIt",2]spawn life_fnc_MP;(findDisplay 602) closeDisplay 0;["SpyGlass",false,false]execVM"\a3\functions_f\Misc\fn_endMission.sqf";};if!((unitRecoilCoefficient player) isEqualTo 1) then{if!((unitRecoilCoefficient player) isEqualTo-1) then{[[3,player,"Bad RecoilCoef Value",str(unitRecoilCoefficient player)],"TON_fnc_discordEmbed",2]call life_fnc_MP;[["-SpyG-",player,profileName,format["Possible no-recoil hack: RecoilCoef: %1",unitRecoilCoefficient player]],"TON_fnc_logIt",2]call life_fnc_MP;uiSleep 4;[[7,player],"TON_fnc_hackDetection",2]call life_fnc_MP;};};if(((life_loweredSwayEnabled)&&((getCustomAimCoef player)<0.616))||(!(life_loweredSwayEnabled)&&((getCustomAimCoef player)<0.7))) then{[[3,player,"No Sway Detected",str(getCustomAimCoef player)],"TON_fnc_discordEmbed",2]call life_fnc_MP;[["-SpyG-",player,(profileName),format["Possible no-sway hack: Aim coefficient: %1",getCustomAimCoef player]],"TON_fnc_logIt",2]call life_fnc_MP;uiSleep 4;[[7,player],"TON_fnc_hackDetection",2]call life_fnc_MP;};if(life_fatigueEnabled&&((getAnimSpeedCoef player)>1.15)) then{[[3,player,"Speed Hack Detected",str(getAnimSpeedCoef player)],"TON_fnc_discordEmbed",2]call life_fnc_MP;[["-SpyG-",player,(profileName),format["Possible speed hack: AnimSpeed: %1",getAnimSpeedCoef player]],"TON_fnc_logIt",2]call life_fnc_MP;uiSleep 4;[[7,player],"TON_fnc_hackDetection",2]call life_fnc_MP;};uiSleep 2;};