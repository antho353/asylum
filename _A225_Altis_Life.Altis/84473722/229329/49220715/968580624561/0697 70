_mainItemList lnbSetValue[[_rowIndex,1],round _price];_mainItemList lnbSetValue[[_rowIndex,2],_qtyInInventory];if(_isDomination) then{_color set[3,1];}else{if(_shopType in["rebel"]) then{if(life_cash>=_price) then{_color set[3,1]};};if(((life_cash>=_price)||((life_atmcash>=_price)&&(life_inv_debitcard>=1)))&&!(_shopType in["rebel"])) then{_color set[3,1]};for"_columnIndex"from 0 to 1 do{_mainItemList lnbSetColor[[_rowIndex,_columnIndex],_color]};};};}forEach _buyItems;{_x params[["_item",""]];if(!(_item isEqualTo"")&&!(_item in _buyItems)) then{private _name=["getName",_item]call life_fnc_virtItemCfg;private _picture=["getIcon",_item]call life_fnc_virtItemCfg;private _qtyInInventory=missionNameSpace getVariable[format["life_inv_%1",_item],0];private _color=[1,1,1,0.3];if(_qtyInInventory isEqualTo 0) exitWith{};private _price=if((_item in _buyItems)&&(_item in _sellItems)) then{private _buyPrice=["getBasePrice",_item]call life_fnc_virtItemCfg;_buyPrice=_buyPrice*([_shopType,true]call life_fnc_getDiscount);private _sellPrice=["getLowestPrice",_item]call life_fnc_virtItemCfg;_sellPrice=_sellPrice*([_shopType,false]call life_fnc_getDiscount);selectMin[_sellPrice,_buyPrice];}else{private _sellPrice=["getLowestPrice",_item]call life_fnc_virtItemCfg;if(_item=="goldbar"&&(life_gang_data select 0) isEqualTo(zaros_flag getVariable["ga_turf_data",[]]select 0)) then{_sellPrice=_sellPrice*1.1}else{_sellPrice};_sellPrice*([_shopType,false]call life_fnc_getDiscount);};private _buffPercent=["questBuffs",false,_item]call life_fnc_getDiscount;private _addBuff=if(_buffPercent isEqualTo 0) then{0}else{(_price*_buffPercent)};_price=round((_price+_addBuff)*1);private _formatText=format["$%1",[round _price]call life_fnc_numberText];private _invText=format["%1",_qtyInInventory];private _rowIndex=_mainItemList lnbAddRow[_name,_formatText,_invText];_mainItemList lnbSetPicture[[_rowIndex,0],_picture];_mainItemList lnbSetData[[_rowIndex,0],_item];_mainItemList lnbSetValue[[_rowIndex,1],round _price];_mainItemList lnbSetValue[[_rowIndex,2],_qtyInInventory];};}forEach _sellItems;{private _itemListGroup=_x;private _itemList=_itemListGroup controlsGroupCtrl 1000;private _headerButtons=(allControls(ctrlParent _itemListGroup)) select{((ctrlClassName _x) isEqualTo"Life_RscListNBoxHeaderButton")&&((ctrlParentControlsGroup _x) isEqualTo _itemListGroup)};{_x ctrlEnable((lbSize _itemList)>=1)}forEach _headerButtons;}forEach[_mainListGroup];ctrlSetFocus _mainItemList;[_mainItemList,0,true,true]call life_fnc_listNBoxSort;_mainItemList ctrlSetFade 0.00;_mainItemList ctrlCommit 0.00;