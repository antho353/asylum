private _startPos=getPos player;private _nBuilding=nearestBuilding player;private _rodoDrugs=["cocaine","heroinu"];private _gangDrugs=["cocaine","heroinu","cannabis"];private _giveExtraGangTalent8=(_item in _gangDrugs&&8 in life_gang_talents);private _giveExtraGangTalent9=(_item in["ephedrau"]&&9 in life_gang_talents);private _totalGathered=0;private _exit=false;private _sleepDelay=5;for"_i"from 0 to 1 step 0 do{if(_exit||(player distance2D _startPos)>2||(player distance(getMarkerPos _zone)>_distance)||!(isNull objectParent player)) exitWith{};if(player distance _nBuilding<=10&&!(_item isEqualTo"plateMetal")) exitWith{["You can't gather items so close to a building.","basic"]spawn life_fnc_handleMessage;};if!(life_action_in_use) exitWith{};uiSleep 4;private _count=switch(true) do{case(_item in _rodoDrugs&&(life_gang_data param[0,-1337]isEqualTo(rodo_flag getVariable["ga_turf_data",[]]select 0))):{selectRandom[1,2]};default{1};};private _amount=if(random 4<1&&(_giveExtraGangTalent8||_giveExtraGangTalent9)) then{_count+1}else{_count};switch(true) do{case((_item isEqualTo"oysteru")&&(random 2000<1)&&((life_maxWeight-life_carryWeight)>3)):{[true,"treasuremap",1]call life_fnc_handleInv;["You have just found a rare treasure map in the oyster field!","basic"]spawn life_fnc_handleMessage;};case((_item isEqualTo"oysteru")&&(random 15<1)&&((life_maxWeight-life_carryWeight)>3)):{[true,"pearl",1]call life_fnc_handleInv;["You have just found a pearl in the oyster field!","basic"]spawn life_fnc_handleMessage;};};if([true,_item,_amount]call life_fnc_handleInv) then{titleText[format["Gathered %1 %2. %3/%4",_amount,["getName",_item]call life_fnc_virtItemCfg,life_carryWeight,life_maxWeight],"PLAIN"];life_side_exp=life_side_exp+1;_totalGathered=_totalGathered+_amount;[_item,_amount]call life_fnc_statArrUpdate;}else{_exit=true;};};if(_exit) then{titleText[format["Gathering done. You can't hold more %1.",["getName",_item]call life_fnc_virtItemCfg],"PLAIN",0.3];}else{titleText["Gathering cancelled.","PLAIN"];};life_action_gathering=false;life_action_in_use=false;[["-GATHER-",player,profileName,format["gathered %1 %2 at position %3.",_totalGathered,["getName",_item]call life_fnc_virtItemCfg,getPosATL player]],"TON_fnc_logIt",2]spawn life_fnc_MP;