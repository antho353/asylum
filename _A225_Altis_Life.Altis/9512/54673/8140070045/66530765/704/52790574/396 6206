if(_forSale) then{_curPhys=_house getVariable["ga_phys_cap",-1];_curVirt=_house getVariable["ga_vcap",-1];_buyPrice=_house getVariable["ga_house_price",-3];_hasBarrel=if(_house getVariable["ga_barrel_unaged",false]) then{"This building has the aging upgrade already purchased."}else{"This building does not currently have the aging upgrade."};_hasGreenhouse=if(_house getVariable["ga_greenhouse_unaged",false]) then{"This building has the greenhouse upgrade already purchased."}else{"This building does not currently have the greenhouse upgrade."};_hasLeadContainer=if(_house getVariable["ga_leadcontainer_unaged",false]) then{"This building has the lead container upgrade already purchased."}else{"This building does not currently have the lead container upgrade."};};if(_curVirt isEqualTo-1||_curPhys isEqualTo-1||_buyPrice isEqualTo-3) exitWith{["An error has occured. Try again...","basic"]spawn life_fnc_handleMessage;};if(_buyPrice isEqualTo-1||{_sellPrice isEqualTo-1}) exitWith{};life_action_in_use=true;private _text=if(_forSale) then{format["This house is for sale by owner for $%1. It currently is upgraded to %2 physical inventory of %3 max and %4 virutal inventory of %5 max. %6. %7. %8.",[_buyPrice]call life_fnc_numberText,_curPhys,_maxPhys,_curVirt,_maxVirt,_hasBarrel,_hasGreenhouse,_hasLeadContainer]}else{_tax=(_buyPrice*(call life_fnc_getGovTax));_buyPrice=(_buyPrice+_tax);format["This house is available for $%1, including a tax of $%7. It can hold up to %2 physical inventory and %3 virtual inventory. This building %4 the aging of liquor. This building %5 a greenhouse. This building %6 a lead container.",[_buyPrice]call life_fnc_numberText,_maxPhys,_maxVirt,_canAgeBarrel,_canAgeGreenhouse,_canAgeLeadContainer,[_tax]call life_fnc_numberText]};if(ASY_Server isEqualTo 2) then{_text=format["WARNING: It is unknown how long Server 2 will be available for. If Server 2 is to be shut down, you will not receive compensation for the house or its contents. %1",_text];};private _action=[_text,"Buy House","Purchase","Cancel"]call life_fnc_guiMessage;if!(_action) exitWith{closeDialog 0;["You have decided to not purchase the home at this time.","basic"]spawn life_fnc_handleMessage;life_action_in_use=false;};if(scriptAvailable(60)) exitWith{["You cannot rapidly purchase houses!","basic"]spawn life_fnc_handleMessage;life_action_in_use=false;};if(count life_houses>=(call life_houseLimit)) exitWith{[format["You currently own the max limit of buildings on the server. Limit: %1",call life_houseLimit],"basic"]spawn life_fnc_handleMessage;life_action_in_use=false;};if((life_atmcash<_buyPrice)&&(life_cash<_buyPrice)) exitWith{[format["You do not have %1 in your bank or on-hand to purchase this building.",[_buyPrice]call life_fnc_numberText],"basic"]spawn life_fnc_handleMessage;life_action_in_use=false;};if(life_houseTxn) exitWith{["You are currently in the process of buying or selling a home.","basic"]spawn life_fnc_handleMessage;};life_houseTxn=true;if(life_cash>=_buyPrice) then{life_cash=life_cash-_buyPrice;life_cashCache=((life_cash/4)+7);}else{life_atmcash=life_atmcash-_buyPrice;life_atmcashCache=((life_atmcash/4)+5);};[6]call life_fnc_ClupdatePartial;if!(_forSale) then{[[player,getPlayerUID player,_house,_buyPrice],"TON_fnc_addHouse",false,false]spawn life_fnc_MP;["Contacting the Altis Realtor Group to send an offer...","basic"]spawn life_fnc_handleMessage;}else{[[player,getPlayerUID player,_house,_buyPrice],"TON_fnc_transferHouse",false,false]spawn life_fnc_MP;["Contacting the Altis Realtor Group to transfer ownership...","basic"]spawn life_fnc_handleMessage;};