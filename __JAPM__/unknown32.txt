params[["_missionType","",[""]],"_missionData"];switch(_missionType) do{case("openedGhostHawkCrate"):{_missionData params[["_ghosthawkCrate",objNull,[objNull]]];private _opened=_ghosthawkCrate getVariable["ga_dom_crateOpened",false];life_gang_data params[["_myGangID",-1,[0]],["_myGangName","",[""]],["_myGangRank",-1,[0]]];if(_myGangID isEqualTo-1) exitWith{["You need a gang to take points!","basic"]spawn life_fnc_handleMessage;};disableSerialization;5 cutRsc["life_progress","PLAIN"];private _display=uiNameSpace getVariable["life_progress",displayNull];private _progressBar=_display displayCtrl 38201;private _progressText=_display displayCtrl 38202;private _increment=1;private _totalTime=selectRandom[6,7,9,5];private _currentPoint=0;private _loopDelay=_totalTime/floor(100/_increment);private _text=format["Taking Ghost Hawk Crate Points"];private _pos=getPosATL _ghosthawkCrate;private _startCount=0;_progressBar progressSetPosition _startCount;_progressText ctrlSetText format["%1 (%2%3)",_text,_startCount,"%"];private _isSuccess=for"_i"from 0 to 1 step 0 do{uiSleep _loopDelay;if(isNull _progressBar) exitWith{["You have failed to take the ghost hawk points!","basic"]spawn life_fnc_handleMessage;false};_currentPoint=(progressPosition _progressBar)+(_increment/100);_progressBar progressSetPosition _currentPoint;_progressText ctrlSetText format["%1 (%2%3)",_text,round(_currentPoint*100),"%"];private _checkToExit=!(call life_fnc_isDominationActive);if(player distance _pos>12||life_isDowned||player getVariable["ga_restrained",false]||!alive player) exitWith{false};if(_checkToExit) exitWith{false};if!(isNull objectParent player) exitWith{false};if(_currentPoint>=1) exitWith{true};false;};5 cutText["","PLAIN"];if!(_isSuccess) exitWith{};if!(_opened) then{_ghosthawkCrate setVariable["ga_dom_crateOpened",true,true];[["addPoints",[_myGangID,_myGangName,200]],"TON_fnc_dominationSRV",2]spawn life_fnc_MP;};};case("captureFlagDeposit"):{_missionData params[["_flagObject",objNull,[objNull]],["_finalFlag",objNull,[objNull]]];if(life_gang_data isEqualTo[]) exitWith{["You must be in a gang first!","basic"]spawn life_fnc_handleMessage;};(_flagObject getVariable["ga_domination_captureFlag",[false,objNull,"",""]]) params[["_isActive",false,[false]],["_ownerObj",objNull,[objNull]],["_startFlagName","",[""]],["_endFlagName","",[""]]];(call life_fnc_getDomCTF) params[["_startFlag",objNull,[objNull]],["_endFlag",objNull,[objNull]]];if!(_isActive) exitWith{["CTF is no longer active!","basic"]spawn life_fnc_handleMessage;};life_gang_data params[["_myGangID",-1,[0]],["_myGangName","",[""]],["_myGangRank",-1,[0]]];disableSerialization;5 cutRsc["life_progress","PLAIN"];private _display=uiNameSpace getVariable["life_progress",displayNull];private _progressBar=_display displayCtrl 38201;private _progressText=_display displayCtrl 38202;private _increment=1;private _totalTime=selectRandom[6,7,9,11];private _currentPoint=0;private _loopDelay=_totalTime/floor(100/_increment);private _text=format["Depositing CTF Flag"];private _pos=getPosATL _flagObject;private _startCount=0;_progressBar progressSetPosition _startCount;_progressText ctrlSetText format["%1 (%2%3)",_text,_startCount,"%"];private _isSuccess=for"_i"from 0 to 1 step 0 do{uiSleep _loopDelay;if(isNull _progressBar) exitWith{["You have failed to deposit the flag!","basic"]spawn life_fnc_handleMessage;false};_currentPoint=(progressPosition _progressBar)+(_increment/100);_progressBar progressSetPosition _currentPoint;_progressText ctrlSetText format["%1 (%2%3)",_text,round(_currentPoint*100),"%"];private _checkToExit=!(call life_fnc_isDominationActive);if(player distance _pos>8||life_isDowned||player getVariable["ga_restrained",false]||!alive player) exitWith{false};if(_checkToExit) exitWith{false};if!(isNull objectParent player) exitWith{false};if(_currentPoint>=1) exitWith{true};false;};5 cutText["","PLAIN"];if!(_isSuccess) exitWith{};detach _flagObject;_flagObject setVariable["ga_domination_captureFlag",[false,objNull,_startFlagName,_endFlagName],true];[[format["%1 has delivered the CTF flag from %3 to %2. %4 has earned 350 points to their domination score!",profileName,_endFlagName,_startFlagName,_myGangName],"domination"],"life_fnc_handleMessage",allPlayers]spawn life_fnc_MP;life_dominatonCTF=[false,objNull,"",""];[["addPoints",[_myGangID,_myGangName,350]],"TON_fnc_dominationSRV",2]spawn life_fnc_MP;[]spawn life_fnc_dominationMissionHardpoint;};case("captureFlagPickUp"):{_missionData params[["_flagObject",objNull,[objNull]]];if(life_gang_data isEqualTo[]) exitWith{["You must be in a gang first!","basic"]spawn life_fnc_handleMessage;};(_flagObject getVariable["ga_domination_captureFlag",[false,objNull,"",""]]) params[["_isActive",false,[false]],["_ownerObj",objNull,[objNull]],["_startFlagName","",[""]],["_endFlagName","",[""]]];(call life_fnc_getDomCTF) params[["_startFlag",objNull,[objNull]],["_endFlag",objNull,[objNull]]];life_gang_data params[["_myGangID",-1,[0]],["_myGangName","",[""]],["_myGangRank",-1,[0]]];if(_myGangID isEqualTo-1) exitWith{["You must be in a gang to hold the CTF flag!","basic"]spawn life_fnc_handleMessage;};disableSerialization;5 cutRsc["life_progress","PLAIN"];private _display=uiNameSpace getVariable["life_progress",displayNull];private _progressBar=_display displayCtrl 38201;private _progressText=_display displayCtrl 38202;private _increment=1;private _totalTime=selectRandom[2,3,4,5];private _currentPoint=0;private _loopDelay=_totalTime/floor(100/_increment);private _text=format["Picking Up CTF Flag"];private _pos=getPosATL _flagObject;private _startCount=0;_progressBar progressSetPosition _startCount;_progressText ctrlSetText format["%1 (%2%3)",_text,_startCount,"%"];private _isSuccess=for"_i"from 0 to 1 step 0 do{uiSleep _loopDelay;if(isNull _progressBar) exitWith{["You have failed to pickup the flag!","basic"]spawn life_fnc_handleMessage;false};_currentPoint=(progressPosition _progressBar)+(_increment/100);_progressBar progressSetPosition _currentPoint;_progressText ctrlSetText format["%1 (%2%3)",_text,round(_currentPoint*100),"%"];private _checkToExit=!(call life_fnc_isDominationActive);if(player distance _pos>8||life_isDowned||player getVariable["ga_restrained",false]||!alive player) exitWith{false};if(_checkToExit) exitWith{false};if!(isNull objectParent player) exitWith{false};if(_currentPoint>=1) exitWith{true};false;};5 cutText["","PLAIN"];if!(_isSuccess) exitWith{};_flagObject attachTo[player,[0,0,-0.7]];_flagObject setVariable["ga_domination_captureFlag",[true,player,_startFlagName,_endFlagName],true];[[format["%1 has retrieved the CTF flag, escort him to %2 to win 350 points!",profileName,_endFlagName],"shortwarning"],"life_fnc_handleMessage",group player]spawn life_fnc_MP;life_dominatonCTF=[true,_flagObject,_startFlagName,_endFlagName];[]spawn life_fnc_dominationMissionHardpoint;};case("captureFlagDrop"):{_missionData params[["_flagObject",objNull,[objNull]]];(_flagObject getVariable["ga_domination_captureFlag",[false,objNull,"",""]]) params[["_isActive",false,[false]],["_ownerObj",objNull,[objNull]],["_startFlagName","",[""]],["_endFlagName","",[""]]];(call life_fnc_getDomCTF) params[["_startFlag",objNull,[objNull]],["_endFlag",objNull,[objNull]]];life_gang_data params[["_myGangID",-1,[0]],["_myGangName","",[""]],["_myGangRank",-1,[0]]];detach _flagObject;_flagObject setVariable["ga_domination_captureFlag",[true,objNull,_startFlagName,_endFlagName],true];life_dominatonCTF=[false,objNull,"",""];[[format["%1 has dropped the CTF flag, retrieve it ASAP!",profileName],"shortwarning"],"life_fnc_handleMessage",group player]spawn life_fnc_MP;};case("jugEffects"):{_missionData params[["_juggernautMan",objNull,[objNull]]];while{alive _juggernautMan}do{_juggernautMan say3D["domJug",100];uiSleep 3;};};case("scalpelJug"):{_missionData params[["_juggernautMan",objNull,[objNull]]];if(life_gang_data isEqualTo[]) exitWith{["You must be in a gang first!","basic"]spawn life_fnc_handleMessage;};if(isNull _juggernautMan||!(playerSide isEqualTo civilian)||!(_juggernautMan isKindOf"CAManBase")||alive _juggernautMan) exitWith{};if(player distance _juggernautMan>2.5) exitWith{};if(_juggernautMan getVariable["ga_executing",player]isNotEqualTo player) exitWith{["Someone else is already executing this person!","basic"]spawn life_fnc_handleMessage;};life_gang_data params[["_myGangID",-1,[0]],["_myGangName","",[""]],["_myGangRank",-1,[0]]];